
## add_post_terms <- function(terms, template) {
##     nms_terms <- get_nms_terms(terms)
##     nms_template <- names(dimnames(template))
##     for (nm in nms_terms) {
##         i_tme
##     if (!all(setdiff(nms_terms, "zero") %in%
    
    

## svd_lograte <- function(dim_target, term, margins_term) {
##     ndim <- length(dim_target)
##     i_dim <- rep(0, times = n_dim)
##     for (j in seq_len(ndim)) {
##         if (i_dim[j] == dim_target[j] - 1L)
##             if j 
##     n <- prod(dim_target)
##     for (i in seq_len(n)) {
        
##     n <- cumprod(dim_target)
    
