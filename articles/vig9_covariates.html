<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>9. Covariates • bage</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="9. Covariates">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bage</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/vig1_intro.html">1. Overview</a></li>
    <li><a class="dropdown-item" href="../articles/vig2_math.html">2. Mathematical Details</a></li>
    <li><a class="dropdown-item" href="../articles/vig3_priors.html">3. Priors</a></li>
    <li><a class="dropdown-item" href="../articles/vig4_svd.html">4. Singular Value Decomposition</a></li>
    <li><a class="dropdown-item" href="../articles/vig5_bdef.html">5. Examples from BDEF Book</a></li>
    <li><a class="dropdown-item" href="../articles/vig6_mortality.html">6. Modelling Mortality</a></li>
    <li><a class="dropdown-item" href="../articles/vig7_simulation.html">7. Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/vig8_workflow.html">8. Bayesian Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/vig9_covariates.html">9. Covariates</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bayesiandemography/bage/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>9. Covariates</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bayesiandemography/bage/blob/main/vignettes/vig9_covariates.Rmd" class="external-link"><code>vignettes/vig9_covariates.Rmd</code></a></small>
      <div class="d-none name"><code>vig9_covariates.Rmd</code></div>
    </div>

    
    
<div class="section level2" number="1">
<h2 id="introduction">
<span class="header-section-number">1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Covariates can be used to extend standard <strong>bage</strong> models in two ways:</p>
<ol style="list-style-type: decimal">
<li>incorporating information beyond what is contained in classifying variables, such as age, sex, or region; and</li>
<li>dealing with subsets of the data with unusual behavior.</li>
</ol>
<p>This vignette gives a brief description of covariates in <strong>bage</strong> and then illustrates their use with a case study of births in South Korea.</p>
</div>
<div class="section level2" number="2">
<h2 id="mathematical-details">
<span class="header-section-number">2</span> Mathematical details<a class="anchor" aria-label="anchor" href="#mathematical-details"></a>
</h2>
<p>A model in <strong>bage</strong> typically has a structure that is something like:
<span class="math display" id="eq:priormod">\[\begin{align}
  y_{ast} &amp; \sim \text{Poisson}(\gamma_{ast} w_{ast}) \\
  \log \gamma_{ast} &amp; \sim \text{Gamma}(\xi^{-1}, (\mu_{ast} \xi)^{-1}) \\
  \log \mu_{ast} &amp; = \beta^{(0)} + \beta_{as}^{\text{age:sex}} + \beta_t^{\text{time}} \tag{2.1}
\end{align}\]</span>
where</p>
<ul>
<li>
<span class="math inline">\(y_{ast}\)</span> is the outcome for people in age group <span class="math inline">\(a\)</span> and sex <span class="math inline">\(s\)</span> during period <span class="math inline">\(t\)</span>;</li>
<li>
<span class="math inline">\(w_{ast}\)</span> is exposure;</li>
<li>
<span class="math inline">\(\gamma_{ast}\)</span> is a rate;</li>
<li>
<span class="math inline">\(\xi\)</span> governs overall dispersion;</li>
<li>
<span class="math inline">\(\beta^{(0)}\)</span> is an intercept;</li>
<li>
<span class="math inline">\(\pmb{\beta}^{\text{age:sex}}\)</span> and <span class="math inline">\(\pmb{\beta}^{\text{time}}\)</span> are terms formed the classifying variables age, sex, and time;</li>
<li>
<span class="math inline">\(\beta_{as}^{\text{age:sex}}\)</span> and <span class="math inline">\(\pmb{\beta}_t^{\text{time}}\)</span> are elements of these terms; and</li>
<li>the intercept and the terms formed from the classifying variables all have prior distributions.</li>
</ul>
<p>In a model with covariates, <a href="#eq:priormod">(2.1)</a> changes to
<span class="math display">\[\begin{equation}
  \log \mu_{ast} = \beta^{(0)} + \beta_{as}^{\text{age:sex}} + \beta_t^{\text{time}} + (\pmb{Z} \pmb{\zeta})_{ast}
\end{equation}\]</span></p>
<p>where</p>
<ul>
<li>
<span class="math inline">\(\pmb{Z}\)</span> is a <span class="math inline">\(N \times P\)</span> covariate matrix;</li>
<li>
<span class="math inline">\(\pmb{\zeta}\)</span> is a <span class="math inline">\(P\)</span>-element vector of coefficients; and</li>
<li>
<span class="math inline">\((\pmb{Z} \pmb{\zeta})_{ast}\)</span> is an element from the vector obtained by multiplying <span class="math inline">\(\pmb{Z}\)</span> and <span class="math inline">\(\pmb{\zeta}\)</span>.</li>
</ul>
<p>Change <a href="#eq:prior-mod-no-cov">(2.2)</a> to
<span class="math display" id="eq:prior-mod-no-cov">\[\begin{equation}
  \mu_i = \sum_{m=0}^M \beta_{j_i^m}^{(m)} + (\pmb{Z} \pmb{\eta})_i \tag{2.2}
\end{equation}\]</span></p>
<p>where
- <span class="math inline">\(\pmb{Z}\)</span> is an <span class="math inline">\(I \times P\)</span> matrix of covariates; and
- <span class="math inline">\(\pmb{\eta}\)</span> is a vector of coefficients.</p>
<p>The covariate matrix <span class="math inline">\(\pmb{Z}\)</span> is derived from the raw covariate data by scaling any numeric variables to have mean 0 and standard deviation 1, and by converting any categorical variables to sets of indicator variables. The conversion to indicator variables follows the rules that R uses for “treatment” contrasts. If the categorical has <span class="math inline">\(C\)</span> categories, then <span class="math inline">\(C-1\)</span> indicator variabls are constructed, with the first category being omitted.</p>
<p>Each element of <span class="math inline">\(\pmb{\eta}\)</span> has prior
<span class="math display">\[\begin{equation}
  \eta_p \sim \text{N}(0, 1)
\end{equation}\]</span></p>
</div>
<div class="section level2" number="3">
<h2 id="example-births-in-south-korea">
<span class="header-section-number">3</span> Example: Births in South Korea<a class="anchor" aria-label="anchor" href="#example-births-in-south-korea"></a>
</h2>
<p>To illustrate the use of covariates, we will analyse data on births in South Korea.</p>
<div class="section level3" number="3.1">
<h3 id="preliminaries">
<span class="header-section-number">3.1</span> Preliminaries<a class="anchor" aria-label="anchor" href="#preliminaries"></a>
</h3>
<p>Besides <strong>bage</strong> itself, we use <strong>dplyr</strong> and <strong>vctrs</strong> for data manipulation, and <strong>ggplot2</strong> for plotting results.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bayesiandemography.github.io/bage/">bage</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Our data is the data frame <code>kor_births</code>, which is part of <strong>bage</strong>. The data frame gives numbers of births disaggregated by age of mother, region, and year. It also contains a numeric variable called <code>gdp_pc_2023</code> that gives GDP per capita (in thousands of US dollars) in 2023, and a categorical variable (with levels <code>"Low"</code>, <code>"Medium"</code>, and <code>"High"</code>) describing population density in 2020.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kor_births</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,872 × 7</span></span></span>
<span><span class="co">#&gt;    age   region  time births  popn gdp_pc_2023 dens_2020</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 10-14 Busan   <span style="text-decoration: underline;">2</span>011      1 <span style="text-decoration: underline;">89</span>822        25.7 High     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 10-14 Busan   <span style="text-decoration: underline;">2</span>012      0 <span style="text-decoration: underline;">83</span>884        25.7 High     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 10-14 Busan   <span style="text-decoration: underline;">2</span>013      0 <span style="text-decoration: underline;">79</span>061        25.7 High     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 10-14 Busan   <span style="text-decoration: underline;">2</span>014      1 <span style="text-decoration: underline;">74</span>741        25.7 High     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 10-14 Busan   <span style="text-decoration: underline;">2</span>015      0 <span style="text-decoration: underline;">68</span>783        25.7 High     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 10-14 Busan   <span style="text-decoration: underline;">2</span>016      1 <span style="text-decoration: underline;">64</span>905        25.7 High     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 10-14 Busan   <span style="text-decoration: underline;">2</span>017      1 <span style="text-decoration: underline;">64</span>251        25.7 High     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 10-14 Busan   <span style="text-decoration: underline;">2</span>018      0 <span style="text-decoration: underline;">63</span>249        25.7 High     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 10-14 Busan   <span style="text-decoration: underline;">2</span>019      0 <span style="text-decoration: underline;">62</span>154        25.7 High     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10-14 Busan   <span style="text-decoration: underline;">2</span>020      0 <span style="text-decoration: underline;">63</span>498        25.7 High     </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,862 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3" number="3.2">
<h3 id="covariates-that-bring-in-extra-information">
<span class="header-section-number">3.2</span> Covariates that bring in extra information<a class="anchor" aria-label="anchor" href="#covariates-that-bring-in-extra-information"></a>
</h3>
<p>The variables <code>gdp_pc_2023</code> and <code>dens_2020</code> are both examples of covariates that contribute extra information to the model, beyond what is contained in the outcome, exposure, and classifying variables.</p>
<p>We use function <code><a href="../reference/set_covariates.html">set_covariates()</a></code> to instruct <code><a href="../reference/mod_pois.html">mod_pois()</a></code> to treat these variables as covariates.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_gdp_dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mod_pois.html">mod_pois</a></span><span class="op">(</span><span class="va">births</span> <span class="op">~</span> <span class="op">(</span><span class="va">age</span> <span class="op">+</span> <span class="va">region</span> <span class="op">+</span> <span class="va">time</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>,</span>
<span>                         data <span class="op">=</span> <span class="va">kor_births</span>,</span>
<span>                         exposure <span class="op">=</span> <span class="va">popn</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_covariates.html">set_covariates</a></span><span class="op">(</span><span class="op">~</span> <span class="va">gdp_pc_2023</span> <span class="op">+</span> <span class="va">dens_2020</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Building log-posterior function...</span></span>
<span><span class="co">#&gt; Finding maximum...</span></span>
<span><span class="co">#&gt; Drawing values for hyper-parameters...</span></span>
<span><span class="va">mod_gdp_dens</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     ------ Fitted Poisson model ------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    births ~ (age + region + time)^2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   exposure = popn</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         term  prior along n_par n_par_free std_dev</span></span>
<span><span class="co">#&gt;  (Intercept) NFix()     -     1          1       -</span></span>
<span><span class="co">#&gt;          age   RW()   age     9          9    2.64</span></span>
<span><span class="co">#&gt;       region    N()     -    16         16    0.03</span></span>
<span><span class="co">#&gt;         time   RW()  time    13         13    0.20</span></span>
<span><span class="co">#&gt;   age:region   RW()   age   144        144    0.20</span></span>
<span><span class="co">#&gt;     age:time   RW()  time   117        117    1.20</span></span>
<span><span class="co">#&gt;  region:time   RW()  time   208        208    0.19</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  covariates: ~gdp_pc_2023 + dens_2020</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  disp: mean = 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  n_draw var_time var_age optimizer</span></span>
<span><span class="co">#&gt;    1000     time     age    nlminb</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  time_total time_max time_draw iter converged                    message</span></span>
<span><span class="co">#&gt;        3.23     1.42      1.00   26      TRUE   relative convergence (4)</span></span></code></pre></div>
<p>To obtain estimates of the coefficients (ie estimates of the <span class="math inline">\(\zeta_p\)</span>) we call function <code><a href="https://generics.r-lib.org/reference/components.html" class="external-link">components()</a></code> and filter out rows for the <code>"covariates"</code> term.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_gdp_dens</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/components.html" class="external-link">components</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">term</span> <span class="op">==</span> <span class="st">"covariates"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 4</span></span></span>
<span><span class="co">#&gt;   term       component level                         .fitted</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;rdbl&lt;1000&gt;&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> covariates coef      gdp_pc_2023     -0.0029 (-0.67, 0.67)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> covariates coef      dens_2020Low       -0.53 (-1.9, 0.85)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> covariates coef      dens_2020Medium    -0.77 (-2.1, 0.55)</span></span></code></pre></div>
</div>
<div class="section level3" number="3.3">
<h3 id="covariates-that-allow-for-unusual-subsets">
<span class="header-section-number">3.3</span> Covariates that allow for unusual subsets<a class="anchor" aria-label="anchor" href="#covariates-that-allow-for-unusual-subsets"></a>
</h3>
<p>In East Asia, years with the Dragon zodiac sign sometimes have larger-than-usual numbers of births. To allow for this possibility, we create a dragon-year covariate, and incorporate it into a new model.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">births</span> <span class="op">&lt;-</span> <span class="va">kor_births</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>is_dragon_year <span class="op">=</span> <span class="va">time</span> <span class="op">==</span> <span class="fl">2012</span><span class="op">)</span></span>
<span><span class="va">mod_dragon</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mod_pois.html">mod_pois</a></span><span class="op">(</span><span class="va">births</span> <span class="op">~</span> <span class="op">(</span><span class="va">age</span> <span class="op">+</span> <span class="va">region</span> <span class="op">+</span> <span class="va">time</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>,</span>
<span>                      data <span class="op">=</span> <span class="va">births</span>,</span>
<span>                      exposure <span class="op">=</span> <span class="va">popn</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_covariates.html">set_covariates</a></span><span class="op">(</span><span class="op">~</span> <span class="va">is_dragon_year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Building log-posterior function...</span></span>
<span><span class="co">#&gt; Finding maximum...</span></span>
<span><span class="co">#&gt; Drawing values for hyper-parameters...</span></span>
<span></span>
<span><span class="va">mod_dragon</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/components.html" class="external-link">components</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">term</span> <span class="op">==</span> <span class="st">"covariates"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">#&gt;   term       component level                           .fitted</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;rdbl&lt;1000&gt;&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> covariates coef      is_dragon_yearTRUE 0.063 (-0.043, 0.17)</span></span></code></pre></div>
<p>There is some evidence for extra births, though there is substantial uncertainty about the size of the effect.</p>
<p>Next we expand the model to allow the dragon-year effect to differ across age groups. We create a variable that takes the values <code>"baseline"</code> in all years, except in dragon years, when it takes the name of the age group. We turn this variable into a factor with <code>"baseline"</code> as its first level.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">births</span> <span class="op">&lt;-</span> <span class="va">births</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>is_dragon_year_age <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="fl">2012</span>, <span class="va">age</span>, <span class="st">"baseline"</span><span class="op">)</span>,</span>
<span>         is_dragon_year_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">is_dragon_year_age</span>, </span>
<span>                                     levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"baseline"</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">births</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">2011</span><span class="op">:</span><span class="fl">2013</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 432 × 9</span></span></span>
<span><span class="co">#&gt;    age   region           time births  popn gdp_pc_2023 dens_2020 is_dragon_year</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 10-14 Busan            <span style="text-decoration: underline;">2</span>011      1 <span style="text-decoration: underline;">89</span>822        25.7 High      FALSE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 10-14 Busan            <span style="text-decoration: underline;">2</span>012      0 <span style="text-decoration: underline;">83</span>884        25.7 High      TRUE          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 10-14 Busan            <span style="text-decoration: underline;">2</span>013      0 <span style="text-decoration: underline;">79</span>061        25.7 High      FALSE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 10-14 Chungcheongbuk…  <span style="text-decoration: underline;">2</span>011      3 <span style="text-decoration: underline;">47</span>811        40.3 Low       FALSE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 10-14 Chungcheongbuk…  <span style="text-decoration: underline;">2</span>012      1 <span style="text-decoration: underline;">44</span>864        40.3 Low       TRUE          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 10-14 Chungcheongbuk…  <span style="text-decoration: underline;">2</span>013      0 <span style="text-decoration: underline;">42</span>259        40.3 Low       FALSE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 10-14 Chungcheongnam…  <span style="text-decoration: underline;">2</span>011      0 <span style="text-decoration: underline;">62</span>308        50.4 Low       FALSE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 10-14 Chungcheongnam…  <span style="text-decoration: underline;">2</span>012      0 <span style="text-decoration: underline;">56</span>746        50.4 Low       TRUE          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 10-14 Chungcheongnam…  <span style="text-decoration: underline;">2</span>013      0 <span style="text-decoration: underline;">54</span>415        50.4 Low       FALSE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10-14 Daegu            <span style="text-decoration: underline;">2</span>011      3 <span style="text-decoration: underline;">75</span>776        22.3 Medium    FALSE         </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 422 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: is_dragon_year_age &lt;fct&gt;</span></span></span></code></pre></div>
<p>We create a new model with the age-sepcific dragon-year indicator.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_dragon_age</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mod_pois.html">mod_pois</a></span><span class="op">(</span><span class="va">births</span> <span class="op">~</span> <span class="op">(</span><span class="va">age</span> <span class="op">+</span> <span class="va">region</span> <span class="op">+</span> <span class="va">time</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>,</span>
<span>                         data <span class="op">=</span> <span class="va">births</span>,</span>
<span>                         exposure <span class="op">=</span> <span class="va">popn</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/set_covariates.html">set_covariates</a></span><span class="op">(</span><span class="op">~</span> <span class="va">is_dragon_year_age</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Building log-posterior function...</span></span>
<span><span class="co">#&gt; Finding maximum...</span></span>
<span><span class="co">#&gt; Drawing values for hyper-parameters...</span></span>
<span><span class="va">mod_dragon_age</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     ------ Fitted Poisson model ------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    births ~ (age + region + time)^2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   exposure = popn</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         term  prior along n_par n_par_free std_dev</span></span>
<span><span class="co">#&gt;  (Intercept) NFix()     -     1          1       -</span></span>
<span><span class="co">#&gt;          age   RW()   age     9          9    2.64</span></span>
<span><span class="co">#&gt;       region    N()     -    16         16    0.02</span></span>
<span><span class="co">#&gt;         time   RW()  time    13         13    0.18</span></span>
<span><span class="co">#&gt;   age:region   RW()   age   144        144    0.17</span></span>
<span><span class="co">#&gt;     age:time   RW()  time   117        117    1.22</span></span>
<span><span class="co">#&gt;  region:time   RW()  time   208        208    0.14</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  covariates: ~is_dragon_year_age</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  disp: mean = 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  n_draw var_time var_age optimizer</span></span>
<span><span class="co">#&gt;    1000     time     age    nlminb</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  time_total time_max time_draw iter converged                    message</span></span>
<span><span class="co">#&gt;        2.16     1.09      0.95   24      TRUE   relative convergence (4)</span></span></code></pre></div>
<p>Rather than a single dragon-year coefficient, we have a coefficient for each age group. We extract them and tidy up the labels.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_dragon_age</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/components.html" class="external-link">components</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">term</span> <span class="op">==</span> <span class="st">"covariates"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"is_dragon_year_age"</span>, <span class="st">""</span>, <span class="va">level</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">.fitted</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 × 2</span></span></span>
<span><span class="co">#&gt;   age                .fitted</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;rdbl&lt;1000&gt;&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 10-14   0.31 (-0.14, 0.79)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 15-19 0.0094 (-0.19, 0.18)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 20-24  0.049 (-0.15, 0.23)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 25-29   0.075 (-0.1, 0.27)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 30-34 0.075 (-0.094, 0.26)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 35-39  0.034 (-0.15, 0.21)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> 40-44  0.058 (-0.12, 0.24)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> 45-49   0.11 (-0.11, 0.33)</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span> 50-54    0.2 (-0.19, 0.55)</span></span></code></pre></div>
</div>
<div class="section level3" number="3.4">
<h3 id="forecasting">
<span class="header-section-number">3.4</span> Forecasting<a class="anchor" aria-label="anchor" href="#forecasting"></a>
</h3>
<p>If all the covariates in a model are fixed, then the model can be forecasted as normal.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_gdp_dens</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fl">2024</span><span class="op">:</span><span class="fl">2025</span><span class="op">)</span></span>
<span><span class="co">#&gt; `components()` for past values...</span></span>
<span><span class="co">#&gt; `components()` for future values...</span></span>
<span><span class="co">#&gt; `augment()` for future values...</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 288 × 10</span></span></span>
<span><span class="co">#&gt;    age   region             time births  popn gdp_pc_2023 dens_2020 .observed</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 10-14 Busan              <span style="text-decoration: underline;">2</span>024     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>        25.7 High             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 10-14 Busan              <span style="text-decoration: underline;">2</span>025     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>        25.7 High             <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 10-14 Chungcheongbuk-do  <span style="text-decoration: underline;">2</span>024     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>        40.3 Low              <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 10-14 Chungcheongbuk-do  <span style="text-decoration: underline;">2</span>025     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>        40.3 Low              <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 10-14 Chungcheongnam-do  <span style="text-decoration: underline;">2</span>024     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>        50.4 Low              <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 10-14 Chungcheongnam-do  <span style="text-decoration: underline;">2</span>025     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>        50.4 Low              <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 10-14 Daegu              <span style="text-decoration: underline;">2</span>024     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>        22.3 Medium           <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 10-14 Daegu              <span style="text-decoration: underline;">2</span>025     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>        22.3 Medium           <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 10-14 Daejeon            <span style="text-decoration: underline;">2</span>024     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>        27.6 Medium           <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10-14 Daejeon            <span style="text-decoration: underline;">2</span>025     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>        27.6 Medium           <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 278 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: .fitted &lt;rdbl&lt;1000&gt;&gt;, .expected &lt;rdbl&lt;1000&gt;&gt;</span></span></span></code></pre></div>
<p>If, however, a covariate varies over time, forecasting only works if values for future periods are provided. The following code will result in an error:</p>
<pre><code><span><span class="va">mod_dragon</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fl">2024</span><span class="op">:</span><span class="fl">2025</span><span class="op">)</span></span></code></pre>
<p>Instead we need to create a <code>newdata</code> data frame…</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">kor_births</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>,</span>
<span>                       region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">kor_births</span><span class="op">$</span><span class="va">region</span><span class="op">)</span>,</span>
<span>                       time <span class="op">=</span> <span class="fl">2024</span><span class="op">:</span><span class="fl">2025</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>is_dragon_year <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">newdata</span><span class="op">)</span></span>
<span><span class="co">#&gt;     age region time is_dragon_year</span></span>
<span><span class="co">#&gt; 1 10-14  Busan 2024          FALSE</span></span>
<span><span class="co">#&gt; 2 15-19  Busan 2024          FALSE</span></span>
<span><span class="co">#&gt; 3 20-24  Busan 2024          FALSE</span></span>
<span><span class="co">#&gt; 4 25-29  Busan 2024          FALSE</span></span>
<span><span class="co">#&gt; 5 30-34  Busan 2024          FALSE</span></span>
<span><span class="co">#&gt; 6 35-39  Busan 2024          FALSE</span></span></code></pre></div>
<p>…and supply it to <code><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast()</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_dragon</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span>newdata <span class="op">=</span> <span class="va">newdata</span><span class="op">)</span></span>
<span><span class="co">#&gt; `components()` for past values...</span></span>
<span><span class="co">#&gt; `components()` for future values...</span></span>
<span><span class="co">#&gt; `augment()` for future values...</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 288 × 11</span></span></span>
<span><span class="co">#&gt;    age   region           time births  popn gdp_pc_2023 dens_2020 is_dragon_year</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 10-14 Busan            <span style="text-decoration: underline;">2</span>024     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>        FALSE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 15-19 Busan            <span style="text-decoration: underline;">2</span>024     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>        FALSE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 20-24 Busan            <span style="text-decoration: underline;">2</span>024     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>        FALSE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 25-29 Busan            <span style="text-decoration: underline;">2</span>024     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>        FALSE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 30-34 Busan            <span style="text-decoration: underline;">2</span>024     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>        FALSE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 35-39 Busan            <span style="text-decoration: underline;">2</span>024     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>        FALSE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 40-44 Busan            <span style="text-decoration: underline;">2</span>024     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>        FALSE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 45-49 Busan            <span style="text-decoration: underline;">2</span>024     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>        FALSE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 50-54 Busan            <span style="text-decoration: underline;">2</span>024     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>        FALSE         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10-14 Chungcheongbuk…  <span style="text-decoration: underline;">2</span>024     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>          <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>        FALSE         </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 278 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3 more variables: .observed &lt;dbl&gt;, .fitted &lt;rdbl&lt;1000&gt;&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   .expected &lt;rdbl&lt;1000&gt;&gt;</span></span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by John Bryant, Junni Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
