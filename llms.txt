# bage

[![](reference/figures/sticker/sticker.png)](https://github.com/bayesiandemography/bage)

Fast Bayesian estimation and forecasting of age-specific rates.

## Installation

``` r
install.packages("bage")
```

## Example

Fit Poisson model to data on injuries

``` r
library(bage)
mod <- mod_pois(injuries ~ age:sex + ethnicity + year,
                data = nzl_injuries,
                exposure = popn) |>
  fit()
mod
#> 
#>     ------ Fitted Poisson model ------
#> 
#>    injuries ~ age:sex + ethnicity + year
#> 
#>                  exposure: popn
#> 
#>         term  prior along n_par n_par_free std_dev
#>  (Intercept) NFix()     -     1          1       -
#>    ethnicity NFix()     -     2          2    0.45
#>         year   RW()  year    19         19    0.09
#>      age:sex   RW()   age    24         24    0.88
#> 
#>  disp: mean = 1
#> 
#>  n_draw var_time var_age var_sexgender optimizer
#>    1000     year     age           sex    nlminb
#> 
#>  time_total time_max time_draw iter converged                    message
#>        0.52     0.08      0.09   13      TRUE   relative convergence (4)
```

Extract model-based and direct estimates

``` r
augment(mod)
#> # A tibble: 912 × 9
#>    age   sex    ethnicity  year injuries  popn .observed
#>    <fct> <chr>  <chr>     <int>    <int> <int>     <dbl>
#>  1 0-4   Female Maori      2000       12 35830 0.000335 
#>  2 5-9   Female Maori      2000        6 35120 0.000171 
#>  3 10-14 Female Maori      2000        3 32830 0.0000914
#>  4 15-19 Female Maori      2000        6 27130 0.000221 
#>  5 20-24 Female Maori      2000        6 24380 0.000246 
#>  6 25-29 Female Maori      2000        6 24160 0.000248 
#>  7 30-34 Female Maori      2000       12 22560 0.000532 
#>  8 35-39 Female Maori      2000        3 22230 0.000135 
#>  9 40-44 Female Maori      2000        6 18130 0.000331 
#> 10 45-49 Female Maori      2000        6 13770 0.000436 
#> # ℹ 902 more rows
#> # ℹ 2 more variables: .fitted <rdbl<1000>>, .expected <rdbl<1000>>
```

# Package index

## All functions

- [`AR()`](https://bayesiandemography.github.io/bage/reference/AR.md) :
  Autoregressive Prior
- [`AR1()`](https://bayesiandemography.github.io/bage/reference/AR1.md)
  : Autoregressive Prior of Order 1
- [`CSA`](https://bayesiandemography.github.io/bage/reference/CSA.md) :
  Scaled SVD Components from Census School Attendance Data
- [`HFD`](https://bayesiandemography.github.io/bage/reference/HFD.md) :
  Scaled SVD Components from Human Fertility Database
- [`HIMD_R`](https://bayesiandemography.github.io/bage/reference/HIMD_R.md)
  [`HIMD_P1`](https://bayesiandemography.github.io/bage/reference/HIMD_R.md)
  [`HIMD_P5`](https://bayesiandemography.github.io/bage/reference/HIMD_R.md)
  : Scaled SVD Components from Human Internal Migration Database
- [`HMD`](https://bayesiandemography.github.io/bage/reference/HMD.md) :
  Scaled SVD Components from Human Mortality Database
- [`Known()`](https://bayesiandemography.github.io/bage/reference/Known.md)
  : Known Prior
- [`LFP`](https://bayesiandemography.github.io/bage/reference/LFP.md) :
  Scaled SVD Components from OECD Labor Force Participation Data
- [`Lin()`](https://bayesiandemography.github.io/bage/reference/Lin.md)
  : Linear Prior with Independent Normal Errors
- [`Lin_AR()`](https://bayesiandemography.github.io/bage/reference/Lin_AR.md)
  : Linear Prior with Autoregressive Errors
- [`Lin_AR1()`](https://bayesiandemography.github.io/bage/reference/Lin_AR1.md)
  : Linear Prior with Autoregressive Errors of Order 1
- [`N()`](https://bayesiandemography.github.io/bage/reference/N.md) :
  Normal Prior
- [`NFix()`](https://bayesiandemography.github.io/bage/reference/NFix.md)
  : Normal Prior with Fixed Variance
- [`RW()`](https://bayesiandemography.github.io/bage/reference/RW.md) :
  Random Walk Prior
- [`RW2()`](https://bayesiandemography.github.io/bage/reference/RW2.md)
  : Second-Order Random Walk Prior
- [`RW2_Infant()`](https://bayesiandemography.github.io/bage/reference/RW2_Infant.md)
  : Second-Order Random Walk Prior with 'Infant' Indicator
- [`RW2_Seas()`](https://bayesiandemography.github.io/bage/reference/RW2_Seas.md)
  : Second-Order Random Walk Prior with Seasonal Effect
- [`RW_Seas()`](https://bayesiandemography.github.io/bage/reference/RW_Seas.md)
  : Random Walk Prior with Seasonal Effect
- [`SVD()`](https://bayesiandemography.github.io/bage/reference/SVD.md)
  : SVD-Based Prior for Age or Age-Sex Profiles
- [`SVD_AR()`](https://bayesiandemography.github.io/bage/reference/SVD_AR.md)
  [`SVD_AR1()`](https://bayesiandemography.github.io/bage/reference/SVD_AR.md)
  [`SVD_RW()`](https://bayesiandemography.github.io/bage/reference/SVD_AR.md)
  [`SVD_RW2()`](https://bayesiandemography.github.io/bage/reference/SVD_AR.md)
  : Dynamic SVD-Based Priors for Age Profiles or Age-Sex Profiles
- [`Sp()`](https://bayesiandemography.github.io/bage/reference/Sp.md) :
  P-Spline Prior
- [`WMD_C`](https://bayesiandemography.github.io/bage/reference/WMD_C.md)
  [`WMD_E`](https://bayesiandemography.github.io/bage/reference/WMD_C.md)
  : Scaled SVD Components from World Marriage Database
- [`augment(`*`<bage_mod>`*`)`](https://bayesiandemography.github.io/bage/reference/augment.bage_mod.md)
  : Extract Data and Modeled Values
- [`components(`*`<bage_mod>`*`)`](https://bayesiandemography.github.io/bage/reference/components.bage_mod.md)
  : Extract Values for Hyper-Parameters
- [`components(`*`<bage_ssvd>`*`)`](https://bayesiandemography.github.io/bage/reference/components.bage_ssvd.md)
  : Extract Components used by SVD Summary
- [`computations()`](https://bayesiandemography.github.io/bage/reference/computations.md)
  : Information on Computations Performed During Model Fitting
- [`confidential`](https://bayesiandemography.github.io/bage/reference/confidential.md)
  : Confidentialization
- [`data_wmd`](https://bayesiandemography.github.io/bage/reference/data_wmd.md)
  : Data to Create Scaled SVD Object Based on World Marriage Database
- [`datamods`](https://bayesiandemography.github.io/bage/reference/datamods.md)
  : Data Models
- [`datasets`](https://bayesiandemography.github.io/bage/reference/datasets.md)
  : Datasets
- [`dispersion()`](https://bayesiandemography.github.io/bage/reference/dispersion.md)
  : Extract Values for Dispersion
- [`fit(`*`<bage_mod>`*`)`](https://bayesiandemography.github.io/bage/reference/fit.bage_mod.md)
  : Fit a Model
- [`forecast(`*`<bage_mod>`*`)`](https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.md)
  : Use a Model to Make a Forecast
- [`generate(`*`<bage_prior_ar>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_known>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_lin>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_linar>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_linex>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_norm>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_normfixed>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_rwrandom>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_rwrandomseasfix>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_rwrandomseasvary>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_rwzero>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_rwzeroseasfix>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_rwzeroseasvary>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_rw2random>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_rw2randomseasfix>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_rw2randomseasvary>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_rw2zero>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_rw2zeroseasfix>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_rw2zeroseasvary>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_spline>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_svd>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_svd_ar>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_svd_rwrandom>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_svd_rwzero>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_svd_rw2random>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  [`generate(`*`<bage_prior_svd_rw2zero>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.md)
  : Generate Values from Priors
- [`generate(`*`<bage_ssvd>`*`)`](https://bayesiandemography.github.io/bage/reference/generate.bage_ssvd.md)
  : Generate Random Age or Age-Sex Profiles
- [`is_fitted()`](https://bayesiandemography.github.io/bage/reference/is_fitted.md)
  : Test Whether a Model has Been Fitted
- [`isl_deaths`](https://bayesiandemography.github.io/bage/reference/isl_deaths.md)
  : Deaths in Iceland
- [`kor_births`](https://bayesiandemography.github.io/bage/reference/kor_births.md)
  : Births in South Korea
- [`mod_binom()`](https://bayesiandemography.github.io/bage/reference/mod_binom.md)
  : Specify a Binomial Model
- [`mod_norm()`](https://bayesiandemography.github.io/bage/reference/mod_norm.md)
  : Specify a Normal Model
- [`mod_pois()`](https://bayesiandemography.github.io/bage/reference/mod_pois.md)
  : Specify a Poisson Model
- [`n_draw(`*`<bage_mod>`*`)`](https://bayesiandemography.github.io/bage/reference/n_draw.bage_mod.md)
  : Get the Number of Draws for a Model Object
- [`nld_expenditure`](https://bayesiandemography.github.io/bage/reference/nld_expenditure.md)
  : Per Capita Health Expenditure in the Netherlands, 2003-2011
- [`nzl_divorces`](https://bayesiandemography.github.io/bage/reference/nzl_divorces.md)
  : Divorces in New Zealand
- [`nzl_households`](https://bayesiandemography.github.io/bage/reference/nzl_households.md)
  : People in One-Person Households in New Zealand
- [`nzl_injuries`](https://bayesiandemography.github.io/bage/reference/nzl_injuries.md)
  : Fatal Injuries in New Zealand
- [`print(`*`<bage_mod>`*`)`](https://bayesiandemography.github.io/bage/reference/print.bage_mod.md)
  : Printing a Model
- [`priors`](https://bayesiandemography.github.io/bage/reference/priors.md)
  : Priors for Intercept, Main Effects, Interactions
- [`prt_deaths`](https://bayesiandemography.github.io/bage/reference/prt_deaths.md)
  : Deaths in Portugal
- [`replicate_data()`](https://bayesiandemography.github.io/bage/reference/replicate_data.md)
  : Create Replicate Data
- [`report_sim()`](https://bayesiandemography.github.io/bage/reference/report_sim.md)
  : Simulation Study of a Model
- [`set_confidential_rr3()`](https://bayesiandemography.github.io/bage/reference/set_confidential_rr3.md)
  : Specify RR3 Confidentialization
- [`set_covariates()`](https://bayesiandemography.github.io/bage/reference/set_covariates.md)
  : Specify Covariates
- [`set_datamod_exposure()`](https://bayesiandemography.github.io/bage/reference/set_datamod_exposure.md)
  : Specify Exposure Data Model
- [`set_datamod_miscount()`](https://bayesiandemography.github.io/bage/reference/set_datamod_miscount.md)
  : Specify Miscount Data Model
- [`set_datamod_noise()`](https://bayesiandemography.github.io/bage/reference/set_datamod_noise.md)
  : Specify Noise Data Model
- [`set_datamod_outcome_rr3()`](https://bayesiandemography.github.io/bage/reference/set_datamod_outcome_rr3.md)
  : Specify RR3 Data Model
- [`set_datamod_overcount()`](https://bayesiandemography.github.io/bage/reference/set_datamod_overcount.md)
  : Specify Overcount Data Model
- [`set_datamod_undercount()`](https://bayesiandemography.github.io/bage/reference/set_datamod_undercount.md)
  : Specify Undercount Data Model
- [`set_disp()`](https://bayesiandemography.github.io/bage/reference/set_disp.md)
  : Specify Prior for Dispersion or Standard Deviation
- [`set_n_draw()`](https://bayesiandemography.github.io/bage/reference/set_n_draw.md)
  : Specify Number of Draws from Prior or Posterior Distribution
- [`set_prior()`](https://bayesiandemography.github.io/bage/reference/set_prior.md)
  : Specify Prior for Model Term
- [`set_seeds()`](https://bayesiandemography.github.io/bage/reference/set_seeds.md)
  : Reset Random Seeds in Model Object
- [`set_var_age()`](https://bayesiandemography.github.io/bage/reference/set_var_age.md)
  : Specify Age Variable
- [`set_var_sexgender()`](https://bayesiandemography.github.io/bage/reference/set_var_sexgender.md)
  : Specify Sex or Gender Variable
- [`set_var_time()`](https://bayesiandemography.github.io/bage/reference/set_var_time.md)
  : Specify Time Variable
- [`ssvd()`](https://bayesiandemography.github.io/bage/reference/ssvd.md)
  : Create Object to Hold Data from a Scaled SVD
- [`svds`](https://bayesiandemography.github.io/bage/reference/svds.md)
  : Scaled SVDs
- [`swe_infant`](https://bayesiandemography.github.io/bage/reference/swe_infant.md)
  : Infant Mortality in Sweden
- [`tidy(`*`<bage_mod>`*`)`](https://bayesiandemography.github.io/bage/reference/tidy.bage_mod.md)
  : Summarize Terms from a Fitted Model
- [`unfit()`](https://bayesiandemography.github.io/bage/reference/unfit.md)
  : Unfit a Model
- [`usa_deaths`](https://bayesiandemography.github.io/bage/reference/usa_deaths.md)
  : Accidental Deaths in the USA

# Articles

### All vignettes

- [1.
  Overview](https://bayesiandemography.github.io/bage/articles/vig01_intro.md):
- [2. Mathematical
  Details](https://bayesiandemography.github.io/bage/articles/vig02_math.md):
- [3.
  Priors](https://bayesiandemography.github.io/bage/articles/vig03_priors.md):
- [4. Singular Value
  Decomposition](https://bayesiandemography.github.io/bage/articles/vig04_svd.md):
- [5. Examples from BDEF
  Book](https://bayesiandemography.github.io/bage/articles/vig05_bdef.md):
- [6. Modelling
  Mortality](https://bayesiandemography.github.io/bage/articles/vig06_mortality.md):
- [7.
  Simulation](https://bayesiandemography.github.io/bage/articles/vig07_simulation.md):
- [8. Bayesian
  Workflow](https://bayesiandemography.github.io/bage/articles/vig08_workflow.md):
- [9.
  Covariates](https://bayesiandemography.github.io/bage/articles/vig09_covariates.md):
- [10. Data
  Models](https://bayesiandemography.github.io/bage/articles/vig10_datamod.md):
