<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Dynamic SVD-Based Priors for Age Profiles or Age-Sex Profiles — SVD_AR • bage</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Dynamic SVD-Based Priors for Age Profiles or Age-Sex Profiles — SVD_AR"><meta name="description" content="Use components from a Singular Value Decomposition (SVD)
to model an interaction involving age and time, or age,
sex/gender and time, where the coefficients evolve over time."><meta property="og:description" content="Use components from a Singular Value Decomposition (SVD)
to model an interaction involving age and time, or age,
sex/gender and time, where the coefficients evolve over time."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bage</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/vig01_intro.html">1. Overview</a></li>
    <li><a class="dropdown-item" href="../articles/vig02_math.html">2. Mathematical Details</a></li>
    <li><a class="dropdown-item" href="../articles/vig03_priors.html">3. Priors</a></li>
    <li><a class="dropdown-item" href="../articles/vig04_svd.html">4. Singular Value Decomposition</a></li>
    <li><a class="dropdown-item" href="../articles/vig05_bdef.html">5. Examples from BDEF Book</a></li>
    <li><a class="dropdown-item" href="../articles/vig06_mortality.html">6. Modelling Mortality</a></li>
    <li><a class="dropdown-item" href="../articles/vig07_simulation.html">7. Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/vig08_workflow.html">8. Bayesian Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/vig09_covariates.html">9. Covariates</a></li>
    <li><a class="dropdown-item" href="../articles/vig10_datamod.html">10. Data Models</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bayesiandemography/bage/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Dynamic SVD-Based Priors for Age Profiles or Age-Sex Profiles</h1>
      <small class="dont-index">Source: <a href="https://github.com/bayesiandemography/bage/blob/main/R/bage_prior-constructors.R" class="external-link"><code>R/bage_prior-constructors.R</code></a></small>
      <div class="d-none name"><code>SVD_AR.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Use components from a Singular Value Decomposition (SVD)
to model an interaction involving age and time, or age,
sex/gender and time, where the coefficients evolve over time.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">SVD_AR</span><span class="op">(</span></span>
<span>  <span class="va">ssvd</span>,</span>
<span>  n_comp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  indep <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_coef <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  s <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  shape1 <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  shape2 <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  con <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"by"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SVD_AR1</span><span class="op">(</span></span>
<span>  <span class="va">ssvd</span>,</span>
<span>  n_comp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  indep <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  min <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">0.98</span>,</span>
<span>  s <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  shape1 <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  shape2 <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  con <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"by"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SVD_RW</span><span class="op">(</span><span class="va">ssvd</span>, n_comp <span class="op">=</span> <span class="cn">NULL</span>, indep <span class="op">=</span> <span class="cn">TRUE</span>, s <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">1</span>, con <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"by"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SVD_RW2</span><span class="op">(</span></span>
<span>  <span class="va">ssvd</span>,</span>
<span>  n_comp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  indep <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  s <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sd_slope <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  con <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"by"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ssvd">ssvd<a class="anchor" aria-label="anchor" href="#arg-ssvd"></a></dt>
<dd><p>Object of class <code>"bage_ssvd"</code>
holding a scaled SVD. See below for scaled SVDs
of databases currently available in <strong>bage</strong>.</p></dd>


<dt id="arg-n-comp">n_comp<a class="anchor" aria-label="anchor" href="#arg-n-comp"></a></dt>
<dd><p>Number of components from scaled SVD
to use in modelling. The default is half
the number of components of <code>ssvd</code>.</p></dd>


<dt id="arg-indep">indep<a class="anchor" aria-label="anchor" href="#arg-indep"></a></dt>
<dd><p>Whether to use separate or
combined SVDs in terms involving sex or gender.
Default is <code>TRUE</code>.
See below for details.</p></dd>


<dt id="arg-n-coef">n_coef<a class="anchor" aria-label="anchor" href="#arg-n-coef"></a></dt>
<dd><p>Number of AR coefficients in <code>SVD_RW()</code>.</p></dd>


<dt id="arg-s">s<a class="anchor" aria-label="anchor" href="#arg-s"></a></dt>
<dd><p>Scale for standard deviations terms.</p></dd>


<dt id="arg-shape-shape-">shape1, shape2<a class="anchor" aria-label="anchor" href="#arg-shape-shape-"></a></dt>
<dd><p>Parameters for prior
for coefficients in <code>SVD_AR()</code>.
Defaults are <code>5</code> and <code>5</code>.</p></dd>


<dt id="arg-con">con<a class="anchor" aria-label="anchor" href="#arg-con"></a></dt>
<dd><p>Constraints on parameters.
Current choices are <code>"none"</code> and <code>"by"</code>.
Default is <code>"none"</code>. See below for details.</p></dd>


<dt id="arg-min-max">min, max<a class="anchor" aria-label="anchor" href="#arg-min-max"></a></dt>
<dd><p>Minimum and maximum values
for autocorrelation coefficient in <code>SVD_AR1()</code>.
Defaults are <code>0.8</code> and <code>0.98</code>.</p></dd>


<dt id="arg-sd">sd<a class="anchor" aria-label="anchor" href="#arg-sd"></a></dt>
<dd><p>Standard deviation
of initial value for random walks. Default is <code>1</code>.
Can be <code>0</code>.</p></dd>


<dt id="arg-sd-slope">sd_slope<a class="anchor" aria-label="anchor" href="#arg-sd-slope"></a></dt>
<dd><p>Standard deviation in prior
for initial slope. Default is <code>1</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>"bage_prior_svd_ar"</code>,
<code>"bage_prior_svd_rw"</code>, or <code>"bage_prior_svd_rw2"</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>SVD_AR()</code>, <code>SVD_AR1()</code>, <code>SVD_RW()</code>, and <code>SVD_RW2()</code>
priors assume that, in any given period,
the age profiles or age-sex profiles for the quantity
being modelled looks like they were drawn at random
from an external demographic database. For instance,
the <code>SVD_AR()</code> prior obtained via</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">SVD_AR</span>(HMD)</span></code></pre><p></p></div>
<p>assumes that profiles look like
they were obtained from the
<a href="https://www.mortality.org" class="external-link">Human Mortality Database</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="mathematical-details">Mathematical details<a class="anchor" aria-label="anchor" href="#mathematical-details"></a></h2>



<p>When the interaction being modelled only involves
age and time, or age, sex/gender, and time</p>
<p>$$\pmb{\beta}_t = \pmb{F} \pmb{\alpha}_t + \pmb{g},$$</p>
<p>and when it involves other variables besides age, sex/gender, and time,</p>
<p>$$\pmb{\beta}_{u,t} = \pmb{F} \pmb{\alpha}_{u,t} + \pmb{g},$$</p>
<p>where</p><ul><li><p>\(\pmb{\beta}\) is an interaction involving age, time, possibly sex/gender,
and possibly other variables;</p></li>
<li><p>\(\pmb{\beta}_t\) is a subvector of \(\pmb{\beta}\) holding
values for period \(t\);</p></li>
<li><p>\(\pmb{\beta}_{u,t}\) is a subvector of \(\pmb{\beta}_t\) holding
values for the  \(u\)th combination of the non-age, non-time,
non-sex/gender variables for period \(t\);</p></li>
<li><p>\(\pmb{F}\) is a known matrix; and</p></li>
<li><p>\(\pmb{g}\) is a known vector.</p></li>
</ul><p>\(\pmb{F}\) and \(\pmb{g}\) are constructed from
a large database of age-specific demographic estimates
by applying the singular value decomposition, and then standardizing.</p>
<p>With <code>SVD_AR()</code>, the prior for the \(k\)th element
of \(\pmb{\alpha}_t\) or \(\pmb{\alpha}_{u,t}\) is</p>
<p>$$\alpha_{k,t} = \phi_1 \alpha_{k,t-1} + \cdots + \phi_n \beta_{k,t-n} + \epsilon_{k,t}$$</p>
<p>or</p>
<p>$$\alpha_{k,u,t} = \phi_1 \alpha_{k,u,t-1} + \cdots + \phi_n \beta_{k,u,t-n} + \epsilon_{k,u,t};$$</p>
<p>with <code>SVD_AR1()</code>, it is</p>
<p>$$\alpha_{k,t} = \phi \alpha_{k,t-1} + \epsilon_{k,t}$$</p>
<p>or</p>
<p>$$\alpha_{k,u,t} = \phi \alpha_{k,u,t-1} + \epsilon_{k,u,t};$$</p>
<p>with <code>SVD_RW()</code>, it is</p>
<p>$$\alpha_{k,t} = \alpha_{k,t-1} + \epsilon_{k,t}$$</p>
<p>or</p>
<p>$$\alpha_{k,u,t} = \alpha_{k,u,t-1} + \epsilon_{k,u,t};$$</p>
<p>and with <code>SVD_RW2()</code>, it is</p>
<p>$$\alpha_{k,t} = 2 \alpha_{k,t-1} - \alpha_{k,t-2} + \epsilon_{k,t}$$</p>
<p>or</p>
<p>$$\alpha_{k,u,t} = 2 \alpha_{k,u,t-1} - \alpha_{k,u,t-2} + \epsilon_{k,u,t}.$$</p>
<p>For details, see <code><a href="AR.html">AR()</a></code>, <code><a href="AR1.html">AR1()</a></code>,
<code><a href="RW.html">RW()</a></code>, and <code><a href="RW2.html">RW2()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="constraints">Constraints<a class="anchor" aria-label="anchor" href="#constraints"></a></h2>



<p>With some combinations of terms and priors, the values of
the intercept, main effects, and interactions are
are only weakly identified.
For instance, it may be possible to increase the value of the
intercept and reduce the value of the remaining terms in
the model with no effect on predicted rates and only a tiny
effect on prior probabilities. This weak identifiability is
typically harmless. However, in some applications, such as
when trying to obtain interpretable values
for main effects and interactions, it can be helpful to increase
identifiability through the use of constraints, specified through the
<code>con</code> argument.</p>
<p>Current options for <code>con</code> are:</p><ul><li><p><code>"none"</code> No constraints. The default.</p></li>
<li><p><code>"by"</code> Only used in interaction terms that include 'along' and
'by' dimensions. Within each value of the 'along'
dimension, terms across each 'by' dimension are constrained
to sum to 0.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="scaled-svds-of-demographic-databases-in-bage">Scaled SVDs of demographic databases in bage<a class="anchor" aria-label="anchor" href="#scaled-svds-of-demographic-databases-in-bage"></a></h2>


<ul><li><p><code><a href="HMD.html">HMD</a></code> Mortality rates from the
<a href="https://www.mortality.org" class="external-link">Human Mortality Database</a>.</p></li>
<li><p><code><a href="HFD.html">HFD</a></code> Fertility rates from the
<a href="https://www.humanfertility.org" class="external-link">Human Fertility Database</a>.</p></li>
<li><p><code><a href="LFP.html">LFP</a></code> Labor forcce participation
rates from the <a href="https://data-explorer.oecd.org" class="external-link">OECD</a>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>For details of the construction of
scaled SVDS see the</p></li>
<li><p><a href="https://bayesiandemography.github.io/bage/articles/vig02_math.html">Mathematical Details</a>
vignette</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="SVD.html">SVD()</a></code> SVD prior for non-time-varying terms</p></li>
<li><p><code><a href="RW.html">RW()</a></code> Smoothing via random walk</p></li>
<li><p><code><a href="RW2.html">RW2()</a></code> Smoothing via second-order random walk</p></li>
<li><p><code><a href="Sp.html">Sp()</a></code> Smoothing via splines</p></li>
<li><p><a href="priors.html">priors</a> Overview of priors implemented in <strong>bage</strong></p></li>
<li><p><code><a href="set_prior.html">set_prior()</a></code> Specify prior for intercept,
main effect, or interaction</p></li>
<li><p><code><a href="set_var_sexgender.html">set_var_sexgender()</a></code> Identify sex or gender variable in data</p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">SVD_AR1</span><span class="op">(</span><span class="va">HMD</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SVD_AR1(HMD) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ssvd: HMD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n_comp: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        min: 0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        max: 0.98</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          s: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      along: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        con: none</span>
<span class="r-in"><span><span class="fu">SVD_RW</span><span class="op">(</span><span class="va">HMD</span>, n_comp <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SVD_RW(HMD) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ssvd: HMD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n_comp: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          s: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sd: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      along: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        con: none</span>
<span class="r-in"><span><span class="fu">SVD_RW2</span><span class="op">(</span><span class="va">HMD</span>, indep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SVD_RW2(HMD,indep=FALSE) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ssvd: HMD</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n_comp: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      indep: FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          s: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sd: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sd_slope: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      along: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        con: none</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by John Bryant, Junni Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

