<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>P-Spline Prior — Sp • bage</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="P-Spline Prior — Sp"><meta name="description" content="Use a p-spline (penalised spline) to model main
effects or interactions. Typically used with age,
but can be used with any variable where outcomes are
expected to vary smoothly from one element to the next."><meta property="og:description" content="Use a p-spline (penalised spline) to model main
effects or interactions. Typically used with age,
but can be used with any variable where outcomes are
expected to vary smoothly from one element to the next."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bage</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.10.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bayesiandemography/bage/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>P-Spline Prior</h1>
      <small class="dont-index">Source: <a href="https://github.com/bayesiandemography/bage/blob/main/R/bage_prior-constructors.R" class="external-link"><code>R/bage_prior-constructors.R</code></a></small>
      <div class="d-none name"><code>Sp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Use a p-spline (penalised spline) to model main
effects or interactions. Typically used with age,
but can be used with any variable where outcomes are
expected to vary smoothly from one element to the next.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Sp</span><span class="op">(</span></span>
<span>  n_comp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  s <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sd_slope <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  along <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  con <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"by"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-n-comp">n_comp<a class="anchor" aria-label="anchor" href="#arg-n-comp"></a></dt>
<dd><p>Number of spline basis functions (components)
to use.</p></dd>


<dt id="arg-s">s<a class="anchor" aria-label="anchor" href="#arg-s"></a></dt>
<dd><p>Scale for the prior for the innovations.
Default is <code>1</code>.</p></dd>


<dt id="arg-sd">sd<a class="anchor" aria-label="anchor" href="#arg-sd"></a></dt>
<dd><p>Standard deviation in prior for first
element of random walk.</p></dd>


<dt id="arg-sd-slope">sd_slope<a class="anchor" aria-label="anchor" href="#arg-sd-slope"></a></dt>
<dd><p>Standard deviation in prior
for initial slope of random walk. Default is <code>1</code>.</p></dd>


<dt id="arg-along">along<a class="anchor" aria-label="anchor" href="#arg-along"></a></dt>
<dd><p>Name of the variable to be used
as the 'along' variable. Only used with
interactions.</p></dd>


<dt id="arg-con">con<a class="anchor" aria-label="anchor" href="#arg-con"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
Constraints on parameters.
Current choices are <code>"none"</code> and <code>"by"</code>.
Default is <code>"none"</code>. See below for details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>"bage_prior_spline"</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If <code>Sp()</code> is used with an interaction,
separate splines are used for the 'along' variable within
each combination of the
'by' variables.</p>
    </div>
    <div class="section level2">
    <h2 id="mathematical-details">Mathematical details<a class="anchor" aria-label="anchor" href="#mathematical-details"></a></h2>



<p>When <code>Sp()</code> is used with a main effect,</p>
<p>$$\pmb{\beta} = \pmb{X} \pmb{\alpha}$$</p>
<p>and when it is used with an interaction,</p>
<p>$$\pmb{\beta}_u = \pmb{X} \pmb{\alpha}_u$$</p>
<p>where</p><ul><li><p>\(\pmb{\beta}\) is the main effect or interaction, with \(J\) elements;</p></li>
<li><p>\(\pmb{\beta}_u\) is a subvector of \(\pmb{\beta}\) holding
values for the  \(u\)th combination of the 'by' variables;</p></li>
<li><p>\(J\) is the number of elements of \(\pmb{\beta}\);</p></li>
<li><p>\(U\) is the number of elements of \(\pmb{\beta}_u\);</p></li>
<li><p>\(X\) is a \(J \times n\) or \(V \times n\) matrix of
spline basis functions; and</p></li>
<li><p>\(n\) is <code>n_comp</code>.</p></li>
</ul><p>The elements of \(\pmb{\alpha}\) or \(\pmb{\alpha}_u\) are assumed
to follow a <a href="RW2.html">second-order random walk</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="constraints">Constraints<a class="anchor" aria-label="anchor" href="#constraints"></a></h2>



<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a> The specification of
constraints is likely to change in future versions of <span class="pkg">bage</span>.</p>
<p>With some combinations of terms and priors, the values of
the intercept, main effects, and interactions are
are only weakly identified.
For instance, it may be possible to increase the value of the
intercept and reduce the value of the remaining terms in
the model with no effect on predicted rates and only a tiny
effect on prior probabilities. This weak identifiability is
typically harmless. However, in some applications, such as
when trying to obtain interpretable values
for main effects and interactions, it can be helpful to increase
identifiability through the use of constraints, specified through the
<code>con</code> argument.</p>
<p>Current options for <code>con</code> are:</p><ul><li><p><code>"none"</code> No constraints. The default.</p></li>
<li><p><code>"by"</code> Only used in interaction terms that include 'along' and
'by' dimensions. Within each value of the 'along'
dimension, terms across each 'by' dimension are constrained
to sum to 0.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Eilers, P.H.C. and Marx B. (1996).
"Flexible smoothing with B-splines and penalties".
Statistical Science. 11 (2): 89–121.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="RW.html">RW()</a></code> Smoothing via random walk</p></li>
<li><p><code><a href="RW2.html">RW2()</a></code> Smoothing via second-order random walk</p></li>
<li><p><code><a href="SVD.html">SVD()</a></code> Smoothing of age via singular value decomposition</p></li>
<li><p><a href="priors.html">priors</a> Overview of priors implemented in <span class="pkg">bage</span></p></li>
<li><p><code><a href="set_prior.html">set_prior()</a></code> Specify prior for intercept,
main effect, or interaction</p></li>
<li><p><code><a href="https://rdrr.io/r/splines/bs.html" class="external-link">splines::bs()</a></code> Function used by <span class="pkg">bage</span> to construct
spline basis functions</p></li>
<li><p><a href="https://bayesiandemography.github.io/bage/articles/vig02_math.html">Mathematical Details</a>
vignette</p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">Sp</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sp() </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n_comp: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          s: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sd: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sd_slope: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      along: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        con: none</span>
<span class="r-in"><span><span class="fu">Sp</span><span class="op">(</span>n_comp <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sp(n_comp=10) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n_comp: 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          s: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         sd: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sd_slope: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      along: NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        con: none</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by John Bryant, Junni Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

