[{"path":"https://bayesiandemography.github.io/bage/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 Bayesian Demography Limited Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"2. Mathematical Details","text":"Specification document - mathematical description models used bage. Note: features described implemented yet.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"input-data","dir":"Articles","previous_headings":"2 Likelihood","what":"Input data","title":"2. Mathematical Details","text":"outcome variable: events, numbers people, sort measure continuous variable income expenditure exposure/size/weights disagg one variables. Almost always includes age, sex/gender, time. May include variables eg region, ethnicity, education. combinations variables present; may missing values","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:pois","dir":"Articles","previous_headings":"2 Likelihood > 2.2 Models","what":"Poisson","title":"2. Mathematical Details","text":"Let \\(y_i\\) count events cell \\(= 1, \\cdots, n\\) let \\(w_i\\) corresponding exposure measure, possibility \\(w_i \\equiv 1\\). likelihood Poisson model \\[\\begin{align}   y_i & \\sim \\text{Poisson}(\\gamma_i w_i) \\tag{2.1} \\\\   \\gamma_i & \\sim \\text{Gamma}\\left(\\xi^{-1}, (\\mu_i \\xi)^{-1}\\right),  \\tag{2.2} \\end{align}\\] using shape-rates parameterisation Gamma distribution. Parameter \\(\\xi\\) governs dispersion, \\[\\begin{equation}   \\text{var}(\\gamma_i \\mid \\mu_i, \\xi) = \\xi \\mu_i^2 \\end{equation}\\] \\[\\begin{equation}   \\text{var}(y_i \\mid \\mu_i, \\xi, w_i) = (1 + \\xi \\mu_i w_i ) \\times \\mu_i w_i. \\end{equation}\\] allow \\(\\xi\\) equal 0, case model reduces \\[\\begin{equation}   y_i \\sim \\text{Poisson}(\\mu_i w_i). \\end{equation}\\] \\(\\xi > 0\\), Equations (2.1) (2.2) equivalent \\[\\begin{equation}   y_i \\sim \\text{NegBinom}\\left(\\xi^{-1}, (1 + \\mu_i w_i \\xi)^{-1}\\right) \\end{equation}\\] (Norton, Christen, Fox 2018; Simpson 2022). format use internally estimation. values \\(\\gamma_i\\) needed, generate fly, using fact \\[\\begin{equation}   \\gamma_i \\mid y_i, w_i, \\mu_i, \\xi \\sim \\text{Gamma}\\left(y_i + \\xi^{-1}, w_i + (\\xi \\mu_i)^{-1}\\right). \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:binom","dir":"Articles","previous_headings":"2 Likelihood > 2.2 Models","what":"Binomial","title":"2. Mathematical Details","text":"likelihood binomial model \\[\\begin{align}   y_i  & \\sim \\text{Binomial}(w_i, \\gamma_i) \\tag{2.3} \\\\   \\gamma_i & \\sim \\text{Beta}\\left(\\xi^{-1} \\mu_i, \\xi^{-1}(1 - \\mu_i)\\right). \\tag{2.4} \\end{align}\\] Parameter \\(\\xi\\) governs dispersion, \\[\\begin{equation}   \\text{var}(\\gamma_i \\mid \\mu_i, \\xi) =  \\frac{\\xi}{1 + \\xi} \\times \\mu_i (1 -\\mu_i) \\end{equation}\\] \\[\\begin{equation}   \\text{var}(y_i \\mid w_i, \\mu_i, \\xi) =  \\frac{\\xi w_i + 1}{\\xi + 1} \\times w_i \\mu_i (1 - \\mu_i). \\end{equation}\\] allow \\(\\xi\\) equal 0, case model reduces \\[\\begin{equation}   y_i  \\text{Binom}(w_i, \\mu_i). \\end{equation}\\] Equations (2.3) (2.4) equivalent \\[\\begin{equation}   y_i  \\sim \\text{BetaBinom}\\left(w_i, \\xi^{-1} \\mu_i, \\xi^{-1} (1 - \\mu_i) \\right), \\end{equation}\\] use internally. Values \\(\\gamma_i\\) can generated using \\[\\begin{equation}   \\gamma_i \\mid y_i, w_i, \\mu_i, \\xi \\sim \\text{Beta}\\left(y_i + \\xi^{-1} \\mu_i, w_i - y_i + \\xi^{-1}(1-\\mu_i) \\right). \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:norm","dir":"Articles","previous_headings":"2 Likelihood > 2.2 Models","what":"Normal","title":"2. Mathematical Details","text":"\\[\\begin{equation}   y_i \\sim \\text{N}(\\mu_i, w_i^{-1}\\xi^2) \\end{equation}\\] \\(w_i\\) weights. Response \\(y_i\\) standardized mean 0 standard deviation 1. set \\[\\begin{equation}   y_i = \\frac{y_i^{*} - \\bar{y}^*}{s^*} \\end{equation}\\] \\(y_i^*\\) values originally supplied user, \\(\\bar{y}^*\\) \\(s^*\\) mean standard deviation \\(y_i^*\\).","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-for-means","dir":"Articles","previous_headings":"","what":"Model for means","title":"2. Mathematical Details","text":"Let \\(\\pmb{\\mu} = (\\mu_1, \\cdots, \\mu_n)^{\\top}\\). model \\(\\pmb{\\mu}\\) \\[\\begin{equation}   \\pmb{\\mu} = \\sum_{m=0}^{M} \\pmb{X}^{(m)} \\pmb{\\beta}^{(m)} + \\pmb{Z} \\pmb{\\zeta} \\tag{3.1} \\end{equation}\\] \\(\\beta^{(0)}\\) intercept; \\(\\pmb{\\beta}^{(m)}\\), \\(m=1,\\cdots,M\\) vector \\(J_m\\) elements describing main effect interaction formed dimensions data \\(\\pmb{y}\\); \\(\\pmb{X}^{(m)}\\) \\(n \\times J_m\\) matrix 1s 0s, \\(\\)th row picks element \\(\\pmb{\\beta}^{(m)}\\) used cell \\(\\); \\(\\pmb{Z}\\) \\(n \\times P\\) matrix covariates; \\(\\pmb{\\zeta}\\) coefficent vector \\(P\\) elements.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:priors","dir":"Articles","previous_headings":"","what":"Priors for Intercept, Main Effects, and Interactions","title":"2. Mathematical Details","text":"algorithm assigning default priors: \\(\\pmb{\\beta}^{(m)}\\) one two elements, assign \\(\\pmb{\\beta}^{(m)}\\) fixed-normal prior (Section 4.2); otherwise, \\(\\pmb{\\beta}^{(m)}\\) age time main effect, assign \\(\\pmb{\\beta}^{(m)}\\) random walk prior (Section 4.3); otherwise, assign \\(\\pmb{\\beta}^{(m)}\\) normal prior (Section 4.1) intercept term \\(\\pmb{\\beta}^{(0)}\\) can given fixed-normal prior (Section 4.2) Known prior (Section 4.17).","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.1 Normal","what":"Model","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\beta_j^{(m)} & \\sim \\text{N}\\left(0, \\tau_m^2 \\right) \\\\   \\tau_m & \\sim \\text{N}^+\\left(0, A_{\\tau}^{(m)2}\\right) \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.1 Normal","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\prod_{j=1}^{J_m} \\text{N}(\\beta_j^{(m)} \\mid 0, \\tau_m^2) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"simulation","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.1 Normal","what":"Simulation","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\tau_m & \\sim \\text{N}^+\\left(0, A_{\\tau}^{(m)2}\\right) \\\\   \\beta_j^{(m)} & \\sim \\text{N}\\left(0, \\tau_m^2 \\right) \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.1 Normal","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{equation}     \\beta_{J_m+h+1}^{(m)} \\sim \\text{N}(0, \\tau_m^2) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.1 Normal","what":"Code","title":"2. Mathematical Details","text":"s \\(A_{\\tau}^{(m)}\\). Defaults 1.","code":"N(s = 1)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-1","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.2 Fixed normal","what":"Model","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\beta_j^{(m)} \\sim \\text{N}\\left(0, A_{\\beta}^{(m)2}\\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-1","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.2 Fixed normal","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\prod_{j=1}^{J_m} \\text{N}(\\beta_j^{(m)} \\mid 0, A_{\\beta}^{(m)2}) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"simulation-1","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.2 Fixed normal","what":"Simulation","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\beta_j^{(m)} \\sim \\text{N}\\left(0, A_{\\beta}^{(m)2}\\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-1","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.2 Fixed normal","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{equation}     \\beta_{J_m+h+1}^{(m)} \\sim \\text{N}(0, A_{\\beta}^{(m)2}) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-1","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.2 Fixed normal","what":"Code","title":"2. Mathematical Details","text":"sd \\(A_{\\tau}^{(m)}\\). Defaults 1.","code":"NFix(sd = 1)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-2","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.3 First-order random walk","what":"Model","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\beta_{u1}^{(m)} & \\sim \\text{N}(0, 1), \\quad u = 1, \\cdots, U_m \\\\   \\beta_{uv}^{(m)} & \\sim \\text{N}(\\beta_{u,v-1}^{(m)}, \\tau_m^2), \\quad u = 1, \\cdots, U_m, v = 2, \\cdots, V_m \\\\   \\tau_m & \\sim \\text{N}^+\\left(0, A_{\\tau}^{(m)2}\\right) \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-2","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.3 First-order random walk","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\prod_{u=1}^{U_m} \\text{N}(\\beta_{u1}^{(m)} \\mid 0, 1)  \\prod_{u=1}^{U_m} \\prod_{v=2}^{V_m} \\text{N}\\left(\\beta_{uv}^{(m)} \\mid \\beta_{u,v-1}^{(m)}, \\tau_m^2 \\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"simulation-2","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.3 First-order random walk","what":"Simulation","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\tau_m & \\sim \\text{N}^+\\left(0, A_{\\tau}^{(m)2}\\right) \\\\   \\beta_{u,1}^{(m)} & \\sim \\text{N}(0, 1), \\quad u = 1, \\cdots, U_m, \\\\   \\beta_{u,v}^{(m)} & \\sim \\text{N}(\\beta_{u,v-1}^{(m)}, \\tau_m^2), \\quad u = 1, \\cdots, U_m, v = 2, \\cdots, V_m \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-2","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.3 First-order random walk","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\beta_{u,V_m+h}^{(m)} \\sim \\text{N}(\\beta_{u,V_m+h-1}^{(m)}, \\tau_m^2), \\quad u = 1, \\cdots, U_m \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-2","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.3 First-order random walk","what":"Code","title":"2. Mathematical Details","text":"s \\(A_{\\tau}^{(m)}\\). Defaults 1. along used identify “along” “” dimensions","code":"RW(s = 1, along = NULL)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-3","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.4 Second-order random walk","what":"Model","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\beta_{u,v}^{(m)} & \\sim \\text{N}(0, 1), \\quad u = 1,\\cdots, U_m, \\quad v = 1,2 \\\\   \\beta_{u,v}^{(m)} & \\sim \\text{N}(2 \\beta_{u,v-1}^{(m)} - \\beta_{u,v-2}^{(m)}, \\tau_m^2), \\quad u = 1, \\cdots, U_m, \\quad v = 3, \\cdots, V_m \\\\   \\tau_m & \\sim \\text{N}^+\\left(0, A_{\\tau}^{(m)2}\\right) \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-3","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.4 Second-order random walk","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\prod_{u=1}^{U_m} \\prod_{v=1}^2 \\text{N}(\\beta_{u,v}^{(m)} \\mid 0, 1) \\prod_{u=1}^{U_m}\\prod_{v=3}^{V_m} \\text{N}\\left(\\beta_{u,v}^{(m)} - 2 \\beta_{u,v-1}^{(m)} + \\beta_{u,v-2}^{(m)} \\mid 0, \\tau_m^2 \\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"simulation-3","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.4 Second-order random walk","what":"Simulation","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\tau_m & \\sim \\text{N}^+\\left(0, A_{\\tau}^{(m)2}\\right) \\\\   \\beta_{u,v}^{(m)} & \\sim \\text{N}(0, 1), \\quad u = 1, \\cdots, U_m, \\quad v = 1,2 \\\\   \\beta_{u,v}^{(m)} & \\sim \\text{N}(2 \\beta_{u,v-1}^{(m)} - \\beta_{u,v-2}^{(m)}, \\tau_m^2), \\quad u = 1, \\cdots, U_m, \\quad v = 3,\\cdots,V_m \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-3","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.4 Second-order random walk","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\beta_{u,V_m+h}^{(m)} \\sim \\text{N}(2 \\beta_{u,V_m+h-1}^{(m)} - \\beta_{u,V_m+h-2}^{(m)}, \\tau_m^2) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-3","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.4 Second-order random walk","what":"Code","title":"2. Mathematical Details","text":"s \\(A_{\\tau}^{(m)}\\) sd \\(A_{\\eta}^{(m)}\\) along used identify “along” “” dimensions","code":"RW2(s = 1, sd = 1, along = NULL)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-4","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.5 Random walk with seasonal effect","what":"Model","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\beta_{u,v}^{(m)} & = \\alpha_{u,v} + \\lambda_{u,s_v}, \\quad u = 1, \\cdots, U_m, \\quad v = 1, \\cdots, V_m \\\\   \\alpha_{u,1}^{(m)} & \\sim \\text{N}(0, 1), \\quad u = 1, \\cdots, U_m \\\\   \\alpha_{u,v}^{(m)} & \\sim \\text{N}(\\alpha_{u,v-1}^{(m)}, \\tau_m^2), \\quad u = 1, \\cdots, U_m, \\quad v = 2, \\cdots, V_m \\\\   \\lambda_{u,v}^{(m)} & \\sim \\text{N}(0, 1), \\quad u = 1, \\cdots, U_m, \\quad v = 1, \\cdots, S_m \\\\   \\lambda_{u,v}^{(m)} & \\sim \\text{N}(\\lambda_{u,v-S_m}^{(m)}, \\omega_m^2), \\quad u = 1, \\cdots, U_m, \\quad v = S_m + 1, \\cdots, V_m \\tag{4.1} \\\\ \\\\   \\tau_m & \\sim \\text{N}^+\\left(0, A_{\\tau}^{(m)2}\\right) \\\\   \\omega_m & \\sim \\text{N}^+\\left(0, A_{\\omega}^{(m)2}\\right) \\end{align}\\] allow \\(A_{\\omega}^{(m)2}\\) set zero, case (4.1) reduces \\[\\begin{equation}   \\lambda_{u,v}^{(m)} = \\lambda_{u,v-S_m}^{(m)}, \\quad u = 1, \\cdots, U_m, \\quad v = S_m + 1, \\cdots, V_m, \\end{equation}\\] implying seasonal effects constant across years.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-4","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.5 Random walk with seasonal effect","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation} \\begin{split}   & \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\text{N}(\\omega_m \\mid 0, A_{\\omega}^{(m)2}) \\\\   \\quad \\times & \\prod_{u=1}^{U_m} \\left( \\text{N}(\\alpha_{u,1}^{(m)} \\mid 0, 1 ) \\prod_{v=2}^{V_m} \\text{N}(\\alpha_{u,v}^{(m)} \\mid \\alpha_{u,v-1}^{(m)}, \\tau_m^2 ) \\prod_{v=1}^{S_m} \\text{N}(\\lambda_{u,v}^{(m)} \\mid 0, 1) \\prod_{v=S_m+1}^{V_m} \\text{N}(\\lambda_{u,v}^{(m)} \\mid \\lambda_{u,v-S_m}^{(m)}, \\omega_m^2) \\right) \\end{split} \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-4","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.5 Random walk with seasonal effect","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\alpha_{J_m+h}^{(m)} & \\sim \\text{N}(\\alpha_{J_m+h-1}^{(m)}, \\tau_m^2) \\\\   \\lambda_{J_m+h}^{(m)} & \\sim \\text{N}(\\lambda_{J_m+h-S_m}^{(m)}, \\omega_m^2) \\\\   \\beta_{J_m+h}^{(m)} & = \\alpha_{J_m+h}^{(m)} + \\lambda_{J_m+h}^{(m)} \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-4","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.5 Random walk with seasonal effect","what":"Code","title":"2. Mathematical Details","text":"n \\(S_m\\) s \\(A_{\\tau}^{(m)}\\) s_seas \\(A_{\\omega}^{(m)}\\) along used identify “along” “” dimensions","code":"RWSeas(n, s = 1, s_seas = 1, along = NULL)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-5","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.6 Random walk with drift, with seasonal effect","what":"Model","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\beta_{u,v}^{(m)} & = \\alpha_{u,v} + \\lambda_{u,s_v}, \\quad u = 1, \\cdots, U_m, \\quad v = 1, \\cdots, V_m \\\\   \\alpha_{u,v}^{(m)} & \\sim \\text{N}(0, 1), \\quad u = 1, \\cdots, U_m, \\quad \\quad v = 1,2,  \\\\   \\alpha_{u,v}^{(m)} & \\sim \\text{N}(2 \\alpha_{u,v-1}^{(m)} - \\alpha_{u,v-2}^{(m)}, \\tau_m^2), \\quad u = 1, \\cdots, U_m, \\quad v = 3, \\cdots, V_m \\\\   \\lambda_{u,v}^{(m)} & \\sim \\text{N}(0, 1), \\quad u = 1, \\cdots, U_m, \\quad v = 1, \\cdots, S_m \\\\   \\lambda_{u,v}^{(m)} & \\sim \\text{N}(\\lambda_{u,v-S_m}^{(m)}, \\omega_m^2), \\quad u = 1, \\cdots, U_m, \\quad v = S_m + 1, \\cdots, V_m \\tag{4.1} \\\\ \\\\   \\tau_m & \\sim \\text{N}^+\\left(0, A_{\\tau}^{(m)2}\\right) \\\\   \\omega_m & \\sim \\text{N}^+\\left(0, A_{\\omega}^{(m)2}\\right) \\end{align}\\] allow \\(A_{\\omega}^{(m)2}\\) set zero, case (4.1) reduces \\[\\begin{equation}   \\lambda_{u,v}^{(m)} = \\lambda_{u,v-S_m}^{(m)}, \\quad u = 1, \\cdots, U_m, \\quad v = S_m + 1, \\cdots, V_m, \\end{equation}\\] implying seasonal effects constant across years.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-5","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.6 Random walk with drift, with seasonal effect","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation} \\begin{split}   & \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\text{N}(\\omega_m \\mid 0, A_{\\omega}^{(m)2}) \\\\   \\quad \\times & \\prod_{u=1}^{U_m} \\left( \\text{N}(\\alpha_{u,1}^{(m)} \\mid 0, 1 ) \\prod_{v=2}^{V_m} \\text{N}(\\alpha_{u,v}^{(m)} \\mid 2 \\alpha_{u,v-1}^{(m)} - \\alpha_{u,v-2}^{(m)}, \\tau_m^2 ) \\prod_{v=1}^{S_m} \\text{N}(\\lambda_{u,v}^{(m)} \\mid 0, 1) \\prod_{v=S_m+1}^{V_m} \\text{N}(\\lambda_{u,v}^{(m)} \\mid \\lambda_{u,v-S_m}^{(m)}, \\omega_m^2) \\right) \\end{split} \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-5","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.6 Random walk with drift, with seasonal effect","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\alpha_{J_m+h}^{(m)} & \\sim \\text{N}(2 \\alpha_{J_m+h-1}^{(m)} - \\alpha_{J_m+h-2}^{(m)}, \\tau_m^2) \\\\   \\lambda_{J_m+h}^{(m)} & \\sim \\text{N}(\\lambda_{J_m+h-S_m}^{(m)}, \\omega_m^2) \\\\   \\beta_{J_m+h}^{(m)} & = \\alpha_{J_m+h}^{(m)} + \\lambda_{J_m+h}^{(m)} \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-5","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.6 Random walk with drift, with seasonal effect","what":"Code","title":"2. Mathematical Details","text":"n \\(S_m\\) s \\(A_{\\tau}^{(m)}\\) s_seas \\(A_{\\omega}^{(m)}\\) along used identify “along” “” dimensions","code":"RW2Seas(n, s = 1, s_seas = 1, along = NULL)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-6","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.7 Autoregressive","what":"Model","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\beta_{u,v}^{(m)} \\sim \\text{N}\\left(\\phi_1^{(m)} \\beta_{u,v-1}^{(m)} + \\cdots + \\phi_{K_m}^{(m)} \\beta_{u,v-{K_m}}^{(m)},  \\omega_m^2\\right), \\quad u = 1, \\cdots, U_m, \\quad v = K_m + 1, \\cdots, V_m. \\end{equation}\\] Internally, TMB derives values \\(\\beta_{u,v}^{(m)}, v = 1, \\cdots, K_m\\), \\(\\omega_m\\), imply stationary distribution, give every term \\(\\beta_{u,v}^{(m)}\\) marginal variance. denote marginal variance \\(\\tau_m^2\\), assign prior \\[\\begin{equation}   \\tau_m  \\sim \\text{N}^+(0, A_{\\tau}^{(m)2}). \\end{equation}\\] individual \\(\\phi_k^{(m)}\\) restricted interval \\((-1, 1)\\), \\(\\phi_k^{(m)}\\) jointly restricted values yield stationary models. Let \\[\\begin{equation}   r^{(m)} = \\sqrt{\\phi_1^{(m)2} + \\cdots + \\phi_{K_m}^{(m)2}}. \\end{equation}\\] assign \\(r^{(m)}\\) prior \\[\\begin{equation}   r^{(m)} \\sim \\text{Beta}(2, 2). \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-6","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.7 Autoregressive","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\text{N}^+\\left(\\tau_m \\mid 0, A_{\\tau}^{(m)2} \\right) \\text{Beta}\\left( r^{(m)} \\mid 2, 2 \\right) \\prod_{u=1}^{U_m} p\\left( \\beta_{u,1}^{(m)}, \\cdots, \\beta_{u,V_m}^{(m)} \\mid \\phi_1^{(m)}, \\cdots, \\phi_{K_m}^{(m)}, \\tau_m \\right) \\end{equation}\\] \\(p\\left( \\beta_{u,1}^{(m)}, \\cdots, \\beta_{u,V_m}^{(m)} \\mid \\phi_1^{(m)}, \\cdots, \\phi_{K_m}^{(m)}, \\tau_m \\right)\\) calculated internally TMB.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-6","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.7 Autoregressive","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\beta_{u,V_m + h}^{(m)} \\sim \\text{N}\\left(\\phi_1^{(m)} \\beta_{u,V_m + h - 1}^{(m)} + \\cdots + \\phi_{K_m}^{(m)} \\beta_{u,V_m+h-K_m}^{(m)}, \\tau_m^2\\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-6","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.7 Autoregressive","what":"Code","title":"2. Mathematical Details","text":"n \\(K_m\\) s \\(A_{\\tau}^{(m)}\\) along used indentify “along” “” dimensions","code":"AR(n = 2, s = 1, along = NULL)"},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:pr-ar1","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions","what":"AR1","title":"2. Mathematical Details","text":"Special case AR, extra options autocorrelation coefficient.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-7","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.8 AR1","what":"Model","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\beta_{u,1}^{(m)} & \\sim \\text{N}(0, \\tau_m^2), \\quad u = 1, \\cdots, U_m \\\\   \\beta_{u,v}^{(m)} & \\sim \\text{N}(\\phi_m \\beta_{u,v-1}^{(m)}, (1 - \\phi_m^2) \\tau_m^2), \\quad u = 1, \\cdots, U_m, \\quad v = 2, \\cdots, V_m \\\\   \\phi_m & = a_{0,m} + (a_{1,m} - a_{0,m}) \\phi_m^{\\prime} \\\\   \\phi_m^{\\prime} & \\sim \\text{Beta}(2, 2) \\\\   \\tau_m & \\sim \\text{N}^+\\left(0, A_{\\tau}^{(m)2}\\right). p\\end{align}\\] adapted specification used AR1 densities TMB. implies marginal variance \\(\\beta_{u,v}^{(m)}\\) \\(\\tau_m^2\\). require \\(-1 < a_{0m} < a_{1m} < 1\\).","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-7","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.8 AR1","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\text{Beta}( \\phi_m^{\\prime} \\mid 2, 2) \\prod_{u=1}^{U_m} \\text{N}\\left(\\beta_{u,1}^{(m)} \\mid 0, \\tau_m^2 \\right)  \\prod_{u=1}^{U_m} \\prod_{j=2}^{V_m} \\text{N}\\left(\\beta_{u,v}^{(m)} \\mid \\phi_m \\beta_{u,v-1}^{(m)}, (1 - \\phi_m^2) \\tau_m^2 \\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-7","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.8 AR1","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\beta_{J_m + h}^{(m)} \\sim \\text{N}\\left(\\phi_m \\beta_{J_m + h - 1}^{(m)}, (1 - \\phi_m^2) \\tau_m^2\\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-7","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.8 AR1","what":"Code","title":"2. Mathematical Details","text":"min \\(a_{0m}\\) max \\(a_{1m}\\) s \\(A_{\\tau}^{(m)}\\). Defaults 1. along used identify “along” “” dimensions defaults min max based defaults function ets() R package forecast (Hyndman Khandakar 2008).","code":"AR1(min = 0.8, max = 0.98, s = 1, along = NULL)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-8","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.9 Linear","what":"Model","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\beta_{u,v}^{(m)} & \\sim \\text{N}(\\alpha_u^{(m)} + v \\eta_u^{(m)}, \\tau_m^2), \\quad u = 1,\\cdots,U_m, \\quad v = 1, \\cdots, V_m  \\\\   \\alpha_u^{(m)} & \\sim \\text{N}(0, 1), \\quad u = 1,\\cdots,U_m  \\\\   \\eta_u^{(m)} & \\sim \\text{N}\\left(0, A_{\\eta}^{(m)2}\\right), \\quad u = 1, \\cdots, U_m \\\\   \\tau_m & \\sim \\text{N}^+\\left(0, A_{\\tau}^{(m)2}\\right) \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-8","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.9 Linear","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\prod_{u=1}^{U_m} \\text{N}(\\alpha_u^{(m)} \\mid 0, 1) \\text{N}(\\eta_u^{(m)} \\mid 0, A_{\\eta}^{(m)2}) \\prod_{u=1}^{U_m} \\prod_{v=1}^{V_m} \\text{N}\\left(\\beta_{u,v}^{(m)} | \\alpha_u^{(m)} + v \\eta_u^{(m)}, \\tau_m^2 \\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-8","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.9 Linear","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\beta_{u,V_m + h}^{(m)} \\sim \\text{N}(\\alpha_u^{(m)} + (V_m + h) \\eta_u^{(m)}, \\tau_m^2) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-8","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.9 Linear","what":"Code","title":"2. Mathematical Details","text":"s \\(A_{\\tau}^{(m)}\\) sd \\(A_{\\eta}^{(m)}\\) along used indentify “along” “” dimensions","code":"Lin(s = 1, sd = 1, along = NULL)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-9","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.10 Linear-AR","what":"Model","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\beta_{u,v}^{(m)} & = \\alpha_u^{(m)} + \\eta_u^{(m)} v + \\epsilon_{u,v}^{(m)}, \\quad u = 1, \\cdots, U_m, \\quad v = 1, \\cdots, V_m \\\\   \\alpha_u^{(m)} & \\sim \\text{N}\\left(0, 1\\right), \\quad u = 1, \\cdots, U_m \\\\   \\eta_u^{(m)} & \\sim \\text{N}\\left(0, A_{\\eta}^{(m)2}\\right), \\quad u = 1, \\cdots, U_m \\\\   \\epsilon_{u,v}^{(m)} & \\sim \\text{N}\\left(\\phi_1^{(m)} \\epsilon_{u,v-1}^{(m)} + \\cdots + \\phi_{K_m}^{(m)} \\epsilon_{u,v-{K_m}}^{(m)},  \\omega_m^2\\right), \\quad u = 1, \\cdots, U_m, \\quad v = K_m + 1, \\cdots, V_m. \\end{align}\\] Internally, TMB derives values \\(\\epsilon_{u,v}^{(m)}, v = 1, \\cdots, K_m\\), \\(\\omega_m\\), provide \\(\\epsilon_{u,v}^{(m)}\\) stationary distribution term marginal variance. denote marginal variance \\(\\tau_m^2\\), assign prior \\[\\begin{equation}   \\tau_m  \\sim \\text{N}^+(0, A_{\\tau}^{(m)2}). \\end{equation}\\] individual \\(\\phi_k^{(m)}\\) restricted interval \\((-1, 1)\\), \\(\\phi_k^{(m)}\\) jointly restricted values yield stationary models. Let \\[\\begin{equation}   r^{(m)} = \\sqrt{\\phi_1^{(m)2} + \\cdots + \\phi_{K_m}^{(m)2}}. \\end{equation}\\] assign \\(r^{(m)}\\) prior \\[\\begin{equation}   r^{(m)} \\sim \\text{Beta}(2, 2). \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-9","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.10 Linear-AR","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\text{N}^+\\left(\\tau_m \\mid 0, A_{\\tau}^{(m)2} \\right) \\text{Beta}\\left( r_k^{(m)} \\mid 2, 2 \\right) \\prod_{u=1}^{U_m} \\text{N}(\\alpha_u^{(m)} \\mid 0, 1) \\text{N}(\\eta_u^{(m)} \\mid 0, A_{\\eta}^{(m)2}) p\\left( \\epsilon_{u,1}^{(m)}, \\cdots, \\epsilon_{u,V_m}^{(m)} \\mid \\phi_1^{(m)}, \\cdots, \\phi_{K_m}^{(m)}, \\tau_m \\right) \\end{equation}\\] \\(p\\left( \\epsilon_{u,1}^{(m)}, \\cdots, \\epsilon_{u,V_m}^{(m)} \\mid \\phi_1^{(m)}, \\cdots, \\phi_{K_m}^{(m)}, \\tau_m \\right)\\) calculated internally TMB.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-9","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.10 Linear-AR","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\beta_{u, V_m + h}^{(m)} & = \\alpha_u^{(m)} + \\eta_u^{(m)} (V_m + h) + \\epsilon_{u,V_m+h}^{(m)} \\\\   \\epsilon_{u,V_m+h}^{(m)} & \\sim \\text{N}\\left(\\phi_1^{(m)} \\epsilon_{u,V_m + h - 1}^{(m)} + \\cdots + \\phi_{K_m}^{(m)} \\epsilon_{u,V_m+h-K_m}^{(m)}, \\omega_m^2\\right) \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-9","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.10 Linear-AR","what":"Code","title":"2. Mathematical Details","text":"s \\(A_{\\tau}^{(m)}\\) sd \\(A_{\\eta}^{(m)}\\) along used indentify “along” “” variables","code":"Lin_AR(s = 1, sd = 1, along = NULL)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-10","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.11 P-Spline","what":"Model","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\pmb{\\beta}_u^{(m)} = \\pmb{B}^{(m)} \\pmb{\\alpha}_u^{(m)}, \\quad u = 1, \\cdots, U_m \\end{equation}\\] \\(\\pmb{\\beta}_u^{(m)}\\) subvector \\(\\pmb{\\beta}^{(m)}\\) composed elements \\(u\\)th combination “” variables, \\(\\pmb{B}^{(m)}\\) \\(V_m \\times K_m\\) matrix B-splines, \\(\\pmb{\\alpha}_u^{(m)}\\) second-order random walk prior (Section 4.4). \\(\\pmb{B}^{(m)} = (\\pmb{b}_1^{(m)}(\\pmb{v}), \\cdots, \\pmb{b}_{K_m}^{(m)}(\\pmb{v}))\\), \\(\\pmb{v} = (1, \\cdots, V_m)^{\\top}\\). B-splines centered, \\(\\pmb{1}^{\\top} \\pmb{b}_k^{(m)}(\\pmb{v}) = 0\\), \\(k = 1, \\cdots, K_m\\).","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-10","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.11 P-Spline","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\prod_{u=1}^{U_m} \\prod_{k=1}^2 \\text{N}(\\alpha_{u,k}^{(m)} \\mid 0, 1) \\prod_{u=1}^{U_m}\\prod_{k=3}^{K_m} \\text{N}\\left(\\alpha_{u,k}^{(m)} - 2 \\alpha_{u,k-1}^{(m)} + \\alpha_{u,k-2}^{(m)} \\mid 0, \\tau_m^2 \\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-10","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.11 P-Spline","what":"Forecasting","title":"2. Mathematical Details","text":"Terms P-Spline prior forecasted.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-10","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.11 P-Spline","what":"Code","title":"2. Mathematical Details","text":"n \\(K_m\\). Defaults \\(\\max(0.7 J_m, 4)\\). s \\(A_{\\tau}^{(m)}\\) second-order random walk prior. Defaults 1. along used identify “along” “” variables","code":"Sp(n = NULL, s = 1)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-11","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.12 SVD","what":"Model","title":"2. Mathematical Details","text":"Age sex gender Let \\(\\pmb{\\beta}_u\\) age effect \\(u\\)th combination ‘’ variables. SVD prior, \\[\\begin{equation}   \\pmb{\\beta}_u^{(m)} = \\pmb{F}^{(m)} \\pmb{\\alpha}_u^{(m)} + \\pmb{g}^{(m)}, \\quad u = 1, \\cdots, U_m \\end{equation}\\] \\(\\pmb{F}^{(m)}\\) \\(V_m \\times K_m\\) matrix, \\(\\pmb{g}^{(m)}\\) vector \\(V_m\\) elements, derived singular value decomposition (SVD) external dataset age-specific values sexes/genders combined. construction \\(\\pmb{F}^{(m)}\\) \\(\\pmb{g}^{(m)}\\) described Appendix 10.2. centering scaling used construction allow use simple prior \\[\\begin{equation}   \\alpha_{u,k}^{(m)} \\sim \\text{N}(0, 1), \\quad u = 1, \\cdots, U_m, k = 1, \\cdots, K_m. \\end{equation}\\] Joint model age sex/gender joint model, vector \\(\\pmb{\\beta}_u\\) represents interaction age sex/gender \\(u\\)th combination ‘’ variables. Matrix \\(\\pmb{F}^{(m)}\\) vector \\(\\pmb{g}^{(m)}\\) calculated data separate sexes/genders. model otherwise unchanged. Independent models sex/gender independent model, vector \\(\\pmb{\\beta}_{s,u}\\) represents age effects sex/gender \\(s\\) \\(u\\)th combination ‘’ variables, \\[\\begin{equation}   \\pmb{\\beta}_{s,u}^{(m)} = \\pmb{F}_s^{(m)} \\pmb{\\alpha}_{s,u}^{(m)} + \\pmb{g}_s^{(m)}, \\quad s = 1, \\cdots, S; \\quad u = 1, \\cdots, U_m \\end{equation}\\] Matrix \\(\\pmb{F}_s^{(m)}\\) vector \\(\\pmb{g}_s^{(m)}\\) calculated data separate sexes/genders. prior \\[\\begin{equation}   \\alpha_{s,u,k}^{(m)} \\sim \\text{N}(0, 1), \\quad s = 1, \\cdots, S; \\quad u = 1, \\cdots, U_m; \\quad k = 1, \\cdots, K_m. \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-11","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.12 SVD","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\prod_{u=1}^{U_m}\\prod_{k=1}^{K_m} \\text{N}\\left(\\alpha_{uk}^{(m)} \\mid 0, 1 \\right) \\end{equation}\\] age-joint models, \\[\\begin{equation}   \\prod_{s=1}^S \\prod_{u=1}^{U_m}\\prod_{k=1}^{K_m} \\text{N}\\left(\\alpha_{s,u,k}^{(m)} \\mid 0, 1 \\right) \\end{equation}\\] independent model","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-11","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.12 SVD","what":"Forecasting","title":"2. Mathematical Details","text":"Terms SVD prior forecasted.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-11","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.12 SVD","what":"Code","title":"2. Mathematical Details","text":"- ssvd object containing \\(\\pmb{F}\\) \\(\\pmb{g}\\) - n_comp number components used (defaults ceiling(n/2), n number components ssvd - indep determines whether indepenent joint model used term modelled contains sex gender variable.","code":"SVD(ssvd, n_comp = NULL, indep = TRUE)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-12","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.13 SVD_RW","what":"Model","title":"2. Mathematical Details","text":"SVD_RW() prior identical SVD() prior except coefficients evolve time, following indepenent random walks. instance, combined-sex/gender joint models, \\[\\begin{align}   \\pmb{\\beta}_{u,t}^{(m)} & = \\pmb{F}^{(m)} \\pmb{\\alpha}_{u,t}^{(m)} + \\pmb{g}^{(m)}, \\quad u = 1, \\cdots, U_m; \\quad t = 1, \\cdots, T \\\\   \\alpha_{u,k,1}^{(m)} & \\sim \\text{N}(0, 1), \\quad u = 1, \\cdots, U_m, k = 1, \\cdots, K_m \\\\   \\alpha_{u,k,t}^{(m)} & \\sim \\text{N}(\\alpha_{u,k,t-1}^{(m)}, \\tau_m^2), \\quad u = 1, \\cdots, U_m, k = 1, \\cdots, K_m; t = 2, \\cdots, T \\\\   \\tau_m & \\sim \\text{N}^+\\left(0, A_{\\tau}^{(m)2}\\right) \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-12","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.13 SVD_RW","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"combined-sex/gender joint models, \\[\\begin{equation}   \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\prod_{u=1}^{U_m} \\prod_{k=1}^{K_m} \\text{N}(\\alpha_{u,k,1}^{(m)} \\mid 0, 1)  \\prod_{t=2}^{T} \\text{N}\\left(\\alpha_{u,k,t}^{(m)} \\mid \\alpha_{u,k,t-1}^{(m)}, \\tau_m^2 \\right), \\end{equation}\\] independent model, \\[\\begin{equation}   \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\prod_{u=1}^{U_m} \\prod_{s=1}^{S} \\prod_{k=1}^{K_m} \\text{N}(\\alpha_{u,s,k,1}^{(m)} \\mid 0, 1)  \\prod_{t=2}^{T} \\text{N}\\left(\\alpha_{u,s,k,t}^{(m)} \\mid \\alpha_{u,s,k,t-1}^{(m)}, \\tau_m^2 \\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"simulation-4","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.13 SVD_RW","what":"Simulation","title":"2. Mathematical Details","text":"TODO - write","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-12","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.13 SVD_RW","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\alpha_{u,k,T+h}^{(m)} & \\sim \\text{N}(\\alpha_{u,k,T+h-1}^{(m)}, \\tau_m^2), \\quad u = 1, \\cdots, U_m; \\quad k = 1, \\cdots, K_m \\\\   \\pmb{\\beta}_{u,T+h}^{(m)} & = \\pmb{F}^{(m)} \\pmb{\\alpha}_{u,T+h}^{(m)} + \\pmb{g}^{(m)}, \\quad u = 1, \\cdots, U_m \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-12","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.13 SVD_RW","what":"Code","title":"2. Mathematical Details","text":"- ssvd object containing \\(\\pmb{F}\\) \\(\\pmb{g}\\) - n_comp \\(K_m\\) (defaults ceiling(n/2), n number components ssvd - s \\(A_{\\tau}^{(m)}\\) - indep determines whether indepenent joint model used term modelled contains sex gender variable.","code":"SVD_RW(ssvd, n_comp = NULL, s = 1, indep = TRUE)"},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:pr-svd-rw2","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions","what":"SVD_RW2","title":"2. Mathematical Details","text":"structure SVD_RW(). TODO - write details.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:pr-svd-ar","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions","what":"SVD_AR","title":"2. Mathematical Details","text":"structure SVD_RW(). TODO - write details.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:pr-svd-ar1","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions","what":"SVD_AR1","title":"2. Mathematical Details","text":"structure SVD_RW(). TODO - write details.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-13","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.17 Known","what":"Model","title":"2. Mathematical Details","text":"Elements \\(\\pmb{\\beta}^{(m)}\\) treated known certainty.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-13","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.17 Known","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"Known priors make contribution posterior density.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-13","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.17 Known","what":"Forecasting","title":"2. Mathematical Details","text":"Main effects known prior forecasted.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-13","dir":"Articles","previous_headings":"4 Priors for Intercept, Main Effects, and Interactions > 4.17 Known","what":"Code","title":"2. Mathematical Details","text":"values vector containing \\(\\beta_j^{(m)}\\).","code":"Known(values)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-14","dir":"Articles","previous_headings":"5 Covariates","what":"Model","title":"2. Mathematical Details","text":"columns matrix \\(\\pmb{Z}\\) assumed standardised mean 0 standard deviation 1. \\(\\pmb{Z}\\) contain column intercept. implement two priors coefficient vector \\(\\pmb{\\zeta}\\). first prior designed case \\(P\\), number colums \\(\\pmb{Z}\\), small, \\(\\zeta_p\\) likely distinguishable zero. second prior designed case \\(P\\) large, \\(\\zeta_p\\) likely distinguishable zero.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"standard-prior","dir":"Articles","previous_headings":"5 Covariates > 5.1 Model","what":"Standard prior","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\zeta_p \\mid \\varphi & \\sim \\text{N}(0, \\varphi^2) \\\\   \\varphi & \\sim \\text{N}^+(0, 1) \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"shrinkage-prior","dir":"Articles","previous_headings":"5 Covariates > 5.1 Model","what":"Shrinkage prior","title":"2. Mathematical Details","text":"Regularised horseshoe prior (Piironen Vehtari 2017) \\[\\begin{align}   \\zeta_p \\mid \\vartheta_p, \\varphi & \\sim \\text{N}(0, \\vartheta_p^2 \\varphi^2) \\\\   \\vartheta_p & \\sim \\text{Cauchy}^+(0, 1) \\\\   \\varphi & \\sim \\text{Cauchy}^+(0, A_{\\varphi}^2) \\\\   A_{\\varphi} & = \\frac{p_0}{p_0 + P} \\frac{\\hat{\\sigma}}{\\sqrt{n}} \\end{align}\\] \\(p_0\\) initial guess number \\(\\zeta_p\\) non-zero, \\(\\hat{\\sigma}\\) obtained follows: Poisson. Using maximum likelihood, fit GLM \\[\\begin{align} y_i & \\sim \\text{Poisson}(w_i \\gamma_i) \\\\ \\log \\gamma_i & = \\sum_{m=0}^{M} \\pmb{X}^{(m)} \\pmb{\\beta}^{(m)}, \\end{align}\\] set \\[\\begin{equation} \\hat{\\sigma} = \\frac{1}{n}\\sum_{=1}^n \\frac{1}{w_i \\hat{\\gamma}_i}. \\end{equation}\\] Binomial. Using maximum likelihood, fit GLM \\[\\begin{align} y_i & \\sim \\text{binomial}(w_i, \\gamma_i) \\\\ \\text{logit} \\gamma_i & = \\sum_{m=0}^{M} \\pmb{X}^{(m)} \\pmb{\\beta}^{(m)}, \\end{align}\\] set \\[\\begin{equation} \\hat{\\sigma} = \\frac{1}{n}\\sum_{=1}^n \\frac{1}{w_i \\hat{\\gamma}_i (1 - \\hat{\\gamma}_i)}. \\end{equation}\\] Normal. Using maximum likelihood, fit linear model \\[\\begin{equation} y_i \\sim \\text{N}\\left(\\sum_{m=0}^{M} \\pmb{X}^{(m)} \\pmb{\\beta}^{(m)}, w_i^{-1}\\xi^2 \\right) \\end{equation}\\] set \\(\\hat{\\sigma} = \\hat{\\xi}\\). quantities used Poisson binomial likelihoods derived normal approximations GLMs (Piironen Vehtari 2017; Gelman et al. 2014, sec. 16.2).","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-14","dir":"Articles","previous_headings":"5 Covariates","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"TODO - write","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-14","dir":"Articles","previous_headings":"5 Covariates","what":"Forecasting","title":"2. Mathematical Details","text":"TODO - write","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-14","dir":"Articles","previous_headings":"5 Covariates","what":"Code","title":"2. Mathematical Details","text":"formula one-sided R formula describing covariates used data data frame. value data supplied, formula interpreted context data frame. value data supplied, formula interpreted context data frame used original call mod_pois(), mod_binom(), mod_norm(). n_coef effective number non-zero coefficients. value supplied, shrinkage prior used; otherwise standard prior used. Examples:","code":"set_covariates(formula, data = NULL, n_coef = NULL) set_covariates(~ mean_income + distance * employment) set_covariates(~ ., data = cov_data, n_coef = 5)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-15","dir":"Articles","previous_headings":"6 Prior for dispersion terms","what":"Model","title":"2. Mathematical Details","text":"Use exponential distribution, parameterised using mean, \\[\\begin{equation}   \\xi \\sim \\text{Exp}(\\mu_{\\xi}) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-prior-density","dir":"Articles","previous_headings":"6 Prior for dispersion terms","what":"Contribution to prior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   p(\\xi) = \\frac{1}{\\mu_{\\xi}} \\exp\\left(\\frac{-\\xi}{\\mu_{\\xi}}\\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-15","dir":"Articles","previous_headings":"6 Prior for dispersion terms","what":"Code","title":"2. Mathematical Details","text":"mean \\(\\mu_{\\xi}\\)","code":"set_disp(mean = 1)"},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"deriving-outputs","dir":"Articles","previous_headings":"","what":"Deriving outputs","title":"2. Mathematical Details","text":"Running TMB yields set means \\(\\pmb{m}\\), precision matrix \\(\\pmb{Q}^{-1}\\), together define approximate joint posterior distribution \\(\\pmb{\\beta}^{(m)}\\) terms independent normal, fixed normal, multivariate normal, random walk, second-order random walk, AR1, Linear, Linear-AR1 priors, \\(\\pmb{\\alpha}\\) terms Spline SVD priors, hyper-parameters \\(\\pmb{\\beta}^{(m)}\\) \\(\\pmb{\\alpha}^{(m)}\\) typically transformed another scale, log scale, dispersion term \\(\\xi\\), seasonal effects \\(\\pmb{\\lambda}\\), together associated hyper-parameters \\(\\tau_{\\lambda}\\) (log scale). use \\(\\tilde{\\pmb{\\theta}}\\) denote vector containing quantities. perform Cholesky decomposition \\(\\pmb{Q}^{-1}\\), obtain \\(\\pmb{R}\\) \\[\\begin{equation}   \\pmb{R}^{\\top} \\pmb{R} = \\pmb{Q}^{-1} \\end{equation}\\] store \\(\\pmb{R}\\) part model object. draw generate values \\(\\tilde{\\pmb{\\theta}}\\) generating vector standard normal variates \\(\\pmb{z}\\), back-solving equation \\[\\begin{equation}   \\pmb{R} \\pmb{v} = \\pmb{z} \\end{equation}\\] setting \\[\\begin{equation}   \\tilde{\\pmb{\\theta}} = \\pmb{v} + \\pmb{m}. \\end{equation}\\] Next convert transformed hyper-parameters back original units, insert values \\(\\pmb{\\beta}^{(m)}\\) terms Known priors. denote resulting vector \\(\\pmb{\\theta}\\). Finally draw distribution \\(\\pmb{\\gamma} \\mid \\pmb{y}, \\pmb{\\theta}\\) using methods described Section 2.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:standard","dir":"Articles","previous_headings":"7 Deriving outputs","what":"Standardization","title":"2. Mathematical Details","text":"NOTE - ignoring covariates moment. can probably just subtract covariates term \\(\\pmb{\\mu}\\) proceed . Although sum \\(\\pmb{\\mu} = \\sum_{m=0}^{M} \\pmb{X}^{(m)} \\pmb{\\beta}^{(m)}\\) well identified data, individual \\(\\pmb{\\beta}^{(m)}\\) . reporting estimated \\(\\pmb{\\beta}^{(m)}\\), standardize. standarization algorithm follows. Set \\[\\begin{equation}   \\pmb{r}^{(0)} = \\pmb{\\mu} \\end{equation}\\] \\(m = 0, \\cdots, M\\): Set \\(\\tilde{\\pmb{\\beta}}^{(m)} = (\\pmb{X}^{(m)\\top} \\pmb{X}^{(m)})^{-1} \\pmb{X}^{(m)\\top} \\pmb{r}^{(m)}\\) Set \\(\\pmb{r}^{(m+1)} = \\pmb{r}^{(m)} - \\pmb{X}^{(m)} \\tilde{\\pmb{\\beta}}^{(m)}\\) TODO - describe derivaition components within LinAR, RWSeas, RW2Seas.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"simulation-5","dir":"Articles","previous_headings":"","what":"Simulation","title":"2. Mathematical Details","text":"generate one set simulated values, start values exposure, trials, weights, \\(\\pmb{w}\\), possibly covariates $, go following steps: Draw values parameters priors \\(\\pmb{\\beta}^{(m)}\\), \\(m = 1, \\cdots, M\\). Conditional values drawn Step 1, draw values \\(\\pmb{\\beta}^{(m)}\\), \\(m = 0, \\cdots, M\\). model contains seasonal effects, draw standard deviation \\(\\kappa_m\\), effects \\(\\pmb{\\lambda}^{(m)}\\). model contains covariates, draw \\(\\varphi\\) \\(\\vartheta_p\\) necessary, draw coefficient vector \\(\\pmb{\\zeta}\\). Use values steps 2–4 form linear predictor \\(\\sum_{m=0}^{M} \\pmb{X}^{(m)} (\\pmb{\\beta}^{(m)} + \\pmb{\\lambda}^{(m)}) + \\pmb{Z} \\pmb{\\zeta}\\). Back-transform linear predictor, obtain vector cell-specific parameters \\(\\pmb{\\mu}\\). model contains dispersion parameter \\(\\xi\\), draw values prior \\(\\xi\\). Poisson binomial models, use \\(\\pmb{\\mu}\\) , present, \\(\\xi\\) draw \\(\\pmb{\\gamma}\\). Poisson binomial models, use \\(\\pmb{\\gamma}\\) \\(\\pmb{w}\\) draw \\(\\pmb{y}\\); normal models, use \\(\\pmb{\\mu}\\), \\(\\xi\\), \\(\\pmb{w}\\) draw \\(\\pmb{y}\\).","code":""},{"path":[]},{"path":[]},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"condition-on-pmbgamma","dir":"Articles","previous_headings":"9 Replicate data > 9.1 Model > 9.1.1 Poisson likelihood","what":"Condition on \\(\\pmb{\\gamma}\\)","title":"2. Mathematical Details","text":"\\[\\begin{equation}   y_i^{\\text{rep}} \\sim \\text{Poisson}(\\gamma_i w_i) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"condition-on-pmbmu-xi","dir":"Articles","previous_headings":"9 Replicate data > 9.1 Model > 9.1.1 Poisson likelihood","what":"Condition on \\((\\pmb{\\mu}, \\xi)\\)","title":"2. Mathematical Details","text":"\\[\\begin{align}   y_i^{\\text{rep}} & \\sim \\text{Poisson}(\\gamma_i^{\\text{rep}} w_i) \\\\   \\gamma_i^{\\text{rep}} & \\sim \\text{Gamma}(\\xi^{-1}, (\\xi \\mu_i)^{-1}) \\end{align}\\] equivalent \\[\\begin{equation}   y_i^{\\text{rep}} \\sim \\text{NegBinom}\\left(\\xi^{-1}, (1 + \\mu_i w_i \\xi)^{-1}\\right) \\end{equation}\\]","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"condition-on-pmbgamma-1","dir":"Articles","previous_headings":"9 Replicate data > 9.1 Model > 9.1.2 Binomial likelihood","what":"Condition on \\(\\pmb{\\gamma}\\)","title":"2. Mathematical Details","text":"\\[\\begin{equation}   y_i^{\\text{rep}} \\sim \\text{Binomial}(w_i, \\gamma_i) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"condition-on-pmbmu-xi-1","dir":"Articles","previous_headings":"9 Replicate data > 9.1 Model > 9.1.2 Binomial likelihood","what":"Condition on \\((\\pmb{\\mu}, \\xi)\\)","title":"2. Mathematical Details","text":"\\[\\begin{align}   y_i^{\\text{rep}} & \\sim \\text{Binomial}(w_im \\gamma_i^{\\text{rep}}) \\\\   \\gamma_i^{\\text{rep}} & \\sim \\text{Beta}\\left(\\xi^{-1} \\mu_i, \\xi^{-1}(1 - \\mu_i)\\right) \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"normal-likelihood","dir":"Articles","previous_headings":"9 Replicate data > 9.1 Model","what":"Normal likelihood","title":"2. Mathematical Details","text":"\\[\\begin{equation}   y_i^{\\text{rep}} \\sim \\text{N}(\\gamma_i, \\xi^2 / w_i) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-16","dir":"Articles","previous_headings":"9 Replicate data","what":"Code","title":"2. Mathematical Details","text":"","code":"replicate_data(x, condition_on = c(\"fitted\", \"expected\"), n = 20)"},{"path":[]},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"app:svd","dir":"Articles","previous_headings":"10 Appendices","what":"SVD prior for age","title":"2. Mathematical Details","text":"Let \\(\\pmb{}\\) matrix age-specific estimates international database, transformed take values range \\((-\\infty, \\infty)\\). column \\(\\pmb{}\\) represesents one set age-specific estimates, log mortality rates Japan 2010, logit labour participation rates Germany 1980. Let \\(\\pmb{U}\\), \\(\\pmb{D}\\), \\(\\pmb{V}\\) matrices singular value decomposition \\(\\pmb{}\\), retained first \\(K\\) components. \\[\\begin{equation}   \\pmb{} \\approx \\pmb{U} \\pmb{D} \\pmb{V}. \\tag{10.1} \\end{equation}\\] Let \\(m_k\\) \\(s_k\\) mean sample standard deviation elements \\(k\\)th row \\(\\pmb{V}\\), \\(\\pmb{m} = (m_1, \\cdots, m_k)^{\\top}\\) \\(\\pmb{s} = (s_1, \\cdots, s_k)^{\\top}\\). \\[\\begin{equation}   \\tilde{\\pmb{V}} = (\\text{diag}(\\pmb{s}))^{-1} (\\pmb{V} - \\pmb{m} \\pmb{1}^{\\top}) \\end{equation}\\] standardized version \\(\\pmb{V}\\). can rewrite (10.1) \\[\\begin{align}   \\pmb{} & \\approx \\pmb{U} \\pmb{D} (\\text{diag}(\\pmb{s}) \\tilde{\\pmb{V}} + \\pmb{m} \\pmb{1}^{\\top}) \\\\   & = \\pmb{F} \\tilde{\\pmb{V}} + \\pmb{g} \\pmb{1}^{\\top}, \\tag{10.2} \\end{align}\\] \\(\\pmb{F} = \\pmb{U} \\pmb{D} \\text{diag}(\\pmb{s})\\) \\(\\pmb{g} = \\pmb{U} \\pmb{D} \\pmb{m}\\). Let \\(\\tilde{\\pmb{v}}_l\\) randomly-selected column \\(\\tilde{\\pmb{V}}\\). construction \\(\\tilde{\\pmb{V}}\\), orthogonality rows \\(\\pmb{V}\\), \\(\\text{E}[\\tilde{\\pmb{v}}_l] = \\pmb{0}\\) \\(\\text{var}[\\tilde{\\pmb{v}}_l] = \\pmb{}\\). implies \\(\\pmb{z}\\) vector standard normal variables, \\[\\begin{equation}   \\pmb{F} \\pmb{z} + \\pmb{g} \\end{equation}\\] look approximately like randomly-selected column original data matrix \\(\\pmb{}\\).","code":""},{"path":[]},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig4_svd.html","id":"data","dir":"Articles","previous_headings":"Derivation of standardised principal components","what":"Data","title":"4. Singular Value Decomposition","text":"Let 𝐘\\pmb{Y} ×LA \\times L matrix values, =1,⋯,Aa=1,\\cdots,indexes age group l=1,⋯,Ll=1,\\cdots,L indexes combination classifying variables, country crossed time. values real numbers, including negative numbers, log-transformed rates, logit-transformed probabilities.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig4_svd.html","id":"singular-value-decomposition","dir":"Articles","previous_headings":"Derivation of standardised principal components","what":"Singular value decomposition","title":"4. Singular Value Decomposition","text":"perform singular value decomposition 𝐘\\pmb{Y}, retain first C<AC < components, obtain 𝐘≈𝐔𝐃𝐕⊤\\begin{equation}   \\pmb{Y} \\approx \\pmb{U} \\pmb{D} \\pmb{V}^\\top \\end{equation} 𝐔\\pmb{U} ×CA \\times C matrix whose columns left singular vectors. 𝐃\\pmb{D} C×CC \\times C diagonal matrix holding singular values. 𝐕\\pmb{V} L×CL \\times C matrix whose columns right singular vectors.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig4_svd.html","id":"standardising","dir":"Articles","previous_headings":"Derivation of standardised principal components","what":"Standardising","title":"4. Singular Value Decomposition","text":"Let 𝐦V\\pmb{m}_V vector, ccth element mean ccth singular vector, ∑l=1Lvlc/L\\sum_{l=1}^L v_{lc} / L. Similarly, let 𝐬V\\pmb{s}_V vector, ccth element standard deviation ccth singular vector, ∑l=1L(vlc−mc)2/(L−1)\\sqrt{\\sum_{l=1}^L (v_{lc} - m_c)^2 / (L-1)}. define 𝐌V=𝟏𝐦V⊤𝐒V=diag(𝐬V),\\begin{align}   \\pmb{M}_V & = \\pmb{1} \\pmb{m}_V^\\top  \\\\   \\pmb{S}_V & = \\text{diag}(\\pmb{s}_V), \\end{align} 𝟏\\pmb{1} L-vector ones. Let 𝐕̃\\tilde{\\pmb{V}} standardized version 𝐕\\pmb{V}, 𝐕̃=(𝐕−𝐌V)𝐒V−1.\\begin{equation}   \\tilde{\\pmb{V}} = (\\pmb{V} - \\pmb{M}_V) \\pmb{S}_V^{-1}. \\end{equation} can now express 𝐘\\pmb{Y} 𝐘≈𝐔𝐃(𝐕̃𝐒V+𝐌V)⊤=𝐔𝐃𝐒V𝐕̃⊤+𝐔𝐃𝐌V⊤=𝐀𝐕̃⊤+𝐁.\\begin{align}   \\pmb{Y} & \\approx \\pmb{U} \\pmb{D} (\\tilde{\\pmb{V}} \\pmb{S}_V + \\pmb{M}_V)^\\top \\\\   & = \\pmb{U} \\pmb{D} \\pmb{S}_V \\tilde{\\pmb{V}}^\\top + \\pmb{U} \\pmb{D}\\pmb{M}_V ^\\top \\\\   & = \\pmb{}\\tilde{\\pmb{V}}^\\top + \\pmb{B}. \\end{align} Furthermore, can express matrix 𝐁\\pmb{B} $$\\begin{align}   \\pmb{B} & = \\pmb{U} \\pmb{D}\\pmb{M}_V ^\\top \\\\   & = \\pmb{U} \\pmb{D} \\pmb{m}_V \\pmb{1}^\\top$ \\\\   & = \\pmb{b} \\pmb{1}^\\top. \\end{align}$$","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig4_svd.html","id":"result","dir":"Articles","previous_headings":"Derivation of standardised principal components","what":"Result","title":"4. Singular Value Decomposition","text":"Consider randomly selected row 𝐯̃l\\tilde{\\pmb{v}}_l 𝐕̃\\tilde{\\pmb{V}}. construction 𝐕̃\\tilde{\\pmb{V}}, orthogonality columns 𝐕\\pmb{V}$\\color{cyan}{\\text{TODO-spell bit }}$, obtain E[𝐯̃l]=𝟎\\begin{equation}   \\text{E}[\\tilde{\\pmb{v}}_l] = \\pmb{0} \\end{equation} Var[𝐯̃l]=𝐈.\\begin{equation}   \\text{Var}[\\tilde{\\pmb{v}}_l] = \\pmb{}. \\end{equation} implies set 𝐲′=𝐀𝐳+𝐛\\begin{equation}   \\pmb{y}' = \\pmb{} \\pmb{z} + \\pmb{b} \\end{equation} 𝐳∼N(𝟎,𝐈),\\begin{equation}   \\pmb{z} \\sim \\text{N}(\\pmb{0}, \\pmb{}), \\end{equation} 𝐲′\\pmb{y}' look like randomly-chosen column 𝐘\\pmb{Y}. $\\color{cyan}{\\text{TODO - illustrate examples}}$","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig5_workflow.html","id":"prior-predictive-checking","dir":"Articles","previous_headings":"","what":"Prior predictive checking","title":"5. Bayesian Workflow","text":"Given model, priors, typically exposure/size term, generate data parts data generating model need stronger priors standard estimation model - eg can’t put weakly informative prior intercept “common Bayesian analysis use models fully generative. example, regression typically model outcome y given predictors x without generative model x.” (Gelman et al 2020: 11-12) [actually model ever fully generative - always assumptions part ] generating data given model priors step 1 simulation study - can re-use functions prior predictive checking simulation studies","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig5_workflow.html","id":"fitting-a-model","dir":"Articles","previous_headings":"","what":"Fitting a model","title":"5. Bayesian Workflow","text":"“generic diagnostic tools described Yao et al. (2018a) Talts et al. (2020) can used verify particular approximate algorithm reproduces features posterior care specific model.”Yao, Y., Vehtari, ., Simpson, D., Gelman, . (2018a). Yes, work?: Evaluating variational inference. Proceedings International Conference Machine Learning, 5581– 5590. Talts, S., Betancourt, M., Simpson, D., Vehtari, ., Gelman, . (2020). Validating Bayesian inference algorithms simulation-based calibration. www.stat.columbia.edu/~gelman/ research/unpublished/sbc.pdf [looks like something might implement] “Laplace approximation can viewed data-dependent linearization desired model” (Gelman et al 2020: 15) “Fit fast, fail fast” [can !]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig5_workflow.html","id":"using-constructed-data-to-find-and-understand-problems","dir":"Articles","previous_headings":"","what":"Using constructed data to find and understand problems","title":"5. Bayesian Workflow","text":"“implies fake data simulation can particularly relevant zone parameter space predictive data. turn suggests two-step procedure first fit model real data, draw parameters resulting posterior distribution use fake-data checking. statistical properties procedure unclear practice found checks helpful, revealing problems computation model, providing reassurance fake-data-based inferences reproduce assumed parameter value.” (Gelman et al 2020: 17)","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig5_workflow.html","id":"addressing-computational-problems","dir":"Articles","previous_headings":"","what":"Addressing computational problems","title":"5. Bayesian Workflow","text":"“Starting simple complex models meeting middle” (Gelman et al 2020: 22-23) - Easy bage - eg number terms, complexity priors","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig5_workflow.html","id":"evaluating-and-using-a-fitted-model","dir":"Articles","previous_headings":"","what":"Evaluating and using a fitted model","title":"5. Bayesian Workflow","text":"bayesplot package tools posterior predictive checking [need generate outputs can fed plots]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig5_workflow.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"5. Bayesian Workflow","text":"@article{gelman2020bayesian, title={Bayesian workflow}, author={Gelman, Andrew Vehtari, Aki Simpson, Daniel Margossian, Charles C Carpenter, Bob Yao, Yuling Kennedy, Lauren Gabry, Jonah B{\"u}rkner, Paul-Christian Modr{'}k, Martin}, journal={arXiv preprint arXiv:2011.01808}, year={2020} } @article{van2021bayesian, title={Bayesian statistics modelling}, author={van de Schoot, Rens Depaoli, Sarah King, Ruth Kramer, Bianca M{\"}rtens, Kaspar Tadesse, Mahlet G Vannucci, Marina Gelman, Andrew Veen, Duco Willemsen, Joukje others}, journal={Nature Reviews Methods Primers}, volume={1}, number={1}, pages={1}, year={2021}, publisher={Nature Publishing Group UK London} } https://betanalpha.github.io/assets/case_studies/principled_bayesian_workflow.html","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"6. Modelling Mortality","text":"vignette, estimate mortality rates, summary indicators life expectancy. work data Iceland. try several methods representing age patterns, including one uses typically patterns Human Mortality Database. model-based estimates come measures uncertainty. addition bage , need package poputils, contains functions calculating life expectancy, rvec, contains data structures functions working random draws. use standard tidyverse tools data manipulation graphing.","code":"library(bage) library(poputils) library(rvec) #>  #> Attaching package: 'rvec' #> The following objects are masked from 'package:stats': #>  #>     sd, var #> The following object is masked from 'package:base': #>  #>     rank library(dplyr, warn.conflicts = FALSE) library(tidyr) library(ggplot2)"},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"the-data","dir":"Articles","previous_headings":"","what":"The data","title":"6. Modelling Mortality","text":"Iceland deaths data included bage package. contains counts deaths, estimates mid-year population, disaggregated age sex, years 1998–2022. oldest age group 105 years older. data sparse. Twenty-two percent death counts 0, half 3 less. plot ‘direct’ estimates death rates first least years data. Direct estimates calculated dividing number deaths corresponding population risk, independently combination age, sex, time. results shown , log scale. dots bottom graph represent log-rates negative infinity, occur cells deaths observed. Random variation obscures patterns age 50. age 50, rates increase less linearly.","code":"dth <- bage::deaths dth #> # A tibble: 5,300 × 5 #>    age   sex     time deaths  popn #>    <fct> <fct>  <int>  <int> <dbl> #>  1 0     Female  1998      7 2051  #>  2 1     Female  1998      1 2082. #>  3 2     Female  1998      1 2088  #>  4 3     Female  1998      3 2112. #>  5 4     Female  1998      1 2204  #>  6 5     Female  1998      0 2232. #>  7 6     Female  1998      1 2175  #>  8 7     Female  1998      0 2240  #>  9 8     Female  1998      0 2261  #> 10 9     Female  1998      0 2182. #> # ℹ 5,290 more rows tail(dth, n = 3) #> # A tibble: 3 × 5 #>   age   sex    time deaths  popn #>   <fct> <fct> <int>  <int> <dbl> #> 1 103   Male   2022      0   1.5 #> 2 104   Male   2022      1   1   #> 3 105+  Male   2022      0   0 dth |>   count(deaths) |>   mutate(percent = round(100 * n / sum(n)),          cumulative_percent = cumsum(percent)) |>   head() #> # A tibble: 6 × 4 #>   deaths     n percent cumulative_percent #>    <int> <int>   <dbl>              <dbl> #> 1      0  1180      22                 22 #> 2      1   701      13                 35 #> 3      2   424       8                 43 #> 4      3   333       6                 49 #> 5      4   239       5                 54 #> 6      5   194       4                 58 dth |>   filter(time %in% c(1998, 2010, 2022)) |>   mutate(rate = deaths / popn) |>   ggplot(aes(x = age_mid(age), y = rate)) + ## 'age_mid()' returns the mid point   facet_grid(vars(sex), vars(time)) +       ## of the age group, which is useful   geom_point(alpha = 0.5) +                 ## for plotting   scale_y_log10() +   ggtitle(\"Direct estimates of mortality rates\") #> Warning in scale_y_log10(): log-10 transformation introduced #> infinite values. #> Warning: Removed 6 rows containing missing values or values outside the scale range #> (`geom_point()`)."},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"specifying-the-model","dir":"Articles","previous_headings":"Initial model","what":"Specifying the model","title":"6. Modelling Mortality","text":"fit initial simple model. prior model, allow interaction age sex, allow interactions involving time. assume, words, mortality rates rise fall rate across age-sex groups. assumption unlikely met exactly practice, revisit later. accept default priors main effects interactions. can seen bottom printout, mod_pois() guessed variables represent age, sex, time. (bases guesses variable names.) Age time main effects, default, get “random walk” priors, terms get “normal” priors. running model annoying, common, problem data . turns 5 cases non-zero deaths zero population. edit data directly, removing modify cases. However, dealing cases modelling decision, like include model . make use fact exposure can specified via formula modify cases deaths population. model model ","code":"dth |>   filter(deaths > 0 & popn == 0) #> # A tibble: 5 × 5 #>   age   sex     time deaths  popn #>   <fct> <fct>  <int>  <int> <dbl> #> 1 104   Male    2001      1     0 #> 2 104   Male    2007      1     0 #> 3 104   Male    2012      1     0 #> 4 104   Female  2019      2     0 #> 5 105+  Male    2020      1     0 mod_base <- mod_pois(deaths ~ age * sex + time,                  data = dth,                  exposure = ~ ifelse(deaths > 0 & popn == 0, 0.5, popn)) mod_base #> -- Unfitted Poisson model -- #>  #>      deaths ~ age * sex + time #>  #> (Intercept) ~ NFix() #>         age ~ RW() #>         sex ~ NFix() #>        time ~ RW() #>     age:sex ~ RW() #>  #>      dispersion: mean=1 #>        exposure: ~ifelse(deaths > 0 & popn == 0, 0.5, popn) #>         var_age: age #>   var_sexgender: sex #>        var_time: time #>          n_draw: 1000"},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"mathematical-description-of-the-model","dir":"Articles","previous_headings":"Initial model","what":"Mathematical description of the model","title":"6. Modelling Mortality","text":"model implemented mod_base assumes yi∼Poisson(γiwi)\\begin{equation}   y_i \\sim \\text{Poisson}(\\gamma_i w_i) \\end{equation} yiy_i deaths age-sex-time cell ii, wiw_i population risk, γi\\gamma_i underlying death rate. modelling deaths draws Poisson distribution, model recognizes contribution individual-level randomness observed death counts. Recognizing individual-level randomness important analyzing data cell counts small. Death rates γi\\gamma_i treated draws Gamma distribution, γi∼Gamma(ξ−1,(ξμi)−1).\\begin{equation}   \\gamma_i \\sim \\text{Gamma}(\\xi^{-1}, (\\xi \\mu_i)^{-1}). \\end{equation} expected value γi\\gamma_i μi\\mu_i, variance ξμi2\\xi \\mu_i^2. modelling γi\\gamma_i draw distribution, recognizing model able explain variation γi\\gamma_i. Larger values ξ\\xi imply unexplained variation. model μi\\mu_i, log scale, sum factors formed dimensions data, logμi=∑m=04βjim(m)\\begin{equation}   \\log \\mu_i = \\sum_{m=0}^4 \\beta_{j_i^m}^{(m)}  \\end{equation} 𝛃(0)\\pmb{\\beta}^{(0)} intercept, 𝛃(m)\\pmb{\\beta}^{(m)}, m=1,⋯,4m = 1, \\cdots, 4, main effect interaction, jimj_i^m element 𝛃(m)\\pmb{\\beta}^{(m)} associated cell ii. β(m)\\beta^{(m)} model μi\\mu_i receives prior. default prior intercept β(0)∼N(0,102)\\begin{equation}   \\beta^{(0)} \\sim \\text{N}(0, 10^2) \\end{equation} prior allows much broader range values expect see practice. rarely expect see values γi\\gamma_i lower 0.001 (-7 log scale) higher 1 (0). default prior age first-order random walk, βj(1)∼N(βj−1(1),τ12),j=2,…,J1\\begin{equation}   \\beta_j^{(1)} \\sim \\text{N}(\\beta_{j-1}^{(1)}, \\tau_1^2), \\quad j = 2, \\dots, J_1 \\end{equation} random walk prior embodies idea expect changes one age group next relatively small, neighbouring age groups strongly correlated distant age groups. value standard deviation parameter τ1\\tau_1 estimated part model, prior, τ12∼N+(0,1)\\begin{equation}     \\tau_1^2 \\sim \\text{N}^+(0, 1) \\end{equation}N+(0,1)\\text{N}^+(0, 1) denotes half-normal distribution, , normal distribution restricted non-negative values. prior properly identified, need place constraint overall level. use soft constraint mean, 1J1∑j=1J1βj(1)∼N(0,1)\\begin{equation}   \\frac{1}{J_1}\\sum_{j=1}^{J_1} \\beta_j^{(1)} \\sim \\text{N}(0, 1) \\end{equation} sex main effect prior βj(2)∼N(0,τ22),j=1,2τ22∼N+(0,1)\\begin{align}   \\beta_j^{(2)} & \\sim \\text{N}(0, \\tau_2^2), \\quad j = 1, 2 \\\\   \\tau_2^2 & \\sim \\text{N}^+(0, 1) \\end{align} time term β(3)\\beta^{(3)} random-walk prior age effect. age-sex interaction β(4)\\beta^{(4)} prior sex effect. Finally, dispersion term ξ\\xi penalized-complexity prior [@simpson2022priors], p(ξ)=12ξe−ξ.\\begin{equation}     p(\\xi) = \\frac{1}{2 \\sqrt{\\xi}}e^{-\\sqrt{\\xi}}. \\end{equation}","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"fitting-the-model","dir":"Articles","previous_headings":"Initial model","what":"Fitting the model","title":"6. Modelling Mortality","text":"fit model calling function fit():","code":"mod_base <- fit(mod_base) mod_base #> -- Fitted Poisson model -- #>  #>      deaths ~ age * sex + time #>  #> (Intercept) ~ NFix() #>         age ~ RW() #>         sex ~ NFix() #>        time ~ RW() #>     age:sex ~ RW() #>  #>      dispersion: mean=1 #>        exposure: ~ifelse(deaths > 0 & popn == 0, 0.5, popn) #>         var_age: age #>   var_sexgender: sex #>        var_time: time #>          n_draw: 1000"},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"extracting-rates","dir":"Articles","previous_headings":"Initial model","what":"Extracting rates","title":"6. Modelling Mortality","text":"extract estimated rates fitted model object, use function augment(). Function augment() starts original data, adds column called .observed containing direct estimates (yi/wiy_i/w_i), column called .fitted containing estimates rates (γi\\gamma_i), column called .expected containing expected values rates (μi\\mu_i). .fitted .expected columns consist rvecs. rvec vector-like object holds multiple draws, case draws posterior distributions. Next extract rates estimates selected years, summarize posterior distributions. plot point estimates 95% credible intervals modelled estimates, together original direct estimates,","code":"aug_base <- augment(mod_base) aug_base #> # A tibble: 5,300 × 8 #>    age   sex     time deaths  popn .observed                    .fitted #>    <fct> <fct>  <int>  <int> <dbl>     <dbl>               <rdbl<1000>> #>  1 0     Female  1998      7 2051   0.00341     0.0021 (0.0016, 0.0025) #>  2 1     Female  1998      1 2082.  0.000480   5e-04 (0.00037, 0.00065) #>  3 2     Female  1998      1 2088   0.000479 0.00026 (0.00019, 0.00036) #>  4 3     Female  1998      3 2112.  0.00142  0.00016 (0.00011, 0.00024) #>  5 4     Female  1998      1 2204   0.000454 0.00012 (8.1e-05, 0.00018) #>  6 5     Female  1998      0 2232.  0        0.00011 (7.3e-05, 0.00016) #>  7 6     Female  1998      1 2175   0.000460 9.6e-05 (6.2e-05, 0.00014) #>  8 7     Female  1998      0 2240   0        7.6e-05 (4.8e-05, 0.00012) #>  9 8     Female  1998      0 2261   0        7.8e-05 (5.1e-05, 0.00012) #> 10 9     Female  1998      0 2182.  0        8.1e-05 (5.5e-05, 0.00012) #> # ℹ 5,290 more rows #> # ℹ 1 more variable: .expected <rdbl<1000>> rates_base <- aug_base |>   filter(time %in% c(1998, 2010, 2022)) |>   select(age, sex, time, .observed, .fitted) |>   mutate(draws_ci(.fitted)) rates_base #> # A tibble: 636 × 8 #>    age   sex     time .observed                    .fitted .fitted.lower #>    <fct> <fct>  <int>     <dbl>               <rdbl<1000>>         <dbl> #>  1 0     Female  1998  0.00341     0.0021 (0.0016, 0.0025)     0.00165   #>  2 1     Female  1998  0.000480   5e-04 (0.00037, 0.00065)     0.000374  #>  3 2     Female  1998  0.000479 0.00026 (0.00019, 0.00036)     0.000189  #>  4 3     Female  1998  0.00142  0.00016 (0.00011, 0.00024)     0.000111  #>  5 4     Female  1998  0.000454 0.00012 (8.1e-05, 0.00018)     0.0000805 #>  6 5     Female  1998  0        0.00011 (7.3e-05, 0.00016)     0.0000733 #>  7 6     Female  1998  0.000460 9.6e-05 (6.2e-05, 0.00014)     0.0000618 #>  8 7     Female  1998  0        7.6e-05 (4.8e-05, 0.00012)     0.0000484 #>  9 8     Female  1998  0        7.8e-05 (5.1e-05, 0.00012)     0.0000512 #> 10 9     Female  1998  0        8.1e-05 (5.5e-05, 0.00012)     0.0000553 #> # ℹ 626 more rows #> # ℹ 2 more variables: .fitted.mid <dbl>, .fitted.upper <dbl> ggplot(rates_base, aes(x = age_mid(age),               ymin = .fitted.lower,              y = .fitted.mid,              ymax = .fitted.upper)) +   facet_grid(vars(sex), vars(time)) +   geom_ribbon(fill = \"lightblue\") +   geom_line(col= \"darkblue\") +   geom_point(aes(y = .observed),              size = 0.2) +   scale_y_log10() +   ggtitle(\"Modelled and direct estimates of mortality rates - base model\") #> Warning in scale_y_log10(): log-10 transformation introduced #> infinite values. #> Warning: Removed 6 rows containing missing values or values outside the scale range #> (`geom_point()`)."},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"extracting-higher-level-terms","dir":"Articles","previous_headings":"Initial model","what":"Extracting higher-level terms","title":"6. Modelling Mortality","text":"can gain insights model extracting graphing estimates main effects interactions, 𝛃(m)\\pmb{\\beta}^{(m)}. Estimates main effects interactions, higher-level parameters, can obtained function components(). components() returns tibble contain estimates higher-level parameters. extract age effect, prepare graphing, use graph age effect reveals typical profile mortality rates,","code":"comp_base <- components(mod_base) comp_base #> # A tibble: 350 × 4 #>    term        component level                 .fitted #>    <chr>       <chr>     <chr>            <rdbl<1000>> #>  1 (Intercept) effect    (Intercept) -5.4 (-5.5, -5.4) #>  2 age         effect    0           -0.86 (-1, -0.72) #>  3 age         effect    1             -2.3 (-2.5, -2) #>  4 age         effect    2           -2.9 (-3.2, -2.7) #>  5 age         effect    3           -3.4 (-3.7, -3.1) #>  6 age         effect    4             -3.7 (-4, -3.3) #>  7 age         effect    5           -3.7 (-4.1, -3.4) #>  8 age         effect    6           -3.9 (-4.2, -3.5) #>  9 age         effect    7           -4.1 (-4.5, -3.7) #> 10 age         effect    8             -4 (-4.4, -3.7) #> # ℹ 340 more rows age_effect <- comp_base |>   filter(component == \"effect\",          term == \"age\") |>   mutate(draws_ci(.fitted)) ggplot(age_effect,        aes(x = age_mid(level),            y = .fitted.mid,            ymin = .fitted.lower,            ymax = .fitted.upper)) +   geom_ribbon(fill = \"lightblue\") +   geom_line() +   ggtitle(\"Age effect\")"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"mathematical-structure","dir":"Articles","previous_headings":"Revised model","what":"Mathematical structure","title":"6. Modelling Mortality","text":"Human Mortality Database provides estimates mortality rates many countries. Let 𝐌\\pmb{M} denote matrix holding estimates, log scale. applying Singlar Value Decomposition 𝐌\\pmb{M}, rescaling, can construct matrix 𝐅\\pmb{F} column vector 𝐠\\pmb{g}, parsimoniously summarize age-profiles, age-sex profiles, observed 𝐌\\pmb{M}. zz vector independent draws N(0,1)\\text{N}(0,1) distribution, resulting vector 𝐦=𝐅𝐳+𝐠\\begin{equation}   \\pmb{m} = \\pmb{F} \\pmb{z} + \\pmb{g} \\end{equation} looks like randomly-selected column 𝐌\\pmb{M}. use 𝐅\\pmb{F} 𝐠\\pmb{g} build priors age effects age-sex interactions. prior age effects 𝛃(1)=𝐅𝛂+𝐠αk∼N(0,1),k=1,⋯,K\\begin{align}   \\pmb{\\beta}^{(1)} & = \\pmb{F} \\pmb{\\alpha} + \\pmb{g} \\\\   \\alpha_k & \\sim \\text{N}(0, 1), \\quad k = 1, \\cdots, K \\end{align} KK chosen user. prior age-sex interactions looks except , default, calculations done separately sex.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"specifying-the-new-model","dir":"Articles","previous_headings":"Revised model","what":"Specifying the new model","title":"6. Modelling Mortality","text":"","code":"mod_hmd <- mod_pois(deaths ~ age:sex + time,                     data = dth,                     exposure = ~ ifelse(deaths > 0 & popn == 0, 0.5, popn)) |>   set_prior(age:sex ~ SVD(HMD)) mod_hmd #> -- Unfitted Poisson model -- #>  #>      deaths ~ age:sex + time #>  #> (Intercept) ~ NFix() #>        time ~ RW() #>     age:sex ~ SVD(HMD) #>  #>      dispersion: mean=1 #>        exposure: ~ifelse(deaths > 0 & popn == 0, 0.5, popn) #>         var_age: age #>   var_sexgender: sex #>        var_time: time #>          n_draw: 1000 mod_hmd <- fit(mod_hmd) mod_hmd #> -- Fitted Poisson model -- #>  #>      deaths ~ age:sex + time #>  #> (Intercept) ~ NFix() #>        time ~ RW() #>     age:sex ~ SVD(HMD) #>  #>      dispersion: mean=1 #>        exposure: ~ifelse(deaths > 0 & popn == 0, 0.5, popn) #>         var_age: age #>   var_sexgender: sex #>        var_time: time #>          n_draw: 1000 aug_hmd <- augment(mod_hmd)  rates_hmd <- aug_hmd |>   filter(time %in% c(1998, 2010, 2022)) |>   select(age, sex, time, .observed, .fitted) |>   mutate(draws_ci(.fitted))  ggplot(rates_hmd, aes(x = age_mid(age),               ymin = .fitted.lower,              y = .fitted.mid,              ymax = .fitted.upper)) +   facet_grid(vars(sex), vars(time)) +   geom_ribbon(fill = \"lightblue\") +   geom_line(col= \"darkblue\") +   geom_point(aes(y = .observed),              size = 0.2) +   scale_y_log10() +   ggtitle(\"Modelled and direct estimates of mortality rates - HMD model\") #> Warning in scale_y_log10(): log-10 transformation introduced #> infinite values. #> Warning: Removed 6 rows containing missing values or values outside the scale range #> (`geom_point()`). comp_hmd <- components(mod_hmd)  age_sex_interact <- comp_hmd |>   filter(component == \"effect\",          term == \"age:sex\") |>   separate_wider_delim(level, delim = \".\", names = c(\"age\", \"sex\")) |>   mutate(draws_ci(.fitted))  ggplot(age_sex_interact,        aes(x = age_mid(age),            y = .fitted.mid,            ymin = .fitted.lower,            ymax = .fitted.upper)) +   geom_ribbon(aes(fill = sex),               alpha = 0.3) +   geom_line(aes(col = sex)) +   ggtitle(\"Age-sex interaction\")"},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"model-testing","dir":"Articles","previous_headings":"","what":"Model testing","title":"6. Modelling Mortality","text":"","code":"rep_data_base <- replicate_data(mod_base, condition_on = \"meanpar\")  data <- rep_data_base |>   filter(time == 2022) |>   select(-popn) |>   pivot_wider(names_from = sex, values_from = deaths) |>   mutate(diff = Female - Male) ggplot(data, aes(x = age_mid(age), y = diff)) +   facet_wrap(vars(.replicate)) +   geom_point(size = 0.2) rep_data_hmd <- replicate_data(mod_hmd, condition_on = \"meanpar\")  data <- rep_data_hmd |>   filter(time == 2022) |>   select(-popn) |>   pivot_wider(names_from = sex, values_from = deaths) |>   mutate(diff = Female - Male) ggplot(data, aes(x = age_mid(age), y = diff)) +   facet_wrap(vars(.replicate)) +   geom_point(size = 0.2)"},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"life-expectancy-and-life-tables","dir":"Articles","previous_headings":"","what":"Life expectancy and life tables","title":"6. Modelling Mortality","text":"","code":"lifeexp_hmd <- mod_hmd |>   augment() |>   lifeexp(mx = .fitted,           by = c(time, sex)) lifeexp_hmd #> # A tibble: 50 × 3 #>     time sex              ex #>    <int> <fct>  <rdbl<1000>> #>  1  1998 Female  82 (81, 82) #>  2  1998 Male    78 (77, 78) #>  3  1999 Female  82 (81, 82) #>  4  1999 Male    78 (77, 78) #>  5  2000 Female  82 (82, 82) #>  6  2000 Male    78 (78, 79) #>  7  2001 Female  82 (82, 83) #>  8  2001 Male    79 (78, 79) #>  9  2002 Female  82 (82, 83) #> 10  2002 Male    79 (78, 79) #> # ℹ 40 more rows lifeexp_hmd <- mod_hmd |>   augment() |>   lifeexp(mx = .fitted,           by = c(time, sex)) lifeexp_hmd #> # A tibble: 50 × 3 #>     time sex              ex #>    <int> <fct>  <rdbl<1000>> #>  1  1998 Female  82 (81, 82) #>  2  1998 Male    78 (77, 78) #>  3  1999 Female  82 (81, 82) #>  4  1999 Male    78 (77, 78) #>  5  2000 Female  82 (82, 82) #>  6  2000 Male    78 (78, 79) #>  7  2001 Female  82 (82, 83) #>  8  2001 Male    79 (78, 79) #>  9  2002 Female  82 (82, 83) #> 10  2002 Male    79 (78, 79) #> # ℹ 40 more rows"},{"path":"https://bayesiandemography.github.io/bage/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"John Bryant. Author, maintainer. Junni Zhang. Author. Bayesian Demography Limited. Copyright holder.","code":""},{"path":"https://bayesiandemography.github.io/bage/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Bryant J, Zhang J (2024). bage: Bayesian Estimation Forecasting Age-Specific Rates. R package version 0.6.2, https://bayesiandemography.github.io/bage/.","code":"@Manual{,   title = {bage: Bayesian Estimation and Forecasting of Age-Specific Rates},   author = {John Bryant and Junni Zhang},   year = {2024},   note = {R package version 0.6.2},   url = {https://bayesiandemography.github.io/bage/}, }"},{"path":"https://bayesiandemography.github.io/bage/index.html","id":"bage-","dir":"","previous_headings":"","what":"Bayesian Estimation and Forecasting of Age-Specific Rates","title":"Bayesian Estimation and Forecasting of Age-Specific Rates","text":"Fast Bayesian estimation forecasting age-specific rates.","code":""},{"path":"https://bayesiandemography.github.io/bage/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Bayesian Estimation and Forecasting of Age-Specific Rates","text":"","code":"devtools::install_github(\"bayesiandemography/bage\")"},{"path":"https://bayesiandemography.github.io/bage/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Bayesian Estimation and Forecasting of Age-Specific Rates","text":"Fit Poisson model data injuries. Extract model-based direct estimates.","code":"library(bage) mod <- mod_pois(injuries ~ age:sex + ethnicity + year,                 data = injuries,                 exposure = popn) |>   fit() mod #> -- Fitted Poisson model -- #>  #>    injuries ~ age:sex + ethnicity + year #> (Intercept) ~ NFixed(sd=10) #>   ethnicity ~ N() #>        year ~ RW() #>     age:sex ~ N() #>  #>        exposure: popn #>         var_age: age #>   var_sexgender: sex #>        var_time: year #>          n_draw: 1000 augment(mod) #> # A tibble: 912 × 8 #>    age   sex    ethnicity  year injuries  popn                    .fitted #>    <fct> <chr>  <chr>     <int>    <int> <int>               <rdbl<1000>> #>  1 0-4   Female Maori      2000       12 35830 0.00024 (0.00022, 0.00027) #>  2 5-9   Female Maori      2000        6 35120 6.8e-05 (5.6e-05, 8.3e-05) #>  3 10-14 Female Maori      2000        3 32830 9.1e-05 (7.8e-05, 0.00011) #>  4 15-19 Female Maori      2000        6 27130 0.00043 (0.00039, 0.00047) #>  5 20-24 Female Maori      2000        6 24380 0.00042 (0.00038, 0.00047) #>  6 25-29 Female Maori      2000        6 24160 0.00035 (0.00031, 0.00039) #>  7 30-34 Female Maori      2000       12 22560 0.00032 (0.00029, 0.00036) #>  8 35-39 Female Maori      2000        3 22230 0.00035 (0.00032, 0.00039) #>  9 40-44 Female Maori      2000        6 18130 0.00034 (0.00031, 0.00038) #> 10 45-49 Female Maori      2000        6 13770   0.00036 (0.00033, 4e-04) #> # ℹ 902 more rows #> # ℹ 1 more variable: .observed <dbl>"},{"path":"https://bayesiandemography.github.io/bage/reference/AR.html","id":null,"dir":"Reference","previous_headings":"","what":"Autoregressive Prior — AR","title":"Autoregressive Prior — AR","text":"Prior main effects interaction. autoreggressive process order k. Typically used time.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Autoregressive Prior — AR","text":"","code":"AR(n_coef = 2, s = 1, along = NULL)"},{"path":"https://bayesiandemography.github.io/bage/reference/AR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Autoregressive Prior — AR","text":"n_coef Thehe number lagged terms model, ie order model. Default 2. s Scale prior innovations. Default 1. along Name variable used \"along\" variable. used interactions.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Autoregressive Prior — AR","text":"object class \"bage_prior_ar\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Autoregressive Prior — AR","text":"AR() used interaction, separate AR series constructed along \"along\" variable within combination \"\" variables. Argument s controls size innovations. Smaller values s tend give smoother series.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Autoregressive Prior — AR","text":"AR() used main effect, $$\\beta_j = \\phi_1 \\beta_{j-1} + \\cdots + \\phi_n \\beta_{j-n} + \\epsilon_j$$ $$\\epsilon_j \\sim \\text{N}(0, \\omega^2),$$ used interaction, $$\\beta_{u,v} = \\phi_1 \\beta_{u,v-1} + \\cdots + \\phi_n \\beta_{u,v-n} + \\epsilon_{u,v}$$ $$\\epsilon_{u,v} \\sim \\text{N}(0, \\omega^2),$$ \\(\\pmb{\\beta}\\) main effect interaction; \\(j\\) denotes position within main effect; \\(v\\) denotes position within \"along\" variable interaction; \\(u\\) denotes position within \"\" variable(s) interaction; \\(n\\) n_coef. Internally, AR() derives value \\(\\omega\\) gives every element \\(\\beta\\) marginal variance \\(\\tau^2\\). Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ s provided user. autocorrelation coefficients \\(\\phi_1, \\cdots, \\phi_n\\) restricted values -1 1 jointly lead stationary model. quantity \\(r = \\sqrt{\\phi_1^2 + \\cdots + \\phi_n^2}\\) boundary-avoiding prior $$r \\sim \\text{Beta}(2, 2).$$","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Autoregressive Prior — AR","text":"AR() based TMB function ARk","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/AR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Autoregressive Prior — AR","text":"","code":"AR(n_coef = 3) #>   AR(n_coef=3)  #>   n_coef: 3 #>      min: -1 #>      max: 1 #>        s: 1 #>    along: NULL AR(n_coef = 3, s = 2.4) #>   AR(n_coef=3,s=2.4)  #>   n_coef: 3 #>      min: -1 #>      max: 1 #>        s: 2.4 #>    along: NULL AR(along = \"cohort\") #>   AR(along=\"cohort\")  #>   n_coef: 2 #>      min: -1 #>      max: 1 #>        s: 1 #>    along: cohort"},{"path":"https://bayesiandemography.github.io/bage/reference/AR1.html","id":null,"dir":"Reference","previous_headings":"","what":"AR1 Prior — AR1","title":"AR1 Prior — AR1","text":"Prior main effect interaction. autoregressive process order 1. Typically used time.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"AR1 Prior — AR1","text":"","code":"AR1(min = 0.8, max = 0.98, s = 1, along = NULL)"},{"path":"https://bayesiandemography.github.io/bage/reference/AR1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"AR1 Prior — AR1","text":"min, max Minimum maximum values autocorrelation coefficient. Defaults 0.8 0.98. s Scale prior innovations. Default 1. along Name variable used \"along\" variable. used interactions.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR1.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"AR1 Prior — AR1","text":"object class \"bage_prior_ar\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR1.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"AR1 Prior — AR1","text":"AR1() used interaction, separate AR1 series constructed along \"along\" variable within combination \"\" variables. Argument s controls size innovations. Smaller values s tend give smoother series.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR1.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"AR1 Prior — AR1","text":"AR1() used main effect, $$\\beta_j = \\phi \\beta_{j-1} + \\epsilon_j$$ $$\\epsilon_j \\sim \\text{N}(0, \\omega^2),$$ used interaction, $$\\beta_{u,v} = \\phi \\beta_{u,v-1} + \\epsilon_{u,v}$$ $$\\epsilon_{u,v} \\sim \\text{N}(0, \\omega^2),$$ \\(\\pmb{\\beta}\\) main effect interaction; \\(j\\) denotes position within main effect; \\(v\\) denotes position within \"along\" variable interaction; \\(u\\) denotes position within \"\" variable(s) interaction. Internally, AR1() derives value \\(\\omega\\) gives every element \\(\\beta\\) marginal variance \\(\\tau^2\\). Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ s provided user. Coefficient \\(\\phi\\) constrained lie min max. prior distribution $$\\phi = (\\text{max} - \\text{min}) \\phi' - \\text{min}$$ $$\\phi' \\sim \\text{Beta}(2, 2).$$","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR1.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"AR1 Prior — AR1","text":"AR1() based TMB function AR1 defaults min max based defaults forecast::ets().","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/AR1.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"AR1 Prior — AR1","text":"","code":"AR1() #>   AR1()  #>      min: 0.8 #>      max: 0.98 #>        s: 1 #>    along: NULL AR1(min = 0, max = 1, s = 2.4) #>   AR1(min=0,max=1,s=2.4)  #>      min: 0 #>      max: 1 #>        s: 2.4 #>    along: NULL AR1(along = \"cohort\") #>   AR1(along=\"cohort\")  #>      min: 0.8 #>      max: 0.98 #>        s: 1 #>    along: cohort"},{"path":"https://bayesiandemography.github.io/bage/reference/HMD.html","id":null,"dir":"Reference","previous_headings":"","what":"Components from Human Mortality Database — HMD","title":"Components from Human Mortality Database — HMD","text":"object class bage_ssvd holding components extracted mortality data Human Mortality Database. object holds 5 components.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/HMD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Components from Human Mortality Database — HMD","text":"","code":"HMD"},{"path":"https://bayesiandemography.github.io/bage/reference/HMD.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Components from Human Mortality Database — HMD","text":"object class bage_ssvd length 1.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/HMD.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Components from Human Mortality Database — HMD","text":"Derived data Human Mortality Database. Max Planck Institute Demographic Research (Germany), University California, Berkeley (USA), French Institute Demographic Studies (France). Available www.mortality.org. Code create HMD folder 'data-raw/ssvd_hmd' source code bage package.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Known.html","id":null,"dir":"Reference","previous_headings":"","what":"Known Prior — Known","title":"Known Prior — Known","text":"Treat intercept, main effect, interaction fixed known.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Known.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Known Prior — Known","text":"","code":"Known(values)"},{"path":"https://bayesiandemography.github.io/bage/reference/Known.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Known Prior — Known","text":"values numeric vector","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Known.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Known Prior — Known","text":"object class \"bage_prior_known\".","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/Known.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Known Prior — Known","text":"","code":"Known(-2.3) #> Known(-2.3)  Known(c(0.1, 2, -0.11)) #> Known(c(0.1,2,-0.11))"},{"path":"https://bayesiandemography.github.io/bage/reference/LFP.html","id":null,"dir":"Reference","previous_headings":"","what":"Components from OECD Labour Force Participation Data — LFP","title":"Components from OECD Labour Force Participation Data — LFP","text":"object class bage_ssvd holding components extracted labour force participation data OECD Data Explorer.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/LFP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Components from OECD Labour Force Participation Data — LFP","text":"","code":"LFP"},{"path":"https://bayesiandemography.github.io/bage/reference/LFP.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Components from OECD Labour Force Participation Data — LFP","text":"object class bage_ssvd length 1.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/LFP.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Components from OECD Labour Force Participation Data — LFP","text":"Derived data \"Labour Force Indicators\" table OECD Data Explorer. Code create LFS folder 'data-raw/ssvd_lfp' source code bage package.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin.html","id":null,"dir":"Reference","previous_headings":"","what":"Linear Prior — Lin","title":"Linear Prior — Lin","text":"Prior main effect interaction. straight line lines, combined independent normal errors. Typically used time.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Linear Prior — Lin","text":"","code":"Lin(s = 1, sd = 1, along = NULL)"},{"path":"https://bayesiandemography.github.io/bage/reference/Lin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Linear Prior — Lin","text":"s Scale prior errors. Default 1. sd Standard deviation prior slope line. Default 1. along Name variable used \"along\" variable. used interactions.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Linear Prior — Lin","text":"object class \"bage_prior_lin\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Linear Prior — Lin","text":"Lin() used interaction, separate lines constructed along \"along\" variable, within combination \"\" variables. Argument s controls size errors.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Linear Prior — Lin","text":"Lin() used main effect, $$\\beta_j = \\alpha + j \\eta + \\epsilon_j$$ $$\\alpha \\sim \\text{N}(0, 1)$$ $$\\epsilon_j \\sim \\text{N}(0, \\tau^2),$$ used interaction, $$\\beta_{u,v} \\sim  \\alpha_u + v \\eta_u + \\epsilon_{u,v}, \\quad v > 1$$ $$\\alpha_u \\sim \\text{N}(0, 1)$$ $$\\epsilon_{u,v} \\sim \\text{N}(0, \\tau^2),$$ \\(\\pmb{\\beta}\\) main effect interaction; \\(j\\) denotes position within main effect; \\(v\\) denotes position within \"along\" variable interaction; \\(u\\) denotes position within \"\" variable(s) interaction. slopes priors $$\\eta \\sim \\text{N}(0, \\text{sd}^2)$$ $$\\eta_u \\sim \\text{N}(0, \\text{sd}^2).$$ Larger values sd permit steeper slopes. Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ s provided user.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/Lin.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Linear Prior — Lin","text":"","code":"Lin() #>   Lin()  #>        s: 1 #>       sd: 1 #>    along: NULL Lin(s = 0.5, sd = 2) #>   Lin(s=0.5,sd=2)  #>        s: 0.5 #>       sd: 2 #>    along: NULL Lin(along = \"cohort\") #>   Lin(along=\"cohort\")  #>        s: 1 #>       sd: 1 #>    along: cohort"},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR.html","id":null,"dir":"Reference","previous_headings":"","what":"Linear Prior with Autoregressive Errors — Lin_AR","title":"Linear Prior with Autoregressive Errors — Lin_AR","text":"Prior main effect interaction. straight line lines, combined autoregressive errors. Typically used time.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Linear Prior with Autoregressive Errors — Lin_AR","text":"","code":"Lin_AR(n_coef = 2, s = 1, sd = 1, along = NULL)"},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Linear Prior with Autoregressive Errors — Lin_AR","text":"n_coef number lagged terms model, ie order model. Default 2. s Scale innovations AR process. Default 1. sd Standard deviation prior slope line. Larger values imply steeper slopes. Default 1. along Name variable used \"along\" variable. used interactions.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Linear Prior with Autoregressive Errors — Lin_AR","text":"object class \"bage_prior_linar\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Linear Prior with Autoregressive Errors — Lin_AR","text":"Lin_AR() used interaction, , within combination \"\" variables, \"along\" variable modelled straight line autoregressive errors. Argument s controls size errors.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Linear Prior with Autoregressive Errors — Lin_AR","text":"Lin_AR() used main effect, $$\\beta_1 = \\alpha + \\epsilon_1$$ $$\\beta_j = \\alpha + (j - 1) \\eta + \\epsilon_j, \\quad j > 1$$ $$\\alpha \\sim \\text{N}(0, 1)$$ $$\\epsilon_j = \\phi_1 \\epsilon_{j-1} + \\cdots + \\phi_n \\epsilon_{j-n} + \\varepsilon_j$$ $$\\varepsilon_j \\sim \\text{N}(0, \\omega^2),$$ used interaction, $$\\beta_{u,1} = \\alpha_u + \\epsilon_{u,1}$$ $$\\beta_{u,v} = \\eta (v - 1) + \\epsilon_{u,v}, \\quad v = 2, \\cdots, V$$ $$\\alpha_u \\sim \\text{N}(0, 1)$$ $$\\epsilon_{u,v} = \\phi_1 \\epsilon_{u,v-1} + \\cdots + \\phi_n \\epsilon_{u,v-n} + \\varepsilon_{u,v},$$ $$\\varepsilon_{u,v} \\sim \\text{N}(0, \\omega^2).$$ \\(\\pmb{\\beta}\\) main effect interaction; \\(j\\) denotes position within main effect; \\(u\\) denotes position within \"along\" variable interaction; \\(u\\) denotes position within \"\" variable(s) interaction; \\(n\\) n_coef. slopes priors $$\\eta \\sim \\text{N}(0, \\text{sd}^2)$$ $$\\eta_u \\sim \\text{N}(0, \\text{sd}^2).$$ Larger values sd permit steeper slopes. Internally, Lin_AR() derives value \\(\\omega\\) gives \\(\\epsilon_j\\) \\(\\epsilon_{u,v}\\) marginal variance \\(\\tau^2\\). Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ value s provided user. \\(\\phi_1, \\cdots, \\phi_k\\) restricted values -1 1 jointly lead stationary model. quantity \\(r = \\sqrt{\\phi_1^2 + \\cdots + \\phi_k^2}\\) given boundary-avoiding prior $$r \\sim \\text{Beta}(2, 2).$$ Slope \\(\\eta\\) drawn normal distribution, $$\\eta \\sim \\text{N}(0, (\\text{sd})^2).$$","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Linear Prior with Autoregressive Errors — Lin_AR","text":"","code":"Lin_AR() #>   Lin_AR()  #>   n_coef: 2 #>        s: 1 #>       sd: 1 #>      min: -1 #>      max: 1 #>    along: NULL Lin_AR(n_coef = 3, s = 0.5, sd = 2) #>   Lin_AR(n_coef=3,s=0.5,sd=2)  #>   n_coef: 3 #>        s: 0.5 #>       sd: 2 #>      min: -1 #>      max: 1 #>    along: NULL"},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR1.html","id":null,"dir":"Reference","previous_headings":"","what":"Linear Prior with AR1 Errors — Lin_AR1","title":"Linear Prior with AR1 Errors — Lin_AR1","text":"Prior main effect interaction. Combines straight line lines AR1 errors. Typically used time.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Linear Prior with AR1 Errors — Lin_AR1","text":"","code":"Lin_AR1(min = 0.8, max = 0.98, s = 1, sd = 1, along = NULL)"},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Linear Prior with AR1 Errors — Lin_AR1","text":"min, max Minimum maximum values autocorrelation coefficient. Defaults 0.8 0.98. s Scale innovations AR process. Default 1. sd Standard deviation prior slope line. Larger values imply steeper slopes. Default 1. along Name variable used \"along\" variable. used interactions.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR1.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Linear Prior with AR1 Errors — Lin_AR1","text":"object class \"bage_prior_linar\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR1.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Linear Prior with AR1 Errors — Lin_AR1","text":"Lin_AR1() used interaction, , within combination \"\" variables, \"along\" variable modelled straight line autoregressive errors. Argument s controls size errors.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR1.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Linear Prior with AR1 Errors — Lin_AR1","text":"Lin_AR1() used main effect, $$\\beta_j = \\eta q_j + \\epsilon_j$$ $$\\epsilon_j = \\phi \\epsilon_{j-1} + \\varepsilon_j,$$ $$\\varepsilon_j \\sim \\text{N}(0, \\omega^2).$$ used interaction, $$\\beta_{u,v} = \\eta_j q_{u,v} + \\epsilon_{u,v}$$ $$\\epsilon_{u,v} = \\phi + \\varepsilon_{u,v},$$ $$\\varepsilon_{u,v} \\sim \\text{N}(0, \\omega^2).$$ \\(\\pmb{\\beta}\\) main effect interaction; \\(j\\) denotes position within main effect; \\(u\\) denotes position within \"along\" variable interaction; \\(u\\) denotes position within \"\" variable(s) interaction; \\(q = - (J+1)/(J-1) + 2j/(J-1);\\) \\(q_v = - (V+1)/(V-1) + 2v/(V-1)\\). slopes priors $$\\eta \\sim \\text{N}(0, \\text{sd}^2)$$ $$\\eta_u \\sim \\text{N}(0, \\text{sd}^2).$$ Larger values sd permit steeper slopes. Internally, Lin_AR1() derives value \\(\\omega\\) gives \\(\\epsilon_j\\) \\(\\epsilon_{u,v}\\) marginal variance \\(\\tau^2\\). Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ value s provided user. Coefficient \\(\\phi\\) constrained lie min max. prior distribution $$\\phi = (\\text{max} - \\text{min}) \\phi' - \\text{min}$$ $$\\phi' \\sim \\text{Beta}(2, 2).$$","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR1.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Linear Prior with AR1 Errors — Lin_AR1","text":"defaults min max based defaults forecast::ets().","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR1.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Linear Prior with AR1 Errors — Lin_AR1","text":"","code":"Lin_AR1() #>   Lin_AR1()  #>        s: 1 #>       sd: 1 #>      min: 0.8 #>      max: 0.98 #>    along: NULL Lin_AR1(min = 0, s = 0.5, sd = 2) #>   Lin_AR1(min=0,s=0.5,sd=2)  #>        s: 0.5 #>       sd: 2 #>      min: 0 #>      max: 0.98 #>    along: NULL"},{"path":"https://bayesiandemography.github.io/bage/reference/N.html","id":null,"dir":"Reference","previous_headings":"","what":"Normal Prior — N","title":"Normal Prior — N","text":"Prior main effect interaction. Values drawn independently common normal distribution. Typically used variables age time, region ethncity.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/N.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normal Prior — N","text":"","code":"N(s = 1)"},{"path":"https://bayesiandemography.github.io/bage/reference/N.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normal Prior — N","text":"s Scale standard deviation. Default 1.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/N.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normal Prior — N","text":"object class \"bage_prior_norm\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/N.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Normal Prior — N","text":"Argument s controls size errors. Smaller values s tend give tightly clustered estimates elements main effect interaction.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/N.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Normal Prior — N","text":"$$\\beta_j \\sim \\text{N}(0, \\tau^2)$$ \\(\\beta\\) main effect interaction. Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ s provided user.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/N.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normal Prior — N","text":"","code":"N() #>   N()  #>        s: 1 N(s = 0.5) #>   N(s=0.5)  #>        s: 0.5"},{"path":"https://bayesiandemography.github.io/bage/reference/NFix.html","id":null,"dir":"Reference","previous_headings":"","what":"Normal Prior with Fixed Variance — NFix","title":"Normal Prior with Fixed Variance — NFix","text":"Normal prior , contrast N(), variance treated fixed known.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/NFix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normal Prior with Fixed Variance — NFix","text":"","code":"NFix(sd = 1)"},{"path":"https://bayesiandemography.github.io/bage/reference/NFix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normal Prior with Fixed Variance — NFix","text":"sd Standard deviation. Default 1.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/NFix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normal Prior with Fixed Variance — NFix","text":"object class \"bage_prior_normfixed\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/NFix.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Normal Prior with Fixed Variance — NFix","text":"NFix() default prior intercept.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/NFix.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Normal Prior with Fixed Variance — NFix","text":"$$\\beta_j \\sim \\text{N}(0, \\tau^2)$$ \\(\\beta\\) main effect interaction, value sd supplied user.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/NFix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normal Prior with Fixed Variance — NFix","text":"","code":"NFix() #>   NFix()  #>       sd: 1 NFix(sd = 10) #>   NFix(sd=10)  #>       sd: 10"},{"path":"https://bayesiandemography.github.io/bage/reference/RW.html","id":null,"dir":"Reference","previous_headings":"","what":"Random Walk Prior — RW","title":"Random Walk Prior — RW","text":"Prior main effect interaction. random walk. Typically used time.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Random Walk Prior — RW","text":"","code":"RW(s = 1, along = NULL)"},{"path":"https://bayesiandemography.github.io/bage/reference/RW.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Random Walk Prior — RW","text":"s Scale prior innovations. Default 1. along Name variable used \"along\" variable. used interactions.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Random Walk Prior — RW","text":"object class \"bage_prior_rw\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Random Walk Prior — RW","text":"RW() used interaction, separate random walks used \"along\" variable within combination \"\" variables. Argument s controls size innovations. Smaller values s tend give smoother series.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Random Walk Prior — RW","text":"RW() used main effect, $$\\beta_j = \\beta_{j-1} + \\epsilon_j$$ $$\\epsilon_j \\sim \\text{N}(0, \\tau^2),$$ used interaction, $$\\beta_{u,v} = \\beta_{u,v-1} + \\epsilon_{u,v}$$ $$\\epsilon_{u,v} \\sim \\text{N}(0, \\tau^2),$$ \\(\\pmb{\\beta}\\) main effect interaction; \\(j\\) denotes position within main effect; \\(v\\) denotes position within \"along\" variable interaction; \\(u\\) denotes position within \"\" variable(s) interaction. Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ s provided user.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/RW.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Random Walk Prior — RW","text":"","code":"RW() #>   RW()  #>        s: 1 #>    along: NULL RW(s = 0.5) #>   RW(s=0.5)  #>        s: 0.5 #>    along: NULL RW(along = \"cohort\") #>   RW(along=\"cohort\")  #>        s: 1 #>    along: cohort"},{"path":"https://bayesiandemography.github.io/bage/reference/RW2.html","id":null,"dir":"Reference","previous_headings":"","what":"Random Walk with Drift Prior — RW2","title":"Random Walk with Drift Prior — RW2","text":"Prior main effect interaction. random walk drift, also referred second-order random walk. Typically used age, used time sustained upward downward trends.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Random Walk with Drift Prior — RW2","text":"","code":"RW2(s = 1, along = NULL)"},{"path":"https://bayesiandemography.github.io/bage/reference/RW2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Random Walk with Drift Prior — RW2","text":"s Scale prior innovations. Default 1. along Name variable used \"along\" variable. used interactions.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Random Walk with Drift Prior — RW2","text":"object class \"bage_prior_rw2\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Random Walk with Drift Prior — RW2","text":"RW2() used interaction, separate random walks used \"along\" variable within combination \"\" variables. Argument s controls size errors. Smaller values s tend give smoother series.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Random Walk with Drift Prior — RW2","text":"RW() used main effect, $$\\beta_j = 2 \\beta_{j-1} - \\beta_{j-2} + \\epsilon_j$$ $$\\epsilon_j \\sim \\text{N}(0, \\tau^2),$$ used interaction, $$\\beta_{u,v} = 2\\beta_{u,v-1} - \\beta_{u,v-2} + \\epsilon_{u,v}$$ $$\\epsilon_{u,v} \\sim \\text{N}(0, \\tau^2),$$ \\(\\pmb{\\beta}\\) main effect interaction; \\(j\\) denotes position within main effect; \\(v\\) denotes position within \"along\" variable interaction; \\(u\\) denotes position within \"\" variable(s) interaction. Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ s provided user.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/RW2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Random Walk with Drift Prior — RW2","text":"","code":"RW2() #>   RW2()  #>        s: 1 #>    along: NULL RW2(s = 0.5) #>   RW2(s=0.5)  #>        s: 0.5 #>    along: NULL"},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Seas.html","id":null,"dir":"Reference","previous_headings":"","what":"Random Walk with Drift Prior, with Seasonal Effect — RW2_Seas","title":"Random Walk with Drift Prior, with Seasonal Effect — RW2_Seas","text":"Prior main effect interaction, typically involving time. Combines random walk drift (ie second-order random walk) seasonal effect.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Seas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Random Walk with Drift Prior, with Seasonal Effect — RW2_Seas","text":"","code":"RW2_Seas(n_seas, s = 1, s_seas = 1, along = NULL)"},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Seas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Random Walk with Drift Prior, with Seasonal Effect — RW2_Seas","text":"n_seas Number seasons s Scale prior innovations random walk. Default 1. s_seas Scale prior innovations seasonal effect. Default 1. Can 0. along Name variable used \"along\" variable. used interactions.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Seas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Random Walk with Drift Prior, with Seasonal Effect — RW2_Seas","text":"Object class \"bage_prior_rw2seasvary\" \"bage_prior_rw2seasfix\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Seas.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Random Walk with Drift Prior, with Seasonal Effect — RW2_Seas","text":"RW2_Seas() used interaction, separate series used \"along\" variable within combination \"\" variables. Argument s controls size innovations random walk. Smaller values s tend give smoother series. Argument n_seas controls number seasons. using quarterly data, instance, n_seas 4, using monthly data, n_seas 12. default, magnitude seasonal effects can change time. However, setting s_seas 0 produces seasonal effects \"fixed\", ie every year.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Seas.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Random Walk with Drift Prior, with Seasonal Effect — RW2_Seas","text":"RW2_Seas() used main effect, $$\\beta_j = \\alpha_j + \\lambda_j$$ $$\\alpha_j \\sim \\text{N}(2 \\alpha_{j-1} - \\alpha_{j-2}, \\tau^2)$$ $$\\lambda_j \\sim \\text{N}(\\lambda_{j-n}, \\omega^2),$$ used interaction, $$\\beta_{u,v} = \\alpha_{u,v} + \\lambda_{u,v}$$ $$\\alpha_{u,v} \\sim \\text{N}(2 \\alpha_{u,v-1} - \\alpha_{u,v-2}, \\tau^2),$$ $$\\lambda_{u,v} \\sim \\text{N}(\\lambda_{u,v-n}, \\omega^2)$$ \\(\\pmb{\\beta}\\) main effect interaction; \\(\\alpha_j\\) \\(\\alpha_{u,v}\\) element random walk; \\(\\lambda_j\\) \\(\\lambda_{u,v}\\) element seasonal effect; \\(j\\) denotes position within main effect; \\(v\\) denotes position within \"along\" variable interaction; \\(u\\) denotes position within \"\" variable(s) interaction; \\(n\\) n_seas. Parameter \\(\\omega\\) half-normal prior $$\\omega \\sim \\text{N}^+(0, \\text{s\\_seas}^2),$$ s_seas provided user. s_seas set 0, \\(\\omega\\) 0, seasonal effects fixed time. Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ s provided user.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Seas.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Random Walk with Drift Prior, with Seasonal Effect — RW2_Seas","text":"","code":"RW2_Seas(n_seas = 4)             ## seasonal effects evolve #>   RW2_Seas(n_seas=4)  #>   n_seas: 4 #>        s: 1 #>   s_seas: 1 #>    along: NULL RW2_Seas(n_seas = 4, s_seas = 0) ## seasonal effects fixed #>   RW2_Seas(n_seas=4,s_seas=0)  #>   n_seas: 4 #>        s: 1 #>   s_seas: 0 #>    along: NULL"},{"path":"https://bayesiandemography.github.io/bage/reference/RW_Seas.html","id":null,"dir":"Reference","previous_headings":"","what":"Random Walk Prior, with Seasonal Effect — RW_Seas","title":"Random Walk Prior, with Seasonal Effect — RW_Seas","text":"Prior main effect interaction, typically involving time. Combines random walk seasonal effect.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW_Seas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Random Walk Prior, with Seasonal Effect — RW_Seas","text":"","code":"RW_Seas(n_seas, s = 1, s_seas = 1, along = NULL)"},{"path":"https://bayesiandemography.github.io/bage/reference/RW_Seas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Random Walk Prior, with Seasonal Effect — RW_Seas","text":"n_seas Number seasons s Scale prior innovations random walk. Default 1. s_seas Scale prior innovations seasonal effect. Default 1. Can 0. along Name variable used \"along\" variable. used interactions.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW_Seas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Random Walk Prior, with Seasonal Effect — RW_Seas","text":"Object class \"bage_prior_rwseasvary\" \"bage_prior_rwseasfix\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW_Seas.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Random Walk Prior, with Seasonal Effect — RW_Seas","text":"RW_Seas() used interaction, separate series used \"along\" variable within combination \"\" variables. Argument s controls size innovations random walk. Smaller values s tend give smoother series. Argument n_seas controls number seasons. using quarterly data, instance, n_seas 4, using monthly data, n_seas 12. default, magnitude seasonal effects can change time. However, setting s_seas 0 produces seasonal effects \"fixed\", ie every year.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW_Seas.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Random Walk Prior, with Seasonal Effect — RW_Seas","text":"RW_Seas() used main effect, $$\\beta_j = \\alpha_j + \\lambda_j$$ $$\\alpha_j \\sim \\text{N}(\\alpha_{j-1}, \\tau^2)$$ $$\\lambda_j \\sim \\text{N}(\\lambda_{j-n}, \\omega^2),$$ used interaction, $$\\beta_{u,v} = \\alpha_{u,v} + \\lambda_{u,v}$$ $$\\alpha_{u,v} \\sim \\text{N}(\\alpha_{u,v-1}, \\tau^2),$$ $$\\lambda_{u,v} \\sim \\text{N}(\\lambda_{u,v-n}, \\omega^2)$$ \\(\\pmb{\\beta}\\) main effect interaction; \\(\\alpha_j\\) \\(\\alpha_{u,v}\\) element random walk; \\(\\lambda_j\\) \\(\\lambda_{u,v}\\) element seasonal effect; \\(j\\) denotes position within main effect; \\(v\\) denotes position within \"along\" variable interaction; \\(u\\) denotes position within \"\" variable(s) interaction; \\(n\\) n_seas. Parameter \\(\\omega\\) half-normal prior $$\\omega \\sim \\text{N}^+(0, \\text{s\\_seas}^2),$$ s_seas provided user. s_seas set 0, \\(\\omega\\) 0, seasonal effects fixed time. Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ s provided user.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/RW_Seas.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Random Walk Prior, with Seasonal Effect — RW_Seas","text":"","code":"RW_Seas(n_seas = 4)             ## seasonal effects evolve #>   RW_Seas(n_seas=4)  #>        n: NULL #>        s: 1 #>   s_seas: 1 #>    along: NULL RW_Seas(n_seas = 4, s_seas = 0) ## seasonal effects fixed #>   RW_Seas(n_seas=4,s_seas=0)  #>   n_seas: 4 #>        s: 1 #>   s_seas: 0 #>    along: NULL"},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":null,"dir":"Reference","previous_headings":"","what":"SVD Prior for Age, or Age and Sex/Gender — SVD","title":"SVD Prior for Age, or Age and Sex/Gender — SVD","text":"Singular Value Decomposition (SVD) prior main effect interaction involving age possibly sex gender variables.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SVD Prior for Age, or Age and Sex/Gender — SVD","text":"","code":"SVD(ssvd, n_comp = NULL, indep = TRUE)"},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SVD Prior for Age, or Age and Sex/Gender — SVD","text":"ssvd Object class \"bage_ssvd\" holding scaled SVD. See scaled SVDs databases currently available bage. n_comp Number components scaled SVD use modelling. default half number components ssvd. indep Whether use separate combined SVDs terms involving sex gender. Default TRUE. See details.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"SVD Prior for Age, or Age and Sex/Gender — SVD","text":"object class \"bage_prior_svd\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"SVD Prior for Age, or Age and Sex/Gender — SVD","text":"SVD() prior assumes age, age-sex, age-gender profile quantity modelled looks like drawn random external demographic database. instance, prior obtained via   assumes age age-sex profiles look like obtained Human Mortality Database. SVD() used interaction involving variables age sex/gender, separate profiles constructed within combination variables. bage chooses appropriate age-specific age-sex-specific SVD values internally. choice depends model term SVD() prior applied , age labels used data argument mod_pois(), mod_binom() mod_norm(). bage makes choice set_prior() called.","code":"SVD(HMD)"},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":"joint-or-independent-svds","dir":"Reference","previous_headings":"","what":"Joint or independent SVDs","title":"SVD Prior for Age, or Age and Sex/Gender — SVD","text":"Two possible ways extracting patterns age-sex-specific data carry separate SVDs separate datasets sex/gender; carry single SVD dataset separate entries sex/gender. Option 1 flexible. Option 2 robust sampling measurement errors. Option 1 obtained setting joint argument  FALSE. Option 1 obtained setting indep argument TRUE. default TRUE.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"SVD Prior for Age, or Age and Sex/Gender — SVD","text":"**Case 1: Term involving age variables ** SVD() used age main effect, $$\\pmb{\\beta} = \\pmb{F} \\pmb{\\alpha} + \\pmb{g},$$ \\(\\pmb{\\beta}\\) main effect interaction involving age; \\(J\\) number elements \\(\\pmb{\\beta}\\); \\(n\\) number components SVD; \\(\\pmb{F}\\) known matrix dimension \\(J \\times n\\); \\(\\pmb{g}\\) known vector \\(J\\) elements. \\(\\pmb{F}\\) \\(\\pmb{g}\\) constructed large database age-specific demographic estimates performing SVD standardizing. elements \\(\\pmb{\\alpha}\\) prior $$\\alpha_k \\sim \\text{N}(0, 1), \\quad k = 1, \\cdots, K.$$ Case 2: Term involving age non-sex, non-gender variable(s) SVD() used interaction involves age involve sex gender, $$\\pmb{\\beta}_u = \\pmb{F} \\pmb{\\alpha}_u + \\pmb{g},$$ \\(\\pmb{\\beta}_u\\) subvector \\(\\pmb{\\beta}\\) holding values  \\(u\\)th combination non-age variables; \\(V\\) number elements \\(\\pmb{\\beta}_u\\); \\(n\\) number components SVD; \\(\\pmb{F}\\) known matrix dimension \\(V \\times n\\); \\(\\pmb{g}\\) known vector \\(V\\) elements. Case 3: Term involving age, sex/gender, variables SVD() used interaction involves age sex gender, two sub-cases, depending value indep. indep TRUE, $$\\pmb{\\beta}_{s} = \\pmb{F}_s \\pmb{\\alpha}_{s} + \\pmb{g}_s,$$ indep FALSE, $$\\pmb{\\beta} = \\pmb{F} \\pmb{\\alpha} + \\pmb{g},$$ \\(\\pmb{\\beta}\\) interaction involving age sex/gender; \\(\\pmb{\\beta}_{s}\\) subvector \\(\\pmb{\\beta}\\), holding values sex/gender \\(s\\); \\(J\\) number elements \\(\\pmb{\\beta}\\); \\(S\\) number sexes/genders; \\(n\\) number components SVD; \\(\\pmb{F}_s\\) known \\((J/S) \\times n\\) matrix, specific sex/gender \\(s\\); \\(\\pmb{g}_s\\) known vector \\(J/S\\) elements, specific sex/gender \\(s\\); \\(\\pmb{F}\\) known \\(J \\times n\\) matrix, values sexes/genders; \\(\\pmb{g}\\) known vector \\(J\\) elements, values sexes/genders. elements \\(\\pmb{\\alpha}_s\\) \\(\\pmb{\\alpha}\\) prior $$\\alpha_k \\sim \\text{N}(0, 1).$$ Case 4: Term involving age, sex/gender, variable(s) SVD() used interaction involves age, sex gender, variables, two sub-cases, depending value indep. indep TRUE, $$\\pmb{\\beta}_{u,s} = \\pmb{F}_s \\pmb{\\alpha}_{u,s} + \\pmb{g}_s,$$ indep FALSE, $$\\pmb{\\beta}_u = \\pmb{F} \\pmb{\\alpha}_u + \\pmb{g},$$ \\(\\pmb{\\beta}\\) interaction involving sex/gender; \\(\\pmb{\\beta}_{u,s}\\) subvector \\(\\pmb{\\beta}\\), holding values sex/gender \\(s\\) \\(u\\)th combination variables; \\(V\\) number elements \\(\\pmb{\\beta}_u\\); \\(S\\) number sexes/genders; \\(n\\) number components SVD; \\(\\pmb{F}_s\\) known \\((V/S) \\times n\\) matrix, specific sex/gender \\(s\\); \\(\\pmb{g}_s\\) known vector \\(V/S\\) elements, specific sex/gender \\(s\\); \\(\\pmb{F}\\) known \\(V \\times n\\) matrix, values sexes/genders; \\(\\pmb{g}\\) known vector \\(V\\) elements, values sexes/genders.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":"scaled-svds-of-demographic-databases-in-bage","dir":"Reference","previous_headings":"","what":"Scaled SVDs of demographic databases in bage","title":"SVD Prior for Age, or Age and Sex/Gender — SVD","text":"HMD Mortality rates Human Mortality Database. LFP Labour forcce participation rates OECD.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"SVD Prior for Age, or Age and Sex/Gender — SVD","text":"details construction scaled SVDS see vignette .","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SVD Prior for Age, or Age and Sex/Gender — SVD","text":"","code":"SVD(HMD)  #>   SVD(HMD)  #>     ssvd: HMD #>   n_comp: 3 SVD(HMD, n_comp = 3) #>   SVD(HMD)  #>     ssvd: HMD #>   n_comp: 3"},{"path":"https://bayesiandemography.github.io/bage/reference/SVD_AR.html","id":null,"dir":"Reference","previous_headings":"","what":"SVD Priors for Age, or Age and Sex/Gender, With Time-Varying Coefficients — SVD_AR","title":"SVD Priors for Age, or Age and Sex/Gender, With Time-Varying Coefficients — SVD_AR","text":"Singular Value Decomposition (SVD) priors interactions involving age time, age, sex/gender time, possibly variables, coefficients evolve time.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD_AR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SVD Priors for Age, or Age and Sex/Gender, With Time-Varying Coefficients — SVD_AR","text":"","code":"SVD_AR(ssvd, n_comp = NULL, indep = TRUE, n_coef = 2, s = 1)  SVD_AR1(ssvd, n_comp = NULL, indep = TRUE, min = 0.8, max = 0.98, s = 1)  SVD_RW(ssvd, n_comp = NULL, indep = TRUE, s = 1)  SVD_RW2(ssvd, n_comp = NULL, indep = TRUE, s = 1)"},{"path":"https://bayesiandemography.github.io/bage/reference/SVD_AR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SVD Priors for Age, or Age and Sex/Gender, With Time-Varying Coefficients — SVD_AR","text":"ssvd Object class \"bage_ssvd\" holding scaled SVD. See scaled SVDs databases currently available bage. n_comp Number components scaled SVD use modelling. default half number components ssvd. indep Whether use separate combined SVDs terms involving sex gender. Default TRUE. See details. n_coef Number AR coefficients SVD_RW(). s Scale standard deviations terms. min, max Minimum maximum values autocorrelation coefficient SVD_AR(). Defaults 0.8 0.98.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD_AR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"SVD Priors for Age, or Age and Sex/Gender, With Time-Varying Coefficients — SVD_AR","text":"object class \"bage_prior_svd_ar\", \"bage_prior_svd_rw\", \"bage_prior_svd_rw2\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD_AR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"SVD Priors for Age, or Age and Sex/Gender, With Time-Varying Coefficients — SVD_AR","text":"SVD_AR(), SVD_AR1(), SVD_RW(), SVD_RW2() priors assume , given period, age profiles age-sex profiles quantity modelled looks like drawn random external demographic database. instance, SVD_AR() prior obtained via   assumes profiles look like obtained Human Mortality Database.","code":"SVD_AR(HMD)"},{"path":"https://bayesiandemography.github.io/bage/reference/SVD_AR.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"SVD Priors for Age, or Age and Sex/Gender, With Time-Varying Coefficients — SVD_AR","text":"interaction modelled involves age time, age, sex/gender, time $$\\pmb{\\beta}_t = \\pmb{F} \\pmb{\\alpha}_t + \\pmb{g},$$ involves variables besides age, sex/gender, time, $$\\pmb{\\beta}_{u,t} = \\pmb{F} \\pmb{\\alpha}_{u,t} + \\pmb{g},$$ \\(\\pmb{\\beta}\\) interaction involving age, time, possibly sex/gender, possibly variables; \\(\\pmb{\\beta}_t\\) subvector \\(\\pmb{\\beta}\\) holding values period \\(t\\); \\(\\pmb{\\beta}_{u,t}\\) subvector \\(\\pmb{\\beta}_t\\) holding values  \\(u\\)th combination non-age, non-time, non-sex/gender variables period \\(t\\); \\(J\\) number elements \\(\\pmb{\\beta}_t\\); \\(V\\) number elements \\(\\pmb{\\beta}_{u,t}\\); \\(n\\) n_coef; \\(\\pmb{F}\\) known matrix dimension \\(J \\times n\\) \\(V \\times n\\); \\(\\pmb{g}\\) known vector \\(J\\) \\(V\\) elements. \\(\\pmb{F}\\) \\(\\pmb{g}\\) constructed large database age-specific demographic estimates performing SVD standardizing. SVD_AR(), prior \\(k\\)th element \\(\\pmb{\\alpha}_t\\) \\(\\pmb{\\alpha}_{u,t}\\) $$\\alpha_{k,t} = \\phi_1 \\alpha_{k,t-1} + \\cdots + \\phi_n \\beta_{k,t-n} + \\epsilon_{k,t}$$ $$\\alpha_{k,u,t} = \\phi_1 \\alpha_{k,u,t-1} + \\cdots + \\phi_n \\beta_{k,u,t-n} + \\epsilon_{k,u,t};$$ SVD_AR1(), $$\\alpha_{k,t} = \\phi \\alpha_{k,t-1} + \\epsilon_{k,t}$$ $$\\alpha_{k,u,t} = \\phi \\alpha_{k,u,t-1} + \\epsilon_{k,u,t};$$ SVD_RW(), $$\\alpha_{k,t} = \\alpha_{k,t-1} + \\epsilon_{k,t}$$ $$\\alpha_{k,u,t} = \\alpha_{k,u,t-1} + \\epsilon_{k,u,t};$$ SVD_RW2(), $$\\alpha_{k,t} = 2 \\alpha_{k,t-1} - \\alpha_{k,t-2} + \\epsilon_{k,t}$$ $$\\alpha_{k,u,t} = 2 \\alpha_{k,u,t-1} - \\alpha_{k,u,t-2} + \\epsilon_{k,u,t}.$$ \\(\\phi\\) \\(\\epsilon\\), see AR(), AR1(), RW(), RW2().","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD_AR.html","id":"scaled-svds-of-demographic-databases-in-bage","dir":"Reference","previous_headings":"","what":"Scaled SVDs of demographic databases in bage","title":"SVD Priors for Age, or Age and Sex/Gender, With Time-Varying Coefficients — SVD_AR","text":"HMD Mortality rates Human Mortality Database. LFP Labour forcce participation rates OECD.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD_AR.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"SVD Priors for Age, or Age and Sex/Gender, With Time-Varying Coefficients — SVD_AR","text":"details construction scaled SVDS see vignette .","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/SVD_AR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SVD Priors for Age, or Age and Sex/Gender, With Time-Varying Coefficients — SVD_AR","text":"","code":"SVD_AR1(HMD) #>   SVD_AR1(HMD)  #>     ssvd: HMD #>   n_comp: 3 #>      min: 0.8 #>      max: 0.98 #>        s: 1 #>    along: NULL SVD_RW(HMD, n_comp = 3) #>   SVD_RW(HMD)  #>     ssvd: HMD #>   n_comp: 3 #>        s: 1 SVD_RW2(HMD, indep = FALSE) #>   SVD_RW2(HMD,indep=FALSE)  #>     ssvd: HMD #>   n_comp: 3 #>    indep: FALSE #>        s: 1"},{"path":"https://bayesiandemography.github.io/bage/reference/Sp.html","id":null,"dir":"Reference","previous_headings":"","what":"P-Spline Prior — Sp","title":"P-Spline Prior — Sp","text":"p-spline (penalised spine) prior main effects interactions. Typically used age, can used variable outcomes expected vary smoothly one element next.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Sp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"P-Spline Prior — Sp","text":"","code":"Sp(n_comp = NULL, s = 1, along = NULL)"},{"path":"https://bayesiandemography.github.io/bage/reference/Sp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"P-Spline Prior — Sp","text":"n_comp Number spline basis functions (components) use. s Scale prior innovations. Default 1. along Name variable used \"along\" variable. used interactions.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Sp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"P-Spline Prior — Sp","text":"object class \"bage_prior_spline\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Sp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"P-Spline Prior — Sp","text":"Sp() used interaction, separate splines used \"along\" variable within combination \"\" variables.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Sp.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"P-Spline Prior — Sp","text":"Sp() used main effect, $$\\pmb{\\beta} = \\pmb{X} \\pmb{\\alpha}$$ used interaction, $$\\pmb{\\beta}_u = \\pmb{X} \\pmb{\\alpha}_u$$ \\(\\pmb{\\beta}\\) main effect interaction, \\(J\\) elements; \\(\\pmb{beta}_u\\) subvector \\(\\pmb{\\beta}\\) holding values  \\(u\\)th combination \"\" variables; \\(J\\) number elements \\(\\pmb{\\beta}\\); \\(U\\) number elements \\(\\pmb{\\beta}_u\\); \\(X\\) \\(J \\times n\\) \\(V \\times n\\) matrix spline basis functions; \\(n\\) n_comp. elements \\(\\pmb{\\alpha}\\) \\(\\pmb{alpha}_u\\) assumed follow random walk drift.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Sp.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"P-Spline Prior — Sp","text":"Eilers, P.H.C. Marx B. (1996). \"Flexible smoothing B-splines penalties\". Statistical Science. 11 (2): 89–121.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/Sp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"P-Spline Prior — Sp","text":"","code":"Sp() #>   Sp()  #>   n_comp: NULL #>        s: 1 #>    along: NULL Sp(n_comp = 10) #>   Sp(n_comp=10)  #>   n_comp: 10 #>        s: 1 #>    along: NULL"},{"path":"https://bayesiandemography.github.io/bage/reference/augment.bage_mod.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Data and Modelled Values — augment.bage_mod","title":"Extract Data and Modelled Values — augment.bage_mod","text":"Extract data values model object. return value consists original data one columns modelled values.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/augment.bage_mod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Data and Modelled Values — augment.bage_mod","text":"","code":"# S3 method for class 'bage_mod' augment(x, quiet = FALSE, ...)"},{"path":"https://bayesiandemography.github.io/bage/reference/augment.bage_mod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Data and Modelled Values — augment.bage_mod","text":"x object class \"bage_mod\". quiet Whether suppress messages. Default FALSE. ... Unused. Included generic consistency .","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/augment.bage_mod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Data and Modelled Values — augment.bage_mod","text":"tibble, original data plus following columns: .observed 'Direct' estimates rates probabilities, ie counts divided exposure size (Poisson binomial models.) .fitted Draws rates, probabilities, means. .expected Draws expected values rates probabilities (Poisson include exposure, binomial models.) Uncertain quantities represented using rvecs.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/augment.bage_mod.html","id":"fitted-vs-unfitted-models","dir":"Reference","previous_headings":"","what":"Fitted vs unfitted models","title":"Extract Data and Modelled Values — augment.bage_mod","text":"augment() typically called fitted model. case, modelled values draws joint posterior distribution rates, probabilities, means. augment() can, however, called unfitted model. case, modelled values draws joint prior distribution. words, modelled values informed model priors, exposure, size, weights arguments model, observed outcomes.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/augment.bage_mod.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Data and Modelled Values — augment.bage_mod","text":"","code":"## specify model mod <- mod_pois(injuries ~ age + sex + year,                 data = injuries,                 exposure = popn)  ## look at prior distribution mod |> augment() #> ℹ Model not fitted, so values drawn straight from prior distribution. #> # A tibble: 912 × 9 #>    age   sex    ethnicity  year             injuries  popn           .observed #>    <fct> <chr>  <chr>     <int>         <rdbl<1000>> <int>        <rdbl<1000>> #>  1 0-4   Female Maori      2000  22551 (28, 1859660) 35830  0.63 (0.00078, 52) #>  2 5-9   Female Maori      2000  22724 (34, 2290327) 35120  0.65 (0.00097, 65) #>  3 10-14 Female Maori      2000  19179 (35, 3753925) 32830  0.58 (0.0011, 114) #>  4 15-19 Female Maori      2000  16806 (21, 5084151) 27130 0.62 (0.00077, 187) #>  5 20-24 Female Maori      2000   12640 (7, 6635266) 24380 0.52 (0.00029, 272) #>  6 25-29 Female Maori      2000     13831 (4, 8e+06) 24160 0.57 (0.00016, 332) #>  7 30-34 Female Maori      2000   12724 (2, 6851652) 22560 0.56 (8.8e-05, 304) #>  8 35-39 Female Maori      2000   11911 (1, 1.4e+07) 22230 0.54 (4.5e-05, 613) #>  9 40-44 Female Maori      2000    9550 (1, 1.2e+07) 18130 0.53 (5.5e-05, 647) #> 10 45-49 Female Maori      2000 7794 (0.98, 1.1e+07) 13770 0.57 (7.1e-05, 796) #> # ℹ 902 more rows #> # ℹ 2 more variables: .fitted <rdbl<1000>>, .expected <rdbl<1000>>  ## fit model mod <- mod |>   fit()  ## look at posterior distribution mod |> augment() #> # A tibble: 912 × 9 #>    age   sex    ethnicity  year injuries  popn .observed #>    <fct> <chr>  <chr>     <int>    <int> <int>     <dbl> #>  1 0-4   Female Maori      2000       12 35830 0.000335  #>  2 5-9   Female Maori      2000        6 35120 0.000171  #>  3 10-14 Female Maori      2000        3 32830 0.0000914 #>  4 15-19 Female Maori      2000        6 27130 0.000221  #>  5 20-24 Female Maori      2000        6 24380 0.000246  #>  6 25-29 Female Maori      2000        6 24160 0.000248  #>  7 30-34 Female Maori      2000       12 22560 0.000532  #>  8 35-39 Female Maori      2000        3 22230 0.000135  #>  9 40-44 Female Maori      2000        6 18130 0.000331  #> 10 45-49 Female Maori      2000        6 13770 0.000436  #> # ℹ 902 more rows #> # ℹ 2 more variables: .fitted <rdbl<1000>>, .expected <rdbl<1000>>"},{"path":"https://bayesiandemography.github.io/bage/reference/bage-package.html","id":null,"dir":"Reference","previous_headings":"","what":"Package 'bage' — bage-package","title":"Package 'bage' — bage-package","text":"Bayesian estimation forecasting age-specific rates. Estimation uses TMB, fast.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/bage-package.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Package 'bage' — bage-package","text":"Specify model mod_pois() Specify Poisson model mod_binom() Specify binomial model mod_norm() Specify normal model set_prior() Specify prior main effect interaction priors List available priors main effects interactions set_disp() Specify prior dispersion/variance set_var_age() Identify age variable data set_var_sexgender() Identify sex gender variable data set_var_time() Identify time variable data Fit model fit() Derive posterior distribution is_fitted() See model fitted Extract results augment() Add cell-level estimates data components() Hyper-parameters tidy() One-line summary set_n_draw() Specify number posterior draws Forecast forecast() Use model obtain estimates future periods Check model replicate_data() Compare real simulated data report_sim() Simulation study model Data deaths Deaths Iceland divorces Divorces New Zealand expenditure Health expenditure Netherlands us_acc_deaths Accidental deaths USA HMD SVD mortality rates Human Mortality Database LFP SVD Labour Force Participation rates OECD","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/bage-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Package 'bage' — bage-package","text":"Maintainer: John Bryant john@bayesiandemography.com Authors: Junni Zhang junnizhang@163.com contributors: Bayesian Demography Limited [copyright holder]","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_mod.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Values for Hyper-Parameters — components.bage_mod","title":"Extract Values for Hyper-Parameters — components.bage_mod","text":"Extract values hyper-parameters model object. Includes values main effects interactions, values disperion variance terms.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_mod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Values for Hyper-Parameters — components.bage_mod","text":"","code":"# S3 method for class 'bage_mod' components(object, standardize = TRUE, quiet = FALSE, ...)"},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_mod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Values for Hyper-Parameters — components.bage_mod","text":"object bage_mod object, typically created mod_pois(), mod_binom(), mod_norm(). standardize Whether standardize parameter estimates. See details. Default TRUE. quiet Whether suppress messages. Default FALSE. ... Unused. Included generic consistency .","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_mod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Values for Hyper-Parameters — components.bage_mod","text":"tibble four columns columns: return value contains following columns: term Model term hyper-parameter belongs . component Component within term. level Element within component . .fitted rvec containing draws posterior distribution.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_mod.html","id":"fitted-vs-unfitted-models","dir":"Reference","previous_headings":"","what":"Fitted vs unfitted models","title":"Extract Values for Hyper-Parameters — components.bage_mod","text":"components() typically called fitted model. case, modelled values draws joint posterior distribution hyper-parameters model. components() can, however, called unfitted model. case, modelled values draws joint prior distribution. words, modelled values informed model priors, exposure, size, weights argument model, observed outcomes.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_mod.html","id":"standardizing-estimates","dir":"Reference","previous_headings":"","what":"Standardizing estimates","title":"Extract Values for Hyper-Parameters — components.bage_mod","text":"many models, sum intercept, main effects, interactions well-identified data, values intercept, main effects, interactions . instance, consider model containing lines $$y_i \\sim \\text{N}(\\mu_i, \\sigma^2)$$ $$\\mu_i = \\beta^{(0)} + \\beta_i^{(1)}.$$ add 1 \\(\\beta^{(0)}\\) subtract 1 \\(\\beta_i^{(1)}\\), \\(\\mu_i\\) unchanged, model's fit \\(y_i\\) unchanged. indeterminacy affect ability estimate \\(\\mu_i\\), complicate interpretation \\(\\beta^{(0)}\\) \\(\\beta_i^{(1)}\\). common strategy dealing poorly- identified intercepts, main effects, interactions post-process estimates, terms intercept, constrained sum zero. default, bage . description algorithm used bage, see vignette(\"vig2_math\"). unstandardized estimates, set standardize FALSE. Batches parameters, seasonal effects, structure main effects interactions problems indeterminacy. default, paramters also standardized.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_mod.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Values for Hyper-Parameters — components.bage_mod","text":"","code":"## specify model mod <- mod_pois(injuries ~ age + sex + year,                 data = injuries,                 exposure = popn)  ## extract prior distribution ## of hyper-parameters mod |>   components() #> ℹ Model not fitted, so values drawn straight from prior distribution. #> # A tibble: 37 × 4 #>    term        component level                   .fitted #>    <chr>       <chr>     <chr>              <rdbl<1000>> #>  1 (Intercept) effect    (Intercept)   -0.11 (-7.5, 7.3) #>  2 age         effect    0-4           0.019 (-3.6, 3.7) #>  3 age         effect    5-9           0.011 (-3.5, 3.2) #>  4 age         effect    10-14         0.00098 (-3, 2.6) #>  5 age         effect    15-19       -0.0039 (-2.9, 2.6) #>  6 age         effect    20-24       -0.0013 (-2.4, 2.5) #>  7 age         effect    25-29       0.00025 (-2.2, 2.3) #>  8 age         effect    30-34         -0.0017 (-2.3, 2) #>  9 age         effect    35-39       -0.0044 (-2.3, 2.1) #> 10 age         effect    40-44        -0.018 (-2.5, 2.5) #> # ℹ 27 more rows  ## fit model mod <- mod |>   fit()  ## extract posterior distribution ## of hyper-parameters mod |>   components() #> # A tibble: 37 × 4 #>    term        component level                    .fitted #>    <chr>       <chr>     <chr>               <rdbl<1000>> #>  1 (Intercept) effect    (Intercept)    -8.2 (-8.2, -8.2) #>  2 age         effect    0-4         -0.36 (-0.47, -0.25) #>  3 age         effect    5-9            -1.8 (-1.9, -1.6) #>  4 age         effect    10-14          -1.3 (-1.4, -1.2) #>  5 age         effect    15-19          0.47 (0.37, 0.56) #>  6 age         effect    20-24          0.56 (0.46, 0.66) #>  7 age         effect    25-29          0.46 (0.36, 0.55) #>  8 age         effect    30-34          0.41 (0.31, 0.51) #>  9 age         effect    35-39          0.34 (0.24, 0.45) #> 10 age         effect    40-44          0.34 (0.25, 0.45) #> # ℹ 27 more rows"},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_ssvd.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Components used by SVD Summary — components.bage_ssvd","title":"Extract Components used by SVD Summary — components.bage_ssvd","text":"Extract matrix offset used scaled SVD summary demographic database.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_ssvd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Components used by SVD Summary — components.bage_ssvd","text":"","code":"# S3 method for class 'bage_ssvd' components(object, n_comp = NULL, indep = NULL, age_labels = NULL, ...)"},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_ssvd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Components used by SVD Summary — components.bage_ssvd","text":"object object class \"bage_ssvd\". n_comp number components. default half total number components object. indep Whether use independent joint SVDs sex/gender. value supplied, SVD sex/gender dimension used. Note default different SVD(). age_labels Age labels desired age age-sex profile. labels supplied, detailed profile available used. ... currently used.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_ssvd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Components used by SVD Summary — components.bage_ssvd","text":"tibble offset components.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_ssvd.html","id":"scaled-svds-of-demographic-databases-in-bage","dir":"Reference","previous_headings":"","what":"Scaled SVDs of demographic databases in bage","title":"Extract Components used by SVD Summary — components.bage_ssvd","text":"HMD Mortality rates Human Mortality Database. LFP Labour forcce participation rates OECD.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_ssvd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Components used by SVD Summary — components.bage_ssvd","text":"","code":"## females and males combined components(LFP, n_comp = 3) #> # A tibble: 52 × 3 #>    component age    value #>    <fct>     <chr>  <dbl> #>  1 Offset    15-19 -0.839 #>  2 Offset    20-24  0.754 #>  3 Offset    25-29  1.46  #>  4 Offset    30-34  1.56  #>  5 Offset    35-39  1.63  #>  6 Offset    40-44  1.68  #>  7 Offset    45-49  1.58  #>  8 Offset    50-54  1.25  #>  9 Offset    55-59  0.645 #> 10 Offset    60-64 -0.398 #> # ℹ 42 more rows  ## females and males modelled independently components(LFP, indep = TRUE, n_comp = 3) #> # A tibble: 104 × 4 #>    component sex    age    value #>    <fct>     <chr>  <chr>  <dbl> #>  1 Offset    Female 15-19 -0.989 #>  2 Offset    Female 20-24  0.455 #>  3 Offset    Female 25-29  0.898 #>  4 Offset    Female 30-34  0.881 #>  5 Offset    Female 35-39  0.985 #>  6 Offset    Female 40-44  1.10  #>  7 Offset    Female 45-49  1.04  #>  8 Offset    Female 50-54  0.734 #>  9 Offset    Female 55-59  0.162 #> 10 Offset    Female 60-64 -0.857 #> # ℹ 94 more rows  ## joint model for females and males components(LFP, indep = FALSE, n_comp = 3) #> # A tibble: 104 × 4 #>    component sex    age    value #>    <fct>     <chr>  <chr>  <dbl> #>  1 Offset    Female 15-19 -1.00  #>  2 Offset    Female 20-24  0.481 #>  3 Offset    Female 25-29  0.890 #>  4 Offset    Female 30-34  0.851 #>  5 Offset    Female 35-39  0.965 #>  6 Offset    Female 40-44  1.09  #>  7 Offset    Female 45-49  1.05  #>  8 Offset    Female 50-54  0.747 #>  9 Offset    Female 55-59  0.171 #> 10 Offset    Female 60-64 -0.855 #> # ℹ 94 more rows  ## specify age groups labels <- poputils::age_labels(type = \"five\", min = 15, max = 60) components(LFP, age_labels = labels) #> # A tibble: 36 × 3 #>    component   age    value #>    <fct>       <chr>  <dbl> #>  1 Offset      15-19 -1.01  #>  2 Offset      20-24  0.736 #>  3 Offset      25-29  1.49  #>  4 Offset      30-34  1.64  #>  5 Offset      35-39  1.71  #>  6 Offset      40-44  1.74  #>  7 Offset      45-49  1.62  #>  8 Offset      50-54  1.28  #>  9 Offset      55-59  0.652 #> 10 Component 1 15-19 -0.281 #> # ℹ 26 more rows"},{"path":"https://bayesiandemography.github.io/bage/reference/deaths.html","id":null,"dir":"Reference","previous_headings":"","what":"Deaths in Iceland — deaths","title":"Deaths in Iceland — deaths","text":"Deaths mid-year populations Iceland, age, sex, calendar year.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/deaths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Deaths in Iceland — deaths","text":"","code":"deaths"},{"path":"https://bayesiandemography.github.io/bage/reference/deaths.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Deaths in Iceland — deaths","text":"tibble 5,300 rows following columns: age Single year age, \"105+\" sex \"Female\" \"Male\" time Calendar year, 1998-2022 deaths Counts deaths popn Mid-year population","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/deaths.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Deaths in Iceland — deaths","text":"Tables \"Deaths municipalities, sex age 1981-2022\", \"Average annual population municipality, age sex 1998-2022 - Current municipalities\", Statistics Iceland website. Data downloaded 12 July 2023.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/divorces.html","id":null,"dir":"Reference","previous_headings":"","what":"Divorces in New Zealand — divorces","title":"Divorces in New Zealand — divorces","text":"Counts divorces population, age, sex, calendar year, New Zealand, 1992-2021.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/divorces.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Divorces in New Zealand — divorces","text":"","code":"divorces"},{"path":"https://bayesiandemography.github.io/bage/reference/divorces.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Divorces in New Zealand — divorces","text":"tibble 660 rows following columns: age: 5-year age groups, \"15-19\" \"65+\" sex: \"Female\" \"Male\" time: Calendar year divorces: Numbers divorces year population: Person-years lived year","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/divorces.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Divorces in New Zealand — divorces","text":"Divorce counts data table \"Age divorces sex (marriages civil unions) (Annual-Dec)\" online database Infoshare Statistics New Zealand website. Data downloaded 22 March 2023. Population estimates derived data table \"Estimated Resident Population Age Sex (1991+) (Annual-Dec)\" online database Infoshare Statistics New Zealand website. Data downloaded 26 March 2023.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/expenditure.html","id":null,"dir":"Reference","previous_headings":"","what":"Per Capita Health Expenditure in the Netherlands, 2003-2011 — expenditure","title":"Per Capita Health Expenditure in the Netherlands, 2003-2011 — expenditure","text":"Per capita health expenditure, Euros, providers, diagnostic group, age group, year, Netherlands.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/expenditure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Per Capita Health Expenditure in the Netherlands, 2003-2011 — expenditure","text":"","code":"expenditure"},{"path":"https://bayesiandemography.github.io/bage/reference/expenditure.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Per Capita Health Expenditure in the Netherlands, 2003-2011 — expenditure","text":"tibble 1,296 rows following columns: diag Diagnostic group age 5-year age groups, open age group 85+ year 2003, 2005, 2007, 2011","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/expenditure.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Per Capita Health Expenditure in the Netherlands, 2003-2011 — expenditure","text":"Calculated data table \"Expenditure disease, age gender System Health Accounts (SHA) Framework : Current health spending age\" OECD database 'OECD.Stat' (downloaded 25 May 2016) table \"Historical population data projections (1950-2050)\" OECD database 'OECD.Stat' (downloaded 5 June 2016).","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/fit.bage_mod.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a model — fit.bage_mod","title":"Fit a model — fit.bage_mod","text":"Fit model","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/fit.bage_mod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a model — fit.bage_mod","text":"","code":"# S3 method for class 'bage_mod' fit(object, ...)"},{"path":"https://bayesiandemography.github.io/bage/reference/fit.bage_mod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a model — fit.bage_mod","text":"object bage_mod object, typically created mod_pois(), mod_binom(), mod_norm(). ... currently used.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/fit.bage_mod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a model — fit.bage_mod","text":"bage_mod object","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/fit.bage_mod.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit a model — fit.bage_mod","text":"","code":"## specify model mod <- mod_pois(injuries ~ age + sex + year,                 data = injuries,                 exposure = popn)  ## examine unfitted model mod #> -- Unfitted Poisson model -- #>  #>    injuries ~ age + sex + year #>  #> (Intercept) ~ NFix() #>         age ~ RW() #>         sex ~ NFix() #>        year ~ RW() #>  #>      dispersion: mean=1 #>        exposure: popn #>         var_age: age #>   var_sexgender: sex #>        var_time: year #>          n_draw: 1000  ## fit model mod <- fit(mod)  ## examine fitted model mod #> -- Fitted Poisson model -- #>  #>    injuries ~ age + sex + year #>  #> (Intercept) ~ NFix() #>         age ~ RW() #>         sex ~ NFix() #>        year ~ RW() #>  #>      dispersion: mean=1 #>        exposure: popn #>         var_age: age #>   var_sexgender: sex #>        var_time: year #>          n_draw: 1000  ## extract rates aug <- augment(mod) aug #> # A tibble: 912 × 9 #>    age   sex    ethnicity  year injuries  popn .observed #>    <fct> <chr>  <chr>     <int>    <int> <int>     <dbl> #>  1 0-4   Female Maori      2000       12 35830 0.000335  #>  2 5-9   Female Maori      2000        6 35120 0.000171  #>  3 10-14 Female Maori      2000        3 32830 0.0000914 #>  4 15-19 Female Maori      2000        6 27130 0.000221  #>  5 20-24 Female Maori      2000        6 24380 0.000246  #>  6 25-29 Female Maori      2000        6 24160 0.000248  #>  7 30-34 Female Maori      2000       12 22560 0.000532  #>  8 35-39 Female Maori      2000        3 22230 0.000135  #>  9 40-44 Female Maori      2000        6 18130 0.000331  #> 10 45-49 Female Maori      2000        6 13770 0.000436  #> # ℹ 902 more rows #> # ℹ 2 more variables: .fitted <rdbl<1000>>, .expected <rdbl<1000>>  ## extract hyper-parameters comp <- components(mod) comp #> # A tibble: 37 × 4 #>    term        component level                    .fitted #>    <chr>       <chr>     <chr>               <rdbl<1000>> #>  1 (Intercept) effect    (Intercept)    -8.2 (-8.2, -8.2) #>  2 age         effect    0-4         -0.36 (-0.48, -0.25) #>  3 age         effect    5-9            -1.8 (-1.9, -1.6) #>  4 age         effect    10-14          -1.3 (-1.4, -1.2) #>  5 age         effect    15-19          0.46 (0.37, 0.56) #>  6 age         effect    20-24          0.57 (0.47, 0.66) #>  7 age         effect    25-29          0.46 (0.36, 0.55) #>  8 age         effect    30-34           0.41 (0.3, 0.51) #>  9 age         effect    35-39          0.34 (0.24, 0.44) #> 10 age         effect    40-44          0.35 (0.25, 0.46) #> # ℹ 27 more rows"},{"path":"https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.html","id":null,"dir":"Reference","previous_headings":"","what":"Use a Model to Make a Forecast — forecast.bage_mod","title":"Use a Model to Make a Forecast — forecast.bage_mod","text":"Forecast rates, probabilities, means, model parameters.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use a Model to Make a Forecast — forecast.bage_mod","text":"","code":"# S3 method for class 'bage_mod' forecast(   object,   output = c(\"augment\", \"components\"),   include_estimates = FALSE,   standardize = TRUE,   labels,   ... )"},{"path":"https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use a Model to Make a Forecast — forecast.bage_mod","text":"object bage_mod object, typically created mod_pois(), mod_binom(), mod_norm(). output Type output returned include_estimates Whether include historical estimates along forecasts. Default FALSE. standardize Whether standardize parameter estimates. See details. Default TRUE. labels Labels future values. ... currently used.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Use a Model to Make a Forecast — forecast.bage_mod","text":"tibble.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.html","id":"how-the-forecasts-are-constructed","dir":"Reference","previous_headings":"","what":"How the forecasts are constructed","title":"Use a Model to Make a Forecast — forecast.bage_mod","text":"Internally, steps involved forecast : Forecast time-varying main effects interactions, e.g. time main effect, age-time interaction. Combine forecasts time-varying main effects interactions non-time-varying parameters, e.g. age effects dispersion. Use combined parameters generate values rates, probabilities means. See LINK VIGNETTE details.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.html","id":"output","dir":"Reference","previous_headings":"","what":"Output","title":"Use a Model to Make a Forecast — forecast.bage_mod","text":"output \"augment\" (default), return value forecast() looks like output function augment(). output \"components\", return value looks like output components(). include_estimates FALSE (default), output forecast() excludes values time-varying parameters period covered data. include_estimates TRUE, output includes values. Setting include_estimates TRUE can helpful creating graphs combine estimates forecasts.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.html","id":"standardization","dir":"Reference","previous_headings":"","what":"Standardization","title":"Use a Model to Make a Forecast — forecast.bage_mod","text":"TODO - Write ","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.html","id":"using-data-in-forecasts","dir":"Reference","previous_headings":"","what":"Using data in forecasts","title":"Use a Model to Make a Forecast — forecast.bage_mod","text":"forecast() typically used fitted model, .e. model parameter values estimated data. resulting forecasts reflect data priors. forecast() can, however, used unfitted model. case, forecasts based entirely priors. See example. Experimenting forecasts based entirely priors can helpful designing model. See LINK WORKFLOW VIGNETTE details.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.html","id":"warning","dir":"Reference","previous_headings":"","what":"Warning","title":"Use a Model to Make a Forecast — forecast.bage_mod","text":"interface forecast() finalised.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Use a Model to Make a Forecast — forecast.bage_mod","text":"","code":"## specify and fit model mod <- mod_pois(injuries ~ age * sex + ethnicity + year,                 data = injuries,                 exposure = popn) |>   fit(mod) mod #> -- Fitted Poisson model -- #>  #>    injuries ~ age * sex + ethnicity + year #>  #> (Intercept) ~ NFix() #>         age ~ RW() #>         sex ~ NFix() #>   ethnicity ~ NFix() #>        year ~ RW() #>     age:sex ~ RW() #>  #>      dispersion: mean=1 #>        exposure: popn #>         var_age: age #>   var_sexgender: sex #>        var_time: year #>          n_draw: 1000  ## forecasts mod |>   forecast(labels = 2019:2024) #> # A tibble: 288 × 9 #>    age   sex    ethnicity  year injuries  popn .observed #>    <fct> <chr>  <chr>     <int>    <int> <int>     <dbl> #>  1 0-4   Female Maori      2019       NA    NA        NA #>  2 0-4   Female Maori      2020       NA    NA        NA #>  3 0-4   Female Maori      2021       NA    NA        NA #>  4 0-4   Female Maori      2022       NA    NA        NA #>  5 0-4   Female Maori      2023       NA    NA        NA #>  6 0-4   Female Maori      2024       NA    NA        NA #>  7 0-4   Female Non Maori  2019       NA    NA        NA #>  8 0-4   Female Non Maori  2020       NA    NA        NA #>  9 0-4   Female Non Maori  2021       NA    NA        NA #> 10 0-4   Female Non Maori  2022       NA    NA        NA #> # ℹ 278 more rows #> # ℹ 2 more variables: .fitted <rdbl<1000>>, .expected <rdbl<1000>>  ## combined estimates and forecasts mod |>   forecast(labels = 2019:2024,            include_estimates = TRUE) #> # A tibble: 1,200 × 9 #>    age   sex    ethnicity  year injuries  popn .observed #>    <fct> <chr>  <chr>     <int>    <int> <int>     <dbl> #>  1 0-4   Female Maori      2000       12 35830 0.000335  #>  2 5-9   Female Maori      2000        6 35120 0.000171  #>  3 10-14 Female Maori      2000        3 32830 0.0000914 #>  4 15-19 Female Maori      2000        6 27130 0.000221  #>  5 20-24 Female Maori      2000        6 24380 0.000246  #>  6 25-29 Female Maori      2000        6 24160 0.000248  #>  7 30-34 Female Maori      2000       12 22560 0.000532  #>  8 35-39 Female Maori      2000        3 22230 0.000135  #>  9 40-44 Female Maori      2000        6 18130 0.000331  #> 10 45-49 Female Maori      2000        6 13770 0.000436  #> # ℹ 1,190 more rows #> # ℹ 2 more variables: .fitted <rdbl<1000>>, .expected <rdbl<1000>>  ## hyper-parameters mod |>   forecast(labels = 2019:2024,            output = \"components\") #> # A tibble: 6 × 4 #>   term  component level               .fitted #>   <chr> <chr>     <chr>          <rdbl<1000>> #> 1 year  effect    2019   -0.095 (-0.2, 0.022) #> 2 year  effect    2020  -0.095 (-0.24, 0.051) #> 3 year  effect    2021  -0.096 (-0.27, 0.083) #> 4 year  effect    2022     -0.1 (-0.29, 0.11) #> 5 year  effect    2023   -0.099 (-0.31, 0.14) #> 6 year  effect    2024   -0.094 (-0.34, 0.15)  ## forecast based on priors only mod_unfitted <- mod_pois(injuries ~ age * sex + ethnicity + year,                          data = injuries,                          exposure = popn) mod_unfitted |>   forecast(labels = 2019:2024) #> ℹ Model not fitted, so values drawn straight from prior distribution. #> # A tibble: 288 × 9 #>    age   sex    ethnicity  year injuries  popn .observed               .fitted #>    <fct> <chr>  <chr>     <int>    <int> <int>     <dbl>          <rdbl<1000>> #>  1 0-4   Female Maori      2019       NA    NA        NA 0.56 (7.2e-06, 16475) #>  2 0-4   Female Maori      2020       NA    NA        NA 0.49 (1.9e-05, 18877) #>  3 0-4   Female Maori      2021       NA    NA        NA 0.53 (7.9e-06, 52802) #>  4 0-4   Female Maori      2022       NA    NA        NA 0.51 (3.8e-06, 88882) #>  5 0-4   Female Maori      2023       NA    NA        NA   0.49 (1e-05, 65947) #>  6 0-4   Female Maori      2024       NA    NA        NA 0.57 (4.4e-06, 65858) #>  7 0-4   Female Non Maori  2019       NA    NA        NA 0.56 (6.3e-06, 14505) #>  8 0-4   Female Non Maori  2020       NA    NA        NA 0.68 (5.6e-06, 18252) #>  9 0-4   Female Non Maori  2021       NA    NA        NA   0.52 (6e-06, 26505) #> 10 0-4   Female Non Maori  2022       NA    NA        NA 0.52 (3.9e-06, 52483) #> # ℹ 278 more rows #> # ℹ 1 more variable: .expected <rdbl<1000>>"},{"path":"https://bayesiandemography.github.io/bage/reference/generate.bage_ssvd.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Random Age or Age-Sex Profiles — generate.bage_ssvd","title":"Generate Random Age or Age-Sex Profiles — generate.bage_ssvd","text":"Generate random age age-sex profiles object class \"bage_ssvd\". object class \"bage_ssvd\" holds results SVD decomposition demographic data.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/generate.bage_ssvd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Random Age or Age-Sex Profiles — generate.bage_ssvd","text":"","code":"# S3 method for class 'bage_ssvd' generate(x, n_draw = 20, n_comp = NULL, indep = NULL, age_labels = NULL, ...)"},{"path":"https://bayesiandemography.github.io/bage/reference/generate.bage_ssvd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Random Age or Age-Sex Profiles — generate.bage_ssvd","text":"x object class \"bage_ssvd\". n_draw Number random draws generate. n_comp number components. default half total number components object. indep Whether use independent joint SVDs sex/gender. value supplied, SVD sex/gender dimension used. Note default different SVD(). age_labels Age labels desired age age-sex profile. labels supplied, detailed profile available used. ... currently used.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/generate.bage_ssvd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Random Age or Age-Sex Profiles — generate.bage_ssvd","text":"tibble","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/generate.bage_ssvd.html","id":"scaled-svds-of-demographic-databases-in-bage","dir":"Reference","previous_headings":"","what":"Scaled SVDs of demographic databases in bage","title":"Generate Random Age or Age-Sex Profiles — generate.bage_ssvd","text":"HMD Mortality rates Human Mortality Database. LFP Labour forcce participation rates OECD.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/generate.bage_ssvd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate Random Age or Age-Sex Profiles — generate.bage_ssvd","text":"","code":"## SVD for females and males combined generate(HMD) #> # A tibble: 2,220 × 3 #>     draw age   value #>    <int> <chr> <dbl> #>  1     1 0     -2.05 #>  2     1 1     -3.55 #>  3     1 2     -4.01 #>  4     1 3     -4.26 #>  5     1 4     -4.45 #>  6     1 5     -4.60 #>  7     1 6     -4.72 #>  8     1 7     -4.83 #>  9     1 8     -4.93 #> 10     1 9     -5.02 #> # ℹ 2,210 more rows  ## separate SVDs for females and males generate(HMD, indep = TRUE)  #> # A tibble: 4,440 × 4 #>     draw sexgender age   value #>    <int> <chr>     <chr> <dbl> #>  1     1 Female    0     -3.43 #>  2     1 Female    1     -5.10 #>  3     1 Female    2     -5.58 #>  4     1 Female    3     -5.84 #>  5     1 Female    4     -6.02 #>  6     1 Female    5     -6.16 #>  7     1 Female    6     -6.26 #>  8     1 Female    7     -6.37 #>  9     1 Female    8     -6.45 #> 10     1 Female    9     -6.51 #> # ℹ 4,430 more rows  ## specify age groups labels <- poputils::age_labels(type = \"lt\", max = 60) generate(HMD, age_labels = labels) #> # A tibble: 280 × 3 #>     draw age   value #>    <int> <chr> <dbl> #>  1     1 0     -3.05 #>  2     1 1-4   -5.69 #>  3     1 5-9   -6.87 #>  4     1 10-14 -7.19 #>  5     1 15-19 -6.63 #>  6     1 20-24 -6.30 #>  7     1 25-29 -6.22 #>  8     1 30-34 -6.06 #>  9     1 35-39 -5.80 #> 10     1 40-44 -5.50 #> # ℹ 270 more rows"},{"path":"https://bayesiandemography.github.io/bage/reference/households.html","id":null,"dir":"Reference","previous_headings":"","what":"People in One-person households in New Zealand — households","title":"People in One-person households in New Zealand — households","text":"Counts people one-person households, counts people living household, age, region, year.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/households.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"People in One-person households in New Zealand — households","text":"","code":"households"},{"path":"https://bayesiandemography.github.io/bage/reference/households.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"People in One-person households in New Zealand — households","text":"tibble 528 rows following columns: age: 5-year age groups, open age group 65+ region: Region within New Zealand year: Calendar year oneperson: Count people living one-person households total: Count people living types household","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/households.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"People in One-person households in New Zealand — households","text":"Derived data table \"Household composition age group, people households occupied private dwellings, 2006, 2013, 2018 Censuses (RC, TA, DHB, SA2)\" online database NZ.Stat, Statistics New Zealand website. Data downloaded 3 January 2023.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/injuries.html","id":null,"dir":"Reference","previous_headings":"","what":"Fatal Injuries in New Zealand — injuries","title":"Fatal Injuries in New Zealand — injuries","text":"Counts fatal injuries New Zealand, age, sex, ethnicity, year, plus estimates population risk.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/injuries.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fatal Injuries in New Zealand — injuries","text":"","code":"injuries"},{"path":"https://bayesiandemography.github.io/bage/reference/injuries.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Fatal Injuries in New Zealand — injuries","text":"tibble 912 rows following columns: age: 5-year age groups, age 55-59 sex: \"Female\" \"Male\" ethnicity: \"Maori\" \"Non Maori\" year: Calendar year injuries: Count injuries, randomly rounded base 3 popn: Population 30 June","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/injuries.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Fatal Injuries in New Zealand — injuries","text":"Derived data tables \"Estimated Resident Population Age Sex (1991+) (Annual-Jun)\" \"Maori Ethnic Group Estimated Resident Population Age Sex (1991+) (Annual-Jun)\" online database Infoshare, table \"Count fatal serious non-fatal injuries sex, age group, ethnicity, cause, severity injury, 2000-2021\" online database NZ.Stat, Statistics New Zealand website. Data downloaded 1 January 2023.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/is_fitted.html","id":null,"dir":"Reference","previous_headings":"","what":"Test Whether a Model has Been Fitted — is_fitted","title":"Test Whether a Model has Been Fitted — is_fitted","text":"Test whether fit() called model object.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/is_fitted.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test Whether a Model has Been Fitted — is_fitted","text":"","code":"is_fitted(x)"},{"path":"https://bayesiandemography.github.io/bage/reference/is_fitted.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test Whether a Model has Been Fitted — is_fitted","text":"x object class \"bage_mod\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/is_fitted.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Test Whether a Model has Been Fitted — is_fitted","text":"TRUE FALSE","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/is_fitted.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Test Whether a Model has Been Fitted — is_fitted","text":"","code":"mod <- mod_pois(injuries ~ age + sex + year,                 data = injuries,                 exposure = popn) is_fitted(mod) #> [1] FALSE mod <- fit(mod) is_fitted(mod) #> [1] TRUE"},{"path":"https://bayesiandemography.github.io/bage/reference/mod_binom.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify a Binomial Model — mod_binom","title":"Specify a Binomial Model — mod_binom","text":"Specify model outcome drawn binomial distribution.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_binom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify a Binomial Model — mod_binom","text":"","code":"mod_binom(formula, data, size)"},{"path":"https://bayesiandemography.github.io/bage/reference/mod_binom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify a Binomial Model — mod_binom","text":"formula R formula, specifying outcome predictors. data data frame containing outcome predictor variables, number trials. size Name variable giving number trials, formula.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_binom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify a Binomial Model — mod_binom","text":"object class bage_mod.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_binom.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify a Binomial Model — mod_binom","text":"model hierarchical. probabilities binomial distribution described prior model formed dimensions age, sex, time. terms dimension models, described priors. priors defaults, depend type term (eg intercept, age main effect, age-time interaction.)","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_binom.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Specify a Binomial Model — mod_binom","text":"likelihood $$y_i \\sim \\text{binomial}(\\gamma_i; w_i)$$ \\(y_i\\) count, number births, combination \\(\\) classifying variables, age, sex, region; \\(\\gamma_i\\) probability 'success'; \\(w_i\\) number trials. probabilities \\(\\gamma_i\\) assumed drawn beta distribution $$y_i \\sim \\text{Beta}(\\xi^{-1} \\mu_i, \\xi^{-1} (1 - \\mu_i))$$ \\(\\mu_i\\) expected value \\(\\gamma_i\\); \\(\\xi\\) governs dispersion (ie variance.) expected values \\(\\mu_i\\) equal, logit scale, sum terms formed classifying variables, $$\\text{logit} \\mu_i = \\sum_{m=0}^{M} \\beta_{j_i^m}^{(m)}$$ \\(\\beta^{0}\\) intercept; \\(\\beta^{(m)}\\), \\(m = 1, \\dots, M\\), main effect interaction; \\(j_i^m\\) element \\(\\beta^{(m)}\\) associated cell \\(\\). \\(\\beta^{(m)}\\) given priors, described priors. prior \\(\\xi\\) described set_disp().","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_binom.html","id":"specifying-size","dir":"Reference","previous_headings":"","what":"Specifying size","title":"Specify a Binomial Model — mod_binom","text":"size argument can take two forms: name variable data, without quote marks, eg \"population\" population; formula, evaluated data environment (see example).","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/mod_binom.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify a Binomial Model — mod_binom","text":"","code":"mod <- mod_binom(oneperson ~ age:region + age:year,                  data = households,                  size = total)  ## use formula to specify size mod <- mod_binom(ncases ~ agegp + tobgp + alcgp,                  data = esoph,                  size = ~ ncases + ncontrols)"},{"path":"https://bayesiandemography.github.io/bage/reference/mod_norm.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify a Normal Model — mod_norm","title":"Specify a Normal Model — mod_norm","text":"model hierarchical. means normal distribution described prior model formed dimensions age, sex, time. terms dimension models, described priors. priors defaults, depend type term (eg intercept, age main effect, age-time interaction.) Internally, outcome variable scaled mean 0 sd 1.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_norm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify a Normal Model — mod_norm","text":"","code":"mod_norm(formula, data, weights)"},{"path":"https://bayesiandemography.github.io/bage/reference/mod_norm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify a Normal Model — mod_norm","text":"formula R formula, specifying outcome predictors. data data frame containing outcome, predictor, , optionally, weights variables. weights Name weights variable, 1, formula. See details.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_norm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify a Normal Model — mod_norm","text":"object class bage_mod_norm.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_norm.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Specify a Normal Model — mod_norm","text":"likelihood $$y_i \\sim \\text{N}(\\mu_i, \\xi^2 / w_i)$$ \\(y_i\\) scaled value , log income, combination \\(\\) classifying variables, age, sex, region; \\(\\mu_i\\) mean; \\(\\xi\\) standard deviation parameter; \\(w_i\\) weight. scaling outcome variable done internally. \\(y_i^*\\) original, \\(y_i = (y_i^* - m)/s\\) \\(m\\) \\(s\\) sample mean standard deviation \\(y_i^*\\). applications, \\(w_i\\) set 1 \\(\\). means \\(\\mu_i\\) equal sum terms formed classifying variables, $$\\mu_i = \\sum_{m=0}^{M} \\beta_{j_i^m}^{(m)}$$ \\(\\beta^{0}\\) intercept; \\(\\beta^{(m)}\\), \\(m = 1, \\dots, M\\), main effect interaction; \\(j_i^m\\) element \\(\\beta^{(m)}\\) associated cell \\(\\). \\(\\beta^{(m)}\\) given priors, described priors. prior \\(\\xi\\) described set_disp().","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_norm.html","id":"specifying-weights","dir":"Reference","previous_headings":"","what":"Specifying weights","title":"Specify a Normal Model — mod_norm","text":"weights argument can take three forms: name variable data, without quote marks, eg \"wt\" wt; number 1, weights used; formula, evaluated data environment (see example).","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/mod_norm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify a Normal Model — mod_norm","text":"","code":"mod <- mod_norm(value ~ diag:age + year,                 data = expenditure,                 weights = 1)  ## use formula to specify weights mod <- mod_norm(value ~ diag:age + year,                 data = expenditure,                 weights = ~sqrt(value))"},{"path":"https://bayesiandemography.github.io/bage/reference/mod_pois.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify a Poisson Model — mod_pois","title":"Specify a Poisson Model — mod_pois","text":"Specify model outcome drawn Poisson distribution.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_pois.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify a Poisson Model — mod_pois","text":"","code":"mod_pois(formula, data, exposure)"},{"path":"https://bayesiandemography.github.io/bage/reference/mod_pois.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify a Poisson Model — mod_pois","text":"formula R formula, specifying outcome predictors. data data frame containing outcome, predictor, , optionally, exposure variables. exposure Name exposure variable, 1, formula. See details.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_pois.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify a Poisson Model — mod_pois","text":"object class bage_mod_pois.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_pois.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify a Poisson Model — mod_pois","text":"model hierarchical. rates Poisson distribution described prior model formed dimensions age, sex, time. terms dimension models, described priors. priors defaults, depend type term (eg intercept, age main effect, age-time interaction.)","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_pois.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Specify a Poisson Model — mod_pois","text":"likelihood $$y_i \\sim \\text{Poisson}(\\gamma_i w_i)$$ subscript \\(\\) identifies combination classifying variables, age, sex, time; \\(y_i\\) outcome, deaths; \\(\\gamma_i\\) rates; \\(w_i\\) exposure. applications, obvious population risk. cases, exposure \\(w_i\\) can set 1 \\(\\). rates \\(\\gamma_i\\) assumed drawn gamma distribution $$y_i \\sim \\text{Gamma}(\\xi^{-1}, (\\xi \\mu_i)^{-1})$$ \\(\\mu_i\\) expected value \\(\\gamma_i\\); \\(\\xi\\) governs dispersion (ie variance.) expected values \\(\\mu_i\\) equal, log scale, sum terms formed classifying variables, $$\\log \\mu_i = \\sum_{m=0}^{M} \\beta_{j_i^m}^{(m)}$$ \\(\\beta^{0}\\) intercept; \\(\\beta^{(m)}\\), \\(m = 1, \\dots, M\\), main effect interaction; \\(j_i^m\\) element \\(\\beta^{(m)}\\) associated cell \\(\\). \\(\\beta^{(m)}\\) given priors, described priors. prior \\(\\xi\\) described set_disp().","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_pois.html","id":"specifying-exposure","dir":"Reference","previous_headings":"","what":"Specifying exposure","title":"Specify a Poisson Model — mod_pois","text":"exposure argument can take three forms: name variable data, without quote marks, eg \"population\" population; number 1, case pure \"counts\" model exposure, produced; formula, evaluated data environment (see example).","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/mod_pois.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify a Poisson Model — mod_pois","text":"","code":"## specify a model with exposure mod <- mod_pois(injuries ~ age:sex + ethnicity + year,                 data = injuries,                 exposure = popn)  ## specify a model without exposure mod <- mod_pois(injuries ~ age:sex + ethnicity + year,                 data = injuries,                 exposure = 1)  ## use a formula to specify exposure mod <- mod_pois(injuries ~ age:sex + ethnicity + year,                 data = injuries,                 exposure = ~ pmax(popn, 1))"},{"path":"https://bayesiandemography.github.io/bage/reference/priors.html","id":null,"dir":"Reference","previous_headings":"","what":"Priors for Intercept, Main Effects, Interactions — priors","title":"Priors for Intercept, Main Effects, Interactions — priors","text":"models rates, probabilities, means created functions mod_pois(), mod_binom(), mod_norm() always include intercept, typically include main effects, interactions. models, instance include age effect, many include interaction age sex/gender, age time.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/priors.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Priors for Intercept, Main Effects, Interactions — priors","text":"intercept, main effects, interactions prior models capture expected behavior term. Current choices prior models summarised . Priors links help implemented. Priors without links next queue implementation.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. generics augment, components, equation, fit, forecast, generate, tidy","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/replicate_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Draw from the Prior Predictive Distribution of a Model — replicate_data","title":"Draw from the Prior Predictive Distribution of a Model — replicate_data","text":"Draw prior predictive distribution model, .e., Create Replicate Data","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/replicate_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Draw from the Prior Predictive Distribution of a Model — replicate_data","text":"","code":"replicate_data(x, condition_on = NULL, n = 19)"},{"path":"https://bayesiandemography.github.io/bage/reference/replicate_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Draw from the Prior Predictive Distribution of a Model — replicate_data","text":"x fitted model, typically created calling mod_pois(), mod_binom(), mod_norm(), fit(). condition_on Parameters condition . Either \"meanpar\" \"par\". See details. n Number replicate datasets create. Default 19.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/replicate_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Draw from the Prior Predictive Distribution of a Model — replicate_data","text":"tibble following structure:","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/replicate_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Draw from the Prior Predictive Distribution of a Model — replicate_data","text":"Use fitted model create replicate datasets, typically way checking model. Use n draws posterior distribution model parameters generate n simulated datasets. model working well, simulated datasets look similar actual dataset.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/replicate_data.html","id":"","dir":"Reference","previous_headings":"","what":"Draw from the Prior Predictive Distribution of a Model — replicate_data","title":"Draw from the Prior Predictive Distribution of a Model — replicate_data","text":"condition_on argument Poisson binomial models include dispersion terms (default), two options constructing replicate data. condition_on \"par\", replicate data created () drawing values posterior distribution rates probabilities (\\(\\gamma_i\\) defined mod_pois() mod_binom()), (ii)  conditional rates probabilities, drawing values outcome variable. condition_on \"meanpar\", replicate data created () drawing values hyper-parameters governing rates probabilities (\\(\\mu_i\\) \\(\\xi\\) defined mod_pois() mod_binom()), (ii) conditional hyper-parameters, drawing values rates probabilties, finally (iii) conditional rates probabilities, drawing values outcome variable. default condition_on \"meanpar\". \"meanpar\" option provides severe test model \"par\" option, since \"par\" values weighted averages \"meanpar\" values original data. described mod_norm(), normal models slightly different structure Poisson binomial models, distinction \"par\" \"meanpar\" apply.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/replicate_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Draw from the Prior Predictive Distribution of a Model — replicate_data","text":"","code":"mod <- mod_pois(injuries ~ age:sex + ethnicity + year,                 data = injuries,                 exposure = 1) |>   fit()  rep_data <- mod |>   replicate_data()  library(dplyr) #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union rep_data |>   group_by(.replicate) |>   count(wt = injuries) #> # A tibble: 20 × 2 #> # Groups:   .replicate [20] #>    .replicate       n #>    <fct>        <dbl> #>  1 Original     21588 #>  2 Replicate 1  21146 #>  3 Replicate 2  21224 #>  4 Replicate 3  21413 #>  5 Replicate 4  21110 #>  6 Replicate 5  21303 #>  7 Replicate 6  21806 #>  8 Replicate 7  21056 #>  9 Replicate 8  21478 #> 10 Replicate 9  20827 #> 11 Replicate 10 20663 #> 12 Replicate 11 21599 #> 13 Replicate 12 20769 #> 14 Replicate 13 21343 #> 15 Replicate 14 21419 #> 16 Replicate 15 21874 #> 17 Replicate 16 20719 #> 18 Replicate 17 20291 #> 19 Replicate 18 21139 #> 20 Replicate 19 21576"},{"path":"https://bayesiandemography.github.io/bage/reference/report_sim.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulation study of a model — report_sim","title":"Simulation study of a model — report_sim","text":"Use simulated data assess performance estimation model.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/report_sim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulation study of a model — report_sim","text":"","code":"report_sim(   mod_est,   mod_sim = NULL,   n_sim = 100,   point_est_fun = c(\"median\", \"mean\"),   widths = c(0.5, 0.95),   report_type = c(\"short\", \"long\", \"full\"),   n_core = 1 )"},{"path":"https://bayesiandemography.github.io/bage/reference/report_sim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulation study of a model — report_sim","text":"mod_est model whose performance assessed. object class bage_mod. mod_sim model used generate simulated data. value supplied, mod_est used. n_sim Number sets simulated data use. Default 100. point_est_fun Name function use calculate point estimates. options \"mean\" \"median\". default \"mean\". widths Widths credible intervals. vector values interval (0, 1]. Default c(0.5, 0.95). report_type Amount detail return value. Options \"short\" \"long\". Default \"short\". n_core Number cores use parallel processing. n_core 1 (default), parallel processing done.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/report_sim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulation study of a model — report_sim","text":"report_type \"short\" tibble following columns: component. Part model. See Details. \"par\" rate, probability, mean parameter likelihood. vals_sim. Simulated value parameter, averaged across simulations cells. error_point_est. Point estimate minus simulation-true value, averaged across simulations cells. cover. Actual proportion simulation-true values fall within type interval, averaged across simulations cells. report_type \"long\" tibble following columns: component. Part model. See components(). \"par\" rate, probability, mean parameter likelihood. term. Category within component. level. Category within term. vals_sim. Simulated values parameter, stored rvec. error_point_est. Point estimates minus simulation-true values, stored rvec. cover. Actual proportions simulation-true values falling within type interval, stored rvec.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/report_sim.html","id":"comparisons-included-in-report","dir":"Reference","previous_headings":"","what":"Comparisons included in report","title":"Simulation study of a model — report_sim","text":"mod_est mod_sim identical, report produced report_sim() following components: \"hyper\" Hyper-parameters priors intercept, main effects, interactions. \"effect\" Intercept, main effects, interactions. \"meanpar\" Expected value rates probabilities. Poisson binomial models . \"disp\" Dispersion term, included model. \"par\" Rates, probabilities, means. mod_est mod_sim differ, report omits \"hyper\", \"effect\", since, model specifications, terms comparable across models.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/report_sim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulation study of a model — report_sim","text":"","code":"## results random, so set seed set.seed(0)  ## make data - outcome variable (deaths here) ## needs to be present, but is not used data <- data.frame(region = c(\"A\", \"B\", \"C\", \"D\", \"E\"),                    population = c(100, 200, 300, 400, 500),                    deaths = NA)  ## simulation with estimation model same as ## data-generating model mod_est <- mod_pois(deaths ~ region,                     data = data,                     exposure = population) |>   set_prior(`(Intercept)` ~ Known(0)) report_sim(mod_est = mod_est,            n_sim = 10) ## in practice should use larger value #> $components #> # A tibble: 4 × 7 #>   term        component    .error .cover_50 .cover_95 .length_50 .length_95 #>   <chr>       <chr>         <dbl>     <dbl>     <dbl>      <dbl>      <dbl> #> 1 (Intercept) effect     0.0857        0.8        1        0.465       1.39 #> 2 region      effect    -0.000536      0.66       1        0.933       2.67 #> 3 region      hyper      0.0219        0.3        0.9      0.606       1.96 #> 4 disp        disp      -0.336         0.6        1        0.882       3.16 #>  #> $augment #> # A tibble: 2 × 7 #>   .var      .observed   .error .cover_50 .cover_95 .length_50 .length_95 #>   <chr>         <dbl>    <dbl>     <dbl>     <dbl>      <dbl>      <dbl> #> 1 .fitted        1.63 -0.00223      0.54      0.94     0.0784      0.229 #> 2 .expected      1.63 -0.262        0.6       1        1.26        4.93  #>   ## simulation with estimation model different ## from data-generating model mod_sim <- mod_est |>   set_prior(region ~ N(s = 2)) report_sim(mod_est = mod_est,            mod_sim = mod_sim,            n_sim = 10) #> $components #> # A tibble: 4 × 7 #>   term        component   .error .cover_50 .cover_95 .length_50 .length_95 #>   <chr>       <chr>        <dbl>     <dbl>     <dbl>      <dbl>      <dbl> #> 1 (Intercept) effect     0.282        0.8        0.9      0.610       1.83 #> 2 region      effect    -0.00325      0.62       1        1.20        3.42 #> 3 region      hyper     -0.500        0.2        0.8      0.666       2.08 #> 4 disp        disp      -0.0676       0.5        0.8      1.09        3.83 #>  #> $augment #> # A tibble: 2 × 7 #>   .var      .observed   .error .cover_50 .cover_95 .length_50 .length_95 #>   <chr>         <dbl>    <dbl>     <dbl>     <dbl>      <dbl>      <dbl> #> 1 .fitted        12.3 -0.00320      0.54      0.96      0.113      0.331 #> 2 .expected      12.3 -6.30         0.5       0.96      6.13      24.2   #>"},{"path":"https://bayesiandemography.github.io/bage/reference/set_disp.html","id":null,"dir":"Reference","previous_headings":"","what":"Set Mean in Prior for Dispersion or Standard Deviation — set_disp","title":"Set Mean in Prior for Dispersion or Standard Deviation — set_disp","text":"Specify mean prior dispersion parameter (Poisson binomial models) standard deviation parameter (normal models.)","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_disp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set Mean in Prior for Dispersion or Standard Deviation — set_disp","text":"","code":"set_disp(mod, mean)"},{"path":"https://bayesiandemography.github.io/bage/reference/set_disp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set Mean in Prior for Dispersion or Standard Deviation — set_disp","text":"mod bage_mod object, typically created mod_pois(), mod_binom(), mod_norm(). mean Mean value expoential prior. Poisson binomial models, can set 0.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_disp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set Mean in Prior for Dispersion or Standard Deviation — set_disp","text":"bage_mod object","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_disp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Set Mean in Prior for Dispersion or Standard Deviation — set_disp","text":"dispersion mean parameter exponential distribution mean \\(\\mu\\). $$p(\\xi) = \\frac{1}{\\mu}\\exp\\left(\\frac{-\\xi}{\\mu}\\right)$$ Poisson binomial models, mean can set 0, implying dispersion term also 0. normal models, mean must non-negative. mod argument set_disp fitted model, set_disp 'unfits' model, deleting existing estimates.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/set_disp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set Mean in Prior for Dispersion or Standard Deviation — set_disp","text":"","code":"mod <- mod_pois(injuries ~ age:sex + ethnicity + year,                 data = injuries,                 exposure = popn) mod #> -- Unfitted Poisson model -- #>  #>    injuries ~ age:sex + ethnicity + year #>  #> (Intercept) ~ NFix() #>   ethnicity ~ NFix() #>        year ~ RW() #>     age:sex ~ RW() #>  #>      dispersion: mean=1 #>        exposure: popn #>         var_age: age #>   var_sexgender: sex #>        var_time: year #>          n_draw: 1000 mod |> set_disp(mean = 0.1) #> -- Unfitted Poisson model -- #>  #>    injuries ~ age:sex + ethnicity + year #>  #> (Intercept) ~ NFix() #>   ethnicity ~ NFix() #>        year ~ RW() #>     age:sex ~ RW() #>  #>      dispersion: mean=0.1 #>        exposure: popn #>         var_age: age #>   var_sexgender: sex #>        var_time: year #>          n_draw: 1000 mod |> set_disp(mean = 0) #> -- Unfitted Poisson model -- #>  #>    injuries ~ age:sex + ethnicity + year #>  #> (Intercept) ~ NFix() #>   ethnicity ~ NFix() #>        year ~ RW() #>     age:sex ~ RW() #>  #>      dispersion: mean=0 #>        exposure: popn #>         var_age: age #>   var_sexgender: sex #>        var_time: year #>          n_draw: 1000"},{"path":"https://bayesiandemography.github.io/bage/reference/set_n_draw.html","id":null,"dir":"Reference","previous_headings":"","what":"Set the number of draws — set_n_draw","title":"Set the number of draws — set_n_draw","text":"Specify number draws posterior distribution used model output. newly-created bage_mod object n_draw value 1000. Higher values may appropriate characterising tails distributions, publication-quality graphics summaries.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_n_draw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set the number of draws — set_n_draw","text":"","code":"set_n_draw(mod, n_draw = 1000L)"},{"path":"https://bayesiandemography.github.io/bage/reference/set_n_draw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set the number of draws — set_n_draw","text":"mod bage_mod object, typically created mod_pois(), mod_binom(), mod_norm(). n_draw Number draws.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_n_draw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set the number of draws — set_n_draw","text":"bage_mod object","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_n_draw.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Set the number of draws — set_n_draw","text":"value n_draw affect model fitting: affects posterior summaries.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/set_n_draw.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set the number of draws — set_n_draw","text":"","code":"mod <- mod_pois(injuries ~ age:sex + ethnicity + year,                 data = injuries,                 exposure = popn) mod #> -- Unfitted Poisson model -- #>  #>    injuries ~ age:sex + ethnicity + year #>  #> (Intercept) ~ NFix() #>   ethnicity ~ NFix() #>        year ~ RW() #>     age:sex ~ RW() #>  #>      dispersion: mean=1 #>        exposure: popn #>         var_age: age #>   var_sexgender: sex #>        var_time: year #>          n_draw: 1000  mod |>   set_n_draw(n_draw = 5000) #> -- Unfitted Poisson model -- #>  #>    injuries ~ age:sex + ethnicity + year #>  #> (Intercept) ~ NFix() #>   ethnicity ~ NFix() #>        year ~ RW() #>     age:sex ~ RW() #>  #>      dispersion: mean=1 #>        exposure: popn #>         var_age: age #>   var_sexgender: sex #>        var_time: year #>          n_draw: 5000"},{"path":"https://bayesiandemography.github.io/bage/reference/set_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify a Prior — set_prior","title":"Specify a Prior — set_prior","text":"Specify prior distribution intercept, main effect, interaction.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify a Prior — set_prior","text":"","code":"set_prior(mod, formula)"},{"path":"https://bayesiandemography.github.io/bage/reference/set_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify a Prior — set_prior","text":"mod bage_mod object, created mod_pois(), mod_binom(), mod_norm(). formula formula giving term function creating prior.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify a Prior — set_prior","text":"modified bage_mod object.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_prior.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify a Prior — set_prior","text":"mod argument set_prior fitted model, set_disp 'unfits' model, deleting existing estimates.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/set_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify a Prior — set_prior","text":"","code":"mod <- mod_pois(injuries ~ age + year,                 data = injuries,                 exposure = popn) mod #> -- Unfitted Poisson model -- #>  #>    injuries ~ age + year #>  #> (Intercept) ~ NFix() #>         age ~ RW() #>        year ~ RW() #>  #>      dispersion: mean=1 #>        exposure: popn #>         var_age: age #>        var_time: year #>          n_draw: 1000 mod |> set_prior(age ~ RW2()) #> -- Unfitted Poisson model -- #>  #>    injuries ~ age + year #>  #> (Intercept) ~ NFix() #>         age ~ RW2() #>        year ~ RW() #>  #>      dispersion: mean=1 #>        exposure: popn #>         var_age: age #>        var_time: year #>          n_draw: 1000"},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_age.html","id":null,"dir":"Reference","previous_headings":"","what":"Set the age variable — set_var_age","title":"Set the age variable — set_var_age","text":"Specify variable () represents age. Functions mod_pois(), mod_binom(), mod_norm() try infer age variable variable names, always get right.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_age.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set the age variable — set_var_age","text":"","code":"set_var_age(mod, name)"},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_age.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set the age variable — set_var_age","text":"mod bage_mod object, typically created mod_pois(), mod_binom(), mod_norm(). name name age variable.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_age.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set the age variable — set_var_age","text":"bage_mod object","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_age.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Set the age variable — set_var_age","text":"R formula, 'variable' different 'term'. instance, ~ age + region + age:region contains variables age region, terms age, region, age:region. default, bage gives term involving age (RW()) prior. Changing age variable via set_var_age() can change priors: see example. mod argument set_var_age fitted model, set_var_age 'unfits' model deleting existing estimates.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_age.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set the age variable — set_var_age","text":"","code":"## rename 'age' variable to something unusual injuries2 <- injuries injuries2$age_last_birthday <- injuries2$age  ## mod_pois does not recognize age variable mod <- mod_pois(injuries ~ age_last_birthday * ethnicity + year,                 data = injuries2,                 exposure = popn) mod #> -- Unfitted Poisson model -- #>  #>                    injuries ~ age_last_birthday * ethnicity + year #>  #>                 (Intercept) ~ NFix() #>           age_last_birthday ~ N() #>                   ethnicity ~ NFix() #>                        year ~ RW() #> age_last_birthday:ethnicity ~ N() #>  #>      dispersion: mean=1 #>        exposure: popn #>        var_time: year #>          n_draw: 1000  ## so we set the age variable explicitly ## (which, as a side effect, changes the prior on ## the age main effect) mod |>   set_var_age(name = \"age_last_birthday\") #> -- Unfitted Poisson model -- #>  #>                    injuries ~ age_last_birthday * ethnicity + year #>  #>                 (Intercept) ~ NFix() #>           age_last_birthday ~ RW() #>                   ethnicity ~ NFix() #>                        year ~ RW() #> age_last_birthday:ethnicity ~ N() #>  #>      dispersion: mean=1 #>        exposure: popn #>         var_age: age_last_birthday #>        var_time: year #>          n_draw: 1000"},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_sexgender.html","id":null,"dir":"Reference","previous_headings":"","what":"Set a sex or gender variable — set_var_sexgender","title":"Set a sex or gender variable — set_var_sexgender","text":"Specify variable () represents sex gender. Functions mod_pois(), mod_binom(), mod_norm() try find sex gender variable using variable names, always get right.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_sexgender.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set a sex or gender variable — set_var_sexgender","text":"","code":"set_var_sexgender(mod, name)"},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_sexgender.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set a sex or gender variable — set_var_sexgender","text":"mod bage_mod object, typically created mod_pois(), mod_binom(), mod_norm(). name name sex gender variable.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_sexgender.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set a sex or gender variable — set_var_sexgender","text":"\"bage_mod\" object","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_sexgender.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Set a sex or gender variable — set_var_sexgender","text":"R formula, 'variable' different 'term'. instance, ~ gender + region + gender:region contains variables gender region, terms gender, region, gender:region. mod argument set_var_sexgender fitted model, set_var_sexgender 'unfits' model deleting existing estimates.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_sexgender.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set a sex or gender variable — set_var_sexgender","text":"","code":"## rename 'sex' variable to something unexpected injuries2 <- injuries injuries2$biological_sex <- injuries2$sex  ## mod_pois does not recognize sex variable mod <- mod_pois(injuries ~ age * biological_sex + year,                 data = injuries2,                 exposure = popn) mod #> -- Unfitted Poisson model -- #>  #>           injuries ~ age * biological_sex + year #>  #>        (Intercept) ~ NFix() #>                age ~ RW() #>     biological_sex ~ NFix() #>               year ~ RW() #> age:biological_sex ~ RW() #>  #>      dispersion: mean=1 #>        exposure: popn #>         var_age: age #>        var_time: year #>          n_draw: 1000  ## so we set the sex variable explicitly mod |>   set_var_sexgender(name = \"biological_sex\") #> -- Unfitted Poisson model -- #>  #>           injuries ~ age * biological_sex + year #>  #>        (Intercept) ~ NFix() #>                age ~ RW() #>     biological_sex ~ NFix() #>               year ~ RW() #> age:biological_sex ~ RW() #>  #>      dispersion: mean=1 #>        exposure: popn #>         var_age: age #>   var_sexgender: biological_sex #>        var_time: year #>          n_draw: 1000"},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_time.html","id":null,"dir":"Reference","previous_headings":"","what":"Set the time variable — set_var_time","title":"Set the time variable — set_var_time","text":"Specify variable () represents time. Functions mod_pois(), mod_binom(), mod_norm() try infer time variable variable names, always get right.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_time.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set the time variable — set_var_time","text":"","code":"set_var_time(mod, name)"},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_time.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set the time variable — set_var_time","text":"mod bage_mod object, typically created mod_pois(), mod_binom(), mod_norm(). name name time variable.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_time.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set the time variable — set_var_time","text":"bage_mod object","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_time.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Set the time variable — set_var_time","text":"R formula, 'variable' different 'term'. instance, ~ time + region + time:region contains variables time region, terms time, region, time:region. default, bage gives term involving time (RW()) prior. Changing time variable via set_var_time() can change priors: see example. mod argument set_var_time fitted model, set_var_time 'unfits' model, deleting existing estimates.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_time.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set the time variable — set_var_time","text":"","code":"## rename time variable to something unusual injuries2 <- injuries injuries2$calendar_year <- injuries2$year  ## mod_pois does not recognize time variable mod <- mod_pois(injuries ~ age * ethnicity + calendar_year,                 data = injuries2,                 exposure = popn) mod #> -- Unfitted Poisson model -- #>  #>      injuries ~ age * ethnicity + calendar_year #>  #>   (Intercept) ~ NFix() #>           age ~ RW() #>     ethnicity ~ NFix() #> calendar_year ~ N() #> age:ethnicity ~ RW() #>  #>      dispersion: mean=1 #>        exposure: popn #>         var_age: age #>          n_draw: 1000  ## so we set the time variable explicitly ## (which, as a side effect, changes the prior on ## the time main effect) mod |>   set_var_time(name = \"calendar_year\") #> -- Unfitted Poisson model -- #>  #>      injuries ~ age * ethnicity + calendar_year #>  #>   (Intercept) ~ NFix() #>           age ~ RW() #>     ethnicity ~ NFix() #> calendar_year ~ RW() #> age:ethnicity ~ RW() #>  #>      dispersion: mean=1 #>        exposure: popn #>         var_age: age #>        var_time: calendar_year #>          n_draw: 1000"},{"path":"https://bayesiandemography.github.io/bage/reference/ssvd.html","id":null,"dir":"Reference","previous_headings":"","what":"Create an Object to Hold Data from a Scaled SVD — ssvd","title":"Create an Object to Hold Data from a Scaled SVD — ssvd","text":"Create object class \"bage_ssvd\" hold results scaled Singular Value Decomposition (SVD) n_comp components.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/ssvd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create an Object to Hold Data from a Scaled SVD — ssvd","text":"","code":"ssvd(data)"},{"path":"https://bayesiandemography.github.io/bage/reference/ssvd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create an Object to Hold Data from a Scaled SVD — ssvd","text":"data data frame. See Details description.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/ssvd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create an Object to Hold Data from a Scaled SVD — ssvd","text":"object class \"bage_ssvd\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/ssvd.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create an Object to Hold Data from a Scaled SVD — ssvd","text":"data following columns: type Type decomposition. Choices \"total\", \"joint\", \"indep\". labels_age Age labels individual rows matrices within matrix individual elements vectors within offset. labels_sexgender Sex/gender labels individual rows matrices within matrix individual elements vectors within offset, NULL. NULL sexgender \"total\", since case results average across sexes/genders. matrix List column sparse matrices. Must rownames. Must NAs. type \"total\" \"joint\", matrix n_comp columns. \"type\" \"indep\", matrix 2 * n_comp columns. offset List column vectors. Must names, identical rownames corresponding element matrix. data normally constructed using function package bssvd.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/ssvd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create an Object to Hold Data from a Scaled SVD — ssvd","text":"","code":"if (FALSE) { # \\dontrun{ data <- data_ssvd_hmd(\"hmd_statistics_20240226.zip\") HMD <- ssvd(data) } # }"},{"path":"https://bayesiandemography.github.io/bage/reference/tidy.bage_mod.html","id":null,"dir":"Reference","previous_headings":"","what":"Main effects and interactions from a fitted model — tidy.bage_mod","title":"Main effects and interactions from a fitted model — tidy.bage_mod","text":"Main effects interactions fitted model","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/tidy.bage_mod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Main effects and interactions from a fitted model — tidy.bage_mod","text":"","code":"# S3 method for class 'bage_mod' tidy(x, ...)"},{"path":"https://bayesiandemography.github.io/bage/reference/tidy.bage_mod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Main effects and interactions from a fitted model — tidy.bage_mod","text":"x fitted bage_mod object. ... Unused. Included generic consistency .","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/tidy.bage_mod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Main effects and interactions from a fitted model — tidy.bage_mod","text":"tibble.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/tidy.bage_mod.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Main effects and interactions from a fitted model — tidy.bage_mod","text":"","code":"mod <- mod_pois(injuries ~ age + sex + year,                 data = injuries,                 exposure = popn) mod <- fit(mod) tidy(mod) #> # A tibble: 4 × 4 #>   term        spec       n      sd #>   <chr>       <chr>  <int>   <dbl> #> 1 (Intercept) NFix()     1 NA      #> 2 age         RW()      12  0.763  #> 3 sex         NFix()     2  0.714  #> 4 year        RW()      19  0.0935"},{"path":"https://bayesiandemography.github.io/bage/reference/us_acc_deaths.html","id":null,"dir":"Reference","previous_headings":"","what":"Accidental Deaths in the USA — us_acc_deaths","title":"Accidental Deaths in the USA — us_acc_deaths","text":"Counts accidental deaths USA, month, 1973-1978.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/us_acc_deaths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Accidental Deaths in the USA — us_acc_deaths","text":"","code":"us_acc_deaths"},{"path":"https://bayesiandemography.github.io/bage/reference/us_acc_deaths.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Accidental Deaths in the USA — us_acc_deaths","text":"tibble 72 rows following columns: month: Year month. deaths: Count deaths.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/us_acc_deaths.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Accidental Deaths in the USA — us_acc_deaths","text":"Reformatted version datasets::USAccDeaths.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-interface-0-6-2","dir":"Changelog","previous_headings":"","what":"Changes to interface","title":"bage 0.6.2","text":"Removed SVDS(), SVDS_AR(), SVDS_AR1(), SVDS_RW(), SVDS_RW2() priors. Added indep argument corresponding SVD priors. SVD priors now choose ‘total’, ‘independent’ ‘joint’ models based (1) value indep argument, (2) value var_sexgender name term.","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-data-0-6-2","dir":"Changelog","previous_headings":"","what":"Changes to data","title":"bage 0.6.2","text":"Object HMD now contains 5 components, rather 10.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-calculations-0-6-1","dir":"Changelog","previous_headings":"","what":"Changes to calculations","title":"bage 0.6.1","text":"Fixed problems standardization forecast Added intercept term Lin() LinAR() priors","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"issues-0-6-0","dir":"Changelog","previous_headings":"","what":"Issues","title":"bage 0.6.0","text":"Standardization forecasts working correctly.","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-interface-0-6-0","dir":"Changelog","previous_headings":"","what":"Changes to interface","title":"bage 0.6.0","text":"Added priors SVD_AR(), SVDS_AR(), SVD_AR1(), SVDS_AR1(), SVD_RW(), SVDS_RW(), SVD_RW2(), SVDS_RW2()","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"internal-calculations-0-6-0","dir":"Changelog","previous_headings":"","what":"Internal calculations","title":"bage 0.6.0","text":"Changed values stored object: removed draws_linpred, added draws_effectfree, draws_spline, draws_svd. Modified/added downstream functions. Calculation ‘along_by’ ‘agesex’ matrices pushed downwards lower-level functions.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-interface-0-5-1","dir":"Changelog","previous_headings":"","what":"Changes to interface","title":"bage 0.5.1","text":"Moved HMD code package bssvd.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-interface-0-5-0","dir":"Changelog","previous_headings":"","what":"Changes to interface","title":"bage 0.5.0","text":"Combined interaction (eg ELin) main effect (eg Lin) versions priors Removed function compose_time() Added priors RWSeas RW2Seas Improved report_sim()","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-interface-0-4-2","dir":"Changelog","previous_headings":"","what":"Changes to interface","title":"bage 0.4.2","text":"Tidying online help (yet complete).","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"new-functions-0-4-1","dir":"Changelog","previous_headings":"","what":"New functions","title":"bage 0.4.1","text":"Added ‘bage_ssvd’ method components().","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-interface-0-4-1","dir":"Changelog","previous_headings":"","what":"Changes to interface","title":"bage 0.4.1","text":"augment() method bage_mod objects now calculated value .fitted cases outcome exposure/size NA, rather setting value .fitted NA.","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"internal-calculations-0-4-1","dir":"Changelog","previous_headings":"","what":"Internal calculations","title":"bage 0.4.1","text":"Standardization effects done components() called. augment() uses linear predictor (need standardization.) Internally, draws linear predictor, hyper-parameters (included model) disp stored, rather full standardized components. Standardization algorithm repeats 100 times, residuals less 0.0001. new configuration, calculations large matrices previously failed error message “Internal error: Final residual 0” now running.","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"simulations-0-4-1","dir":"Changelog","previous_headings":"","what":"Simulations","title":"bage 0.4.1","text":"drawing prior, intercept always set 0. Terms SVD Known priors touched. terms centered.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-back-end-for-svd-priors-0-4-0","dir":"Changelog","previous_headings":"","what":"Changes to back-end for SVD priors","title":"bage 0.4.0","text":"Move functions creating ‘bage_ssvd’ objects package ‘bssvd’.","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"bug-fixes-0-4-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"bage 0.4.0","text":"Corrected error calculation logit ssvd_comp().","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"new-functions-0-3-2","dir":"Changelog","previous_headings":"","what":"New functions","title":"bage 0.3.2","text":"forecast.bage_mod() Forecasting. Interface yet finalised.","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"bug-fixes-0-3-2","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"bage 0.3.2","text":"Corrected error C++ template Lin ELin priors (due use integer arithmetic.)","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"new-functions-0-2-2","dir":"Changelog","previous_headings":"","what":"New functions","title":"bage 0.2.2","text":"generate.bage_ssvd() Generate random age-sex profiles SVD.","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"bug-fixes-0-2-2","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"bage 0.2.2","text":"Internal function draw_vals_effect_mod() malfunctioning models contained SVD priors.","code":""}]
