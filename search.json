[{"path":"https://bayesiandemography.github.io/bage/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 Bayesian Demography Limited Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"2. Mathematical Details","text":"Specification document - mathematical description models used bage. Note: features described implemented yet.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:data","dir":"Articles","previous_headings":"","what":"Input data","title":"2. Mathematical Details","text":"outcome variable: events, numbers people, sort measure continuous variable income expenditure exposure/size/weights disagg one variables. Almost always includes age, sex/gender, time. May include variables eg region, ethnicity, education. combinations variables present; may missing values","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:pois","dir":"Articles","previous_headings":"3 Models","what":"Poisson likelihood","title":"2. Mathematical Details","text":"Let \\(y_i\\) count events cell \\(= 1, \\cdots, n\\) let \\(w_i\\) corresponding exposure measure, possibility \\(w_i \\equiv 1\\). likelihood Poisson model \\[\\begin{align}   y_i & \\sim \\text{Poisson}(\\gamma_i w_i) \\tag{3.1} \\\\   \\gamma_i & \\sim \\text{Gamma}\\left(\\xi^{-1}, (\\mu_i \\xi)^{-1}\\right),  \\tag{3.2} \\end{align}\\] using shape-rates parameterisation Gamma distribution. Parameter \\(\\xi\\) governs dispersion, \\[\\begin{equation}   \\text{var}(\\gamma_i \\mid \\mu_i, \\xi) = \\xi \\mu_i^2 \\end{equation}\\] \\[\\begin{equation}   \\text{var}(y_i \\mid \\mu_i, \\xi, w_i) = (1 + \\xi \\mu_i w_i ) \\times \\mu_i w_i. \\end{equation}\\] allow \\(\\xi\\) equal 0, case model reduces \\[\\begin{equation}   y_i \\sim \\text{Poisson}(\\mu_i w_i). \\end{equation}\\] \\(\\xi > 0\\), Equations (3.1) (3.2) equivalent \\[\\begin{equation}   y_i \\sim \\text{NegBinom}\\left(\\xi^{-1}, (1 + \\mu_i w_i \\xi)^{-1}\\right) \\end{equation}\\] (Norton, Christen, Fox 2018; Simpson 2022). format use internally estimation. values \\(\\gamma_i\\) needed, generate fly, using fact \\[\\begin{equation}   \\gamma_i \\mid y_i, w_i, \\mu_i, \\xi \\sim \\text{Gamma}\\left(y_i + \\xi^{-1}, w_i + (\\xi \\mu_i)^{-1}\\right). \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:binom","dir":"Articles","previous_headings":"3 Models","what":"Binomial likelihood","title":"2. Mathematical Details","text":"likelihood binomial model \\[\\begin{align}   y_i  & \\sim \\text{Binomial}(w_i, \\gamma_i) \\tag{3.3} \\\\   \\gamma_i & \\sim \\text{Beta}\\left(\\xi^{-1} \\mu_i, \\xi^{-1}(1 - \\mu_i)\\right). \\tag{3.4} \\end{align}\\] Parameter \\(\\xi\\) governs dispersion, \\[\\begin{equation}   \\text{var}(\\gamma_i \\mid \\mu_i, \\xi) =  \\frac{\\xi}{1 + \\xi} \\times \\mu_i (1 -\\mu_i) \\end{equation}\\] \\[\\begin{equation}   \\text{var}(y_i \\mid w_i, \\mu_i, \\xi) =  \\frac{\\xi w_i + 1}{\\xi + 1} \\times w_i \\mu_i (1 - \\mu_i). \\end{equation}\\] allow \\(\\xi\\) equal 0, case model reduces \\[\\begin{equation}   y_i \\sim  \\text{Binom}(w_i, \\mu_i). \\end{equation}\\] Equations (3.3) (3.4) equivalent \\[\\begin{equation}   y_i  \\sim \\text{BetaBinom}\\left(w_i, \\xi^{-1} \\mu_i, \\xi^{-1} (1 - \\mu_i) \\right), \\end{equation}\\] use internally. Values \\(\\gamma_i\\) can generated using \\[\\begin{equation}   \\gamma_i \\mid y_i, w_i, \\mu_i, \\xi \\sim \\text{Beta}\\left(y_i + \\xi^{-1} \\mu_i, w_i - y_i + \\xi^{-1}(1-\\mu_i) \\right). \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:norm","dir":"Articles","previous_headings":"3 Models","what":"Normal likelihood","title":"2. Mathematical Details","text":"normal model \\[\\begin{equation}   \\tilde{y}_i \\sim \\text{N}(\\mu_i, \\tilde{w}_i^{-1}\\xi^2). \\end{equation}\\] \\(\\tilde{y}_i\\) standardized version outcome \\(y_i\\), \\(\\tilde{w}_i\\) standardized version weight \\(w_i\\). standardization carried using \\[\\begin{align}   \\tilde{y}_i & = \\frac{y_i - \\bar{y}}{s} \\\\   \\tilde{w}_i & = \\frac{w_i}{\\bar{w}}. \\end{align}\\] \\[\\begin{align}   \\bar{y} & = \\frac{\\sum_{=1}^n y_i}{n} \\\\   s & = \\sqrt{\\frac{\\sum_{=1}^n (y_i - \\bar{y})^2}{n-1}} \\\\   \\bar{w} & = \\frac{\\sum_{=1}^n w_i}{n}. \\end{align}\\] Standardizing allows us apply priors use Poisson binomial models.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-for-prior-means","dir":"Articles","previous_headings":"","what":"Model for prior means","title":"2. Mathematical Details","text":"Let \\(\\pmb{\\mu} = (\\mu_1, \\cdots, \\mu_n)^{\\top}\\). model \\(\\pmb{\\mu}\\) \\[\\begin{equation}   \\pmb{\\mu} = \\sum_{m=0}^{M} \\pmb{X}^{(m)} \\pmb{\\beta}^{(m)} + \\pmb{Z} \\pmb{\\zeta} \\tag{4.1} \\end{equation}\\] \\(\\beta^{(0)}\\) intercept; \\(\\pmb{\\beta}^{(m)}\\), \\(m=1,\\cdots,M\\) vector \\(J_m\\) elements describing main effect interaction formed dimensions data \\(\\pmb{y}\\); \\(\\pmb{X}^{(m)}\\) \\(n \\times J_m\\) matrix 1s 0s, \\(\\)th row picks element \\(\\pmb{\\beta}^{(m)}\\) used cell \\(\\); \\(\\pmb{Z}\\) \\(n \\times P\\) matrix covariates; \\(\\pmb{\\zeta}\\) coefficient vector \\(P\\) elements.","code":""},{"path":[]},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"along-and-by-dimensions","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.1 General features","what":"‘Along’ and ‘by’ dimensions","title":"2. Mathematical Details","text":"\\(\\pmb{\\beta}^{(m)}\\), \\(m > 0\\), can main effect, involving single dimension, interaction, involving two dimensions. priors, applied interaction, treat one dimension, referred ‘along’ dimension, differently remaining dimensions, referred ‘’ dimensions. random walk prior (Section 5.4), instance, consists independent random walk along ‘along’ dimension, within combination ‘’ dimensions. use \\(v = 1, \\cdots, V_m\\) denote position within ‘along’ dimension, \\(u = 1, \\cdots, V_m\\) denote position within classification formed ‘’ dimensions. sum--zero constraints (see ), \\(U_m = \\prod_k d_k\\) \\(d_k\\) number elements \\(k\\)th ‘’ variable. sum--zero constraints, \\(U_m = \\prod_k (d_k - 1)\\). prior involves ‘along’ dimension user specify one, procedure choosing dimension follows: term involves time, use time dimension; otherwise, term involves age, use age dimension; otherwise, raise error asking user explicitly specify dimension.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:sum-to-zero","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.1 General features","what":"Sum-to-zero constraints","title":"2. Mathematical Details","text":"Priors involve ‘along’ dimensions can optionally include sum--zero constraints. constrains applied, within element \\(v\\) ‘along’ dimension, sum \\(\\beta_j^{(m)}\\) across ‘’ dimension zero. instance, \\(\\pmb{\\beta}^{(m)}\\) interaction time, region, sex, time ‘along’ variable, within combination time region, values females males sum zero, within combination time sex, values regions sum zero. Except case dynamic SVD-based priors (eg Sections 5.15), sum--zero constraints implemented internally drawing values within unrestricted lower-dimensional space, transforming restricted higher-dimensional space. instance, random walk prior time-region interaction \\(R\\) regions consists \\(R-1\\) unrestricted random walks along time, converted \\(R\\) random walks sum zero across region. Matrices transforming unrestricted restricted spaces constructed using QR decomposition, described Section 1.8.1 Wood (2017). dynamic SVD-based priors, draw values SVD coefficients constraints, convert unconstrained values \\(\\pmb{\\beta}^{(m)}\\), subtract means.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"algorithm-for-assigning-default-priors","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.1 General features","what":"Algorithm for assigning default priors","title":"2. Mathematical Details","text":"\\(\\pmb{\\beta}^{(m)}\\) one two elements, assign \\(\\pmb{\\beta}^{(m)}\\) fixed-normal prior (Section 5.3); otherwise, \\(\\pmb{\\beta}^{(m)}\\) involves time, assign \\(\\pmb{\\beta}^{(m)}\\) random walk prior (Section 5.4) along time dimension; otherwise, \\(\\pmb{\\beta}^{(m)}\\) involves age, assign \\(\\pmb{\\beta}^{(m)}\\) random walk prior (Section 5.4) along age dimension; otherwise, assign \\(\\pmb{\\beta}^{(m)}\\) normal prior (Section 5.2) intercept term \\(\\pmb{\\beta}^{(0)}\\) can given fixed-normal prior (Section 5.3) Known prior (Section 5.19).","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.2 N()","what":"Model","title":"2. Mathematical Details","text":"Exchangeable normal \\[\\begin{align}   \\beta_j^{(m)} & \\sim \\text{N}\\left(0, \\tau_m^2 \\right) \\\\   \\tau_m & \\sim \\text{N}^+\\left(0, A_{\\tau}^{(m)2}\\right) \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.2 N()","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\prod_{j=1}^{J_m} \\text{N}(\\beta_j^{(m)} \\mid 0, \\tau_m^2) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.2 N()","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{equation}     \\beta_{J_m+h+1}^{(m)} \\sim \\text{N}(0, \\tau_m^2) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.2 N()","what":"Code","title":"2. Mathematical Details","text":"s \\(A_{\\tau}^{(m)}\\). Defaults 1.","code":"N(s = 1)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-1","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.3 NFix()","what":"Model","title":"2. Mathematical Details","text":"Exchangeable normal, fixed standard deviation \\[\\begin{equation}   \\beta_j^{(m)} \\sim \\text{N}\\left(0, A_{\\beta}^{(m)2}\\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-1","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.3 NFix()","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\prod_{j=1}^{J_m} \\text{N}(\\beta_j^{(m)} \\mid 0, A_{\\beta}^{(m)2}) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-1","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.3 NFix()","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{equation}     \\beta_{J_m+h+1}^{(m)} \\sim \\text{N}(0, A_{\\beta}^{(m)2}) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-1","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.3 NFix()","what":"Code","title":"2. Mathematical Details","text":"sd \\(A_{\\tau}^{(m)}\\). Defaults 1.","code":"NFix(sd = 1)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-2","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.4 RW()","what":"Model","title":"2. Mathematical Details","text":"Random walk \\[\\begin{align}   \\beta_{u,1}^{(m)} & = 0 \\\\   \\beta_{u,v}^{(m)} & \\sim \\text{N}(\\beta_{u,v-1}^{(m)}, \\tau_m^2), \\quad v = 2, \\cdots, V_m \\\\   \\tau_m & \\sim \\text{N}^+\\left(0, A_{\\tau}^{(m)2}\\right) \\end{align}\\] \\(U_m > 1\\), sum--zero constraints (Section 5.1.2) can applied.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-2","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.4 RW()","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\prod_{u=1}^{U_m} \\text{N}(\\beta_{u,2}^{(m)} \\mid 0, \\tau_m^2)  \\prod_{v=3}^{V_m} \\text{N}\\left(\\beta_{uv}^{(m)} \\mid \\beta_{u,v-1}^{(m)}, \\tau_m^2 \\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-2","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.4 RW()","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\beta_{u,V_m+h}^{(m)} \\sim \\text{N}(\\beta_{u,V_m+h-1}^{(m)}, \\tau_m^2) \\end{equation}\\] prior includes sum--zero constraints, means subtracted forecasted values within combination ‘along’ ‘’ variables.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-2","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.4 RW()","what":"Code","title":"2. Mathematical Details","text":"s \\(A_{\\tau}^{(m)}\\). Defaults 1. along used identify ‘along’ ‘’ dimensions. zero_sum TRUE, sum--zero constraints applied.","code":"RW(s = 1, along = NULL, zero_sum = TRUE)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-3","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.5 RW2()","what":"Model","title":"2. Mathematical Details","text":"Second-order random walk \\[\\begin{align}   \\beta_{u,1}^{(m)} & = 0  \\\\   \\beta_{u,2}^{(m)} & \\sim \\text{N}\\left(0, (A_{\\eta}^{(m)})^2\\right) \\\\   \\beta_{u,v}^{(m)} & \\sim \\text{N}\\left(2 \\beta_{u,v-1}^{(m)} - \\beta_{u,v-2}^{(m)}, \\tau_m^2\\right), \\quad v = 3, \\cdots, V_m \\\\   \\tau_m & \\sim \\text{N}^+\\left(0, (A_{\\tau}^{(m)})^2\\right) \\end{align}\\] \\(U_m > 1\\), sum--zero constraints (Section 5.1.2) can applied.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-3","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.5 RW2()","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\prod_{u=1}^{U_m} \\text{N}(\\beta_{u,2}^{(m)} \\mid 0, (A_{\\eta}^{(m)})^2) \\text{N}(\\beta_{u,3}^{(m)} \\mid 2 \\beta_{u,2}^{(m)}, \\tau_m^2) \\prod_{v=4}^{V_m} \\text{N}\\left(\\beta_{u,v}^{(m)} \\mid 2 \\beta_{u,v-1}^{(m)} - \\beta_{u,v-2}^{(m)}, \\tau_m^2 \\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-3","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.5 RW2()","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\beta_{u,V_m+h}^{(m)} \\sim \\text{N}(2 \\beta_{u,V_m+h-1}^{(m)} - \\beta_{u,V_m+h-2}^{(m)}, \\tau_m^2) \\end{equation}\\] prior includes sum--zero constraints, means subtracted forecasted values within combination ‘along’ ‘’ variables.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-3","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.5 RW2()","what":"Code","title":"2. Mathematical Details","text":"s \\(A_{\\tau}^{(m)}\\) sd \\(A_{\\eta}^{(m)}\\) along used identify ‘along’ ‘’ dimensions zero_sum TRUE, sum--zero constraints applied","code":"RW2(s = 1, sd = 1, along = NULL, zero_sum = TRUE)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-4","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.6 RW_Seas()","what":"Model","title":"2. Mathematical Details","text":"Random walk seasonal effect \\[\\begin{align}   \\beta_{u,v}^{(m)} & = \\alpha_{u,v} + \\lambda_{u,s_v} \\\\   \\alpha_{u,1}^{(m)} & = 0 \\\\   \\alpha_{u,v}^{(m)} & \\sim \\text{N}(\\alpha_{u,v-1}^{(m)}, \\tau_m^2), \\quad v = 2, \\cdots, V_m \\\\   \\lambda_{u,v}^{(m)} & \\sim \\text{N}(0, A_{\\lambda}^{(m)}), \\quad v = 1, \\cdots, S_m - 1 \\\\   \\lambda_{u,v}^{(m)} & = \\sum_{s=1}^{S_m-1} \\lambda_{u,v}^{(m)}, \\quad v = S_m,\\; 2S_m,  \\cdots \\\\   \\lambda_{u,v}^{(m)} & \\sim \\text{N}(\\lambda_{u,v-S_m}^{(m)}, \\omega_m^2), \\quad \\text{otherwise} \\\\   \\tau_m & \\sim \\text{N}^+\\left(0, A_{\\tau}^{(m)2}\\right) \\\\   \\omega_m & \\sim \\text{N}^+\\left(0, A_{\\omega}^{(m)2}\\right) \\end{align}\\] Scale parameter \\(A_{\\omega}^{(m)2}\\) can set zero, implying seasonal effect season change time. \\(U_m > 1\\), sum--zero constraints (Section 5.1.2) can applied.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-4","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.6 RW_Seas()","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation} \\begin{split}   & \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\text{N}(\\omega_m \\mid 0, A_{\\omega}^{(m)2}) \\\\   \\quad \\times & \\prod_{u=1}^{U_m} \\left( \\text{N}(\\alpha_{u,2}^{(m)} \\mid 0, \\tau_m^2 ) \\prod_{v=3}^{V_m} \\text{N}(\\alpha_{u,v}^{(m)} \\mid \\alpha_{u,v-1}^{(m)}, \\tau_m^2 ) \\prod_{v=1}^{S_m-1}  \\text{N}(\\lambda_{u,v}^{(m)} \\mid 0, (A_{\\lambda}^{(m)})^2) \\\\   \\prod_{v > S_m, \\; v \\;\\text{mod}\\; S_m \\neq 0}^{V_m} \\text{N}(\\lambda_{u,v}^{(m)} \\mid \\lambda_{u,v-S_m}^{(m)}, \\omega_m^2) \\right) \\end{split} \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-4","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.6 RW_Seas()","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\alpha_{J_m+h}^{(m)} & \\sim \\text{N}(\\alpha_{J_m+h-1}^{(m)}, \\tau_m^2) \\\\   \\lambda_{J_m+h}^{(m)} & \\sim \\text{N}(\\lambda_{J_m+h-S_m}^{(m)}, \\omega_m^2) \\\\   \\beta_{J_m+h}^{(m)} & = \\alpha_{J_m+h}^{(m)} + \\lambda_{J_m+h}^{(m)} \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-4","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.6 RW_Seas()","what":"Code","title":"2. Mathematical Details","text":"n_seas \\(S_m\\) s \\(A_{\\tau}^{(m)}\\) s_seas \\(A_{\\omega}^{(m)}\\) sd_seas \\(A_{\\lambda}^{(m)}\\) along used identify ‘along’ ‘’ dimensions zero_sum TRUE, sum--zero constraints applied","code":"RW_Seas(n, s = 1, s_seas = 1, sd_seas, along = NULL, zero_sum = FALSE)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-5","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.7 RW2_Seas()","what":"Model","title":"2. Mathematical Details","text":"Second-order random work, seasonal effect \\[\\begin{align}   \\beta_{u,v}^{(m)} & = \\alpha_{u,v} + \\lambda_{u,s_v} \\\\   \\alpha_{u,1}^{(m)} & = 0 \\\\   \\alpha_{u,2}^{(m)} & \\sim \\text{N}\\left(0, (A_{\\eta}^{(m)})^2\\right) \\\\   \\alpha_{u,v}^{(m)} & \\sim \\text{N}(2 \\alpha_{u,v-1}^{(m)} - \\alpha_{u,v-2}^{(m)}, \\tau_m^2), \\quad v = 3, \\cdots, V_m \\\\   \\lambda_{u,v}^{(m)} & \\sim \\text{N}(0, A_{\\lambda}^{(m)}), \\quad v = 1, \\cdots, S_m - 1 \\\\   \\lambda_{u,v}^{(m)} & = \\sum_{s=1}^{S_m-1} \\lambda_{u,v}^{(m)}, \\quad v = S_m,\\; 2S_m,  \\cdots \\\\   \\lambda_{u,v}^{(m)} & \\sim \\text{N}(\\lambda_{u,v-S_m}^{(m)}, \\omega_m^2), \\quad \\text{otherwise} \\\\   \\tau_m & \\sim \\text{N}^+\\left(0, A_{\\tau}^{(m)2}\\right) \\\\   \\omega_m & \\sim \\text{N}^+\\left(0, A_{\\omega}^{(m)2}\\right) \\end{align}\\] Scale parameter \\(A_{\\omega}^{(m)2}\\) can set zero, implying seasonal effect season change time. \\(U_m > 1\\), sum--zero constraints (Section 5.1.2) can applied.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-5","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.7 RW2_Seas()","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation} \\begin{split}   & \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\text{N}(\\omega_m \\mid 0, A_{\\omega}^{(m)2}) \\\\   \\quad \\times & \\prod_{u=1}^{U_m} \\left( \\text{N}(\\alpha_{u,2}^{(m)} \\mid 0, (A_{\\eta}^{(m)})^2 ) \\prod_{v=3}^{V_m} \\text{N}(\\alpha_{u,v}^{(m)} \\mid 2 \\alpha_{u,v-1}^{(m)} - \\alpha_{u,v-2}^{(m)}, \\tau_m^2 ) \\prod_{v=1}^{S_m-1}  \\text{N}(\\lambda_{u,v}^{(m)} \\mid 0, (A_{\\lambda}^{(m)})^2) \\\\   \\prod_{v > S_m, \\; v \\;\\text{mod}\\; S_m \\neq 0}^{V_m} \\text{N}(\\lambda_{u,v}^{(m)} \\mid \\lambda_{u,v-S_m}^{(m)}, \\omega_m^2) \\right)   \\end{split} \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-5","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.7 RW2_Seas()","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\alpha_{J_m+h}^{(m)} & \\sim \\text{N}(2 \\alpha_{J_m+h-1}^{(m)} - \\alpha_{J_m+h-2}^{(m)}, \\tau_m^2) \\\\   \\lambda_{J_m+h}^{(m)} & \\sim \\text{N}(\\lambda_{J_m+h-S_m}^{(m)}, \\omega_m^2) \\\\   \\beta_{J_m+h}^{(m)} & = \\alpha_{J_m+h}^{(m)} + \\lambda_{J_m+h}^{(m)} \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-5","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.7 RW2_Seas()","what":"Code","title":"2. Mathematical Details","text":"n \\(S_m\\) s \\(A_{\\tau}^{(m)}\\) s_seas \\(A_{\\omega}^{(m)}\\) along used identify ‘along’ ‘’ dimensions","code":"RW2_Seas(n, s = 1, s_seas = 1, along = NULL)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-6","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.8 AR()","what":"Model","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\beta_{u,v}^{(m)} \\sim \\text{N}\\left(\\phi_1^{(m)} \\beta_{u,v-1}^{(m)} + \\cdots + \\phi_{K_m}^{(m)} \\beta_{u,v-{K_m}}^{(m)},  \\omega_m^2\\right), \\quad u = 1, \\cdots, U_m, \\quad v = K_m + 1, \\cdots, V_m. \\end{equation}\\] Internally, TMB derives values \\(\\beta_{u,v}^{(m)}, v = 1, \\cdots, K_m\\), \\(\\omega_m\\), imply stationary distribution, give every term \\(\\beta_{u,v}^{(m)}\\) marginal variance. denote marginal variance \\(\\tau_m^2\\), assign prior \\[\\begin{equation}   \\tau_m  \\sim \\text{N}^+(0, A_{\\tau}^{(m)2}). \\end{equation}\\] individual \\(\\phi_k^{(m)}\\) restricted interval \\((-1, 1)\\), \\(\\phi_k^{(m)}\\) jointly restricted values yield stationary models. Let \\[\\begin{equation}   r^{(m)} = \\sqrt{\\phi_1^{(m)2} + \\cdots + \\phi_{K_m}^{(m)2}}. \\end{equation}\\] assign \\(r^{(m)}\\) prior \\[\\begin{equation}   r^{(m)} \\sim \\text{Beta}(2, 2). \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-6","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.8 AR()","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\text{N}^+\\left(\\tau_m \\mid 0, A_{\\tau}^{(m)2} \\right) \\text{Beta}\\left( r^{(m)} \\mid 2, 2 \\right) \\prod_{u=1}^{U_m} p\\left( \\beta_{u,1}^{(m)}, \\cdots, \\beta_{u,V_m}^{(m)} \\mid \\phi_1^{(m)}, \\cdots, \\phi_{K_m}^{(m)}, \\tau_m \\right) \\end{equation}\\] \\(p\\left( \\beta_{u,1}^{(m)}, \\cdots, \\beta_{u,V_m}^{(m)} \\mid \\phi_1^{(m)}, \\cdots, \\phi_{K_m}^{(m)}, \\tau_m \\right)\\) calculated internally TMB.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-6","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.8 AR()","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\beta_{u,V_m + h}^{(m)} \\sim \\text{N}\\left(\\phi_1^{(m)} \\beta_{u,V_m + h - 1}^{(m)} + \\cdots + \\phi_{K_m}^{(m)} \\beta_{u,V_m+h-K_m}^{(m)}, \\tau_m^2\\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-6","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.8 AR()","what":"Code","title":"2. Mathematical Details","text":"n \\(K_m\\) s \\(A_{\\tau}^{(m)}\\) along used indentify ‘along’ ‘’ dimensions","code":"AR(n = 2, s = 1, along = NULL)"},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:pr-ar1","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions","what":"AR1()","title":"2. Mathematical Details","text":"Special case AR, extra options autocorrelation coefficient.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-7","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.9 AR1()","what":"Model","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\beta_{u,1}^{(m)} & \\sim \\text{N}(0, \\tau_m^2), \\quad u = 1, \\cdots, U_m \\\\   \\beta_{u,v}^{(m)} & \\sim \\text{N}(\\phi_m \\beta_{u,v-1}^{(m)}, (1 - \\phi_m^2) \\tau_m^2), \\quad u = 1, \\cdots, U_m, \\quad v = 2, \\cdots, V_m \\\\   \\phi_m & = a_{0,m} + (a_{1,m} - a_{0,m}) \\phi_m^{\\prime} \\\\   \\phi_m^{\\prime} & \\sim \\text{Beta}(2, 2) \\\\   \\tau_m & \\sim \\text{N}^+\\left(0, A_{\\tau}^{(m)2}\\right). p\\end{align}\\] adapted specification used AR1 densities TMB. implies marginal variance \\(\\beta_{u,v}^{(m)}\\) \\(\\tau_m^2\\). require \\(-1 < a_{0m} < a_{1m} < 1\\).","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-7","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.9 AR1()","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\text{Beta}( \\phi_m^{\\prime} \\mid 2, 2) \\prod_{u=1}^{U_m} \\text{N}\\left(\\beta_{u,1}^{(m)} \\mid 0, \\tau_m^2 \\right)  \\prod_{u=1}^{U_m} \\prod_{j=2}^{V_m} \\text{N}\\left(\\beta_{u,v}^{(m)} \\mid \\phi_m \\beta_{u,v-1}^{(m)}, (1 - \\phi_m^2) \\tau_m^2 \\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-7","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.9 AR1()","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\beta_{J_m + h}^{(m)} \\sim \\text{N}\\left(\\phi_m \\beta_{J_m + h - 1}^{(m)}, (1 - \\phi_m^2) \\tau_m^2\\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-7","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.9 AR1()","what":"Code","title":"2. Mathematical Details","text":"min \\(a_{0m}\\) max \\(a_{1m}\\) s \\(A_{\\tau}^{(m)}\\). Defaults 1. along used identify ‘along’ ‘’ dimensions defaults min max based defaults function ets() R package forecast (Hyndman Khandakar 2008).","code":"AR1(min = 0.8, max = 0.98, s = 1, along = NULL)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-8","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.10 Lin()","what":"Model","title":"2. Mathematical Details","text":"Existing version \\[\\begin{align}   \\beta_{u,v}^{(m)} & \\sim \\text{N}(\\alpha_u^{(m)} + v \\eta_u^{(m)}, \\tau_m^2), \\quad u = 1,\\cdots,U_m, \\quad v = 1, \\cdots, V_m  \\\\   \\alpha_u^{(m)} & \\sim \\text{N}(0, 1), \\quad u = 1,\\cdots,U_m  \\\\   \\eta_u^{(m)} & \\sim \\text{N}\\left(0, (A_{\\eta}^{(m)})^2\\right), \\quad u = 1, \\cdots, U_m \\\\   \\tau_m & \\sim \\text{N}^+\\left(0, (A_{\\tau}^{(m)})^2\\right) \\end{align}\\] Suggested new version \\[\\begin{align}   \\beta_{u,v}^{(m)} & \\sim \\text{N}(\\alpha_u^{(m)} + v \\eta_u^{(m)}, \\tau_m^2), \\quad u = 1,\\cdots,U_m, \\quad v = 1, \\cdots, V_m  \\\\   \\eta_u^{(m)} & \\sim \\text{N}\\left(B_{\\eta}^{(m)}, (A_{\\eta}^{(m)})^2\\right), \\quad u = 1, \\cdots, U_m \\\\   \\alpha_u^{(m)} & = -\\frac{V_m + 1}{2} \\eta_u^{(m)}, \\quad u = 1,\\cdots,U_m  \\\\   \\tau_m & \\sim \\text{N}^+\\left(0, (A_{\\tau}^{(m)})^2\\right) \\end{align}\\] \\(B_{\\eta}^{(m)}\\) \\(A_{\\eta}^{(m)}\\) default 0 1, though alternatives can supplied user, via informative priors (instance, \\(B_{\\eta}^{(m)} = -0.01\\), similar, mortality) Note new version \\[\\begin{equation} E \\sum_{v=1}^{V_m} \\beta_{u,v}^{(m)} = \\sum_{v=1}^{V_m}\\left(-\\frac{V_m + 1}{2} \\eta_u^{(m)} + v \\eta_u^{(m)}\\right) = 0 \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-8","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.10 Lin()","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\prod_{u=1}^{U_m} \\text{N}(\\alpha_u^{(m)} \\mid 0, 1) \\text{N}(\\eta_u^{(m)} \\mid 0, A_{\\eta}^{(m)2}) \\prod_{u=1}^{U_m} \\prod_{v=1}^{V_m} \\text{N}\\left(\\beta_{u,v}^{(m)} | \\alpha_u^{(m)} + v \\eta_u^{(m)}, \\tau_m^2 \\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-8","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.10 Lin()","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\beta_{u,V_m + h}^{(m)} \\sim \\text{N}(\\alpha_u^{(m)} + (V_m + h) \\eta_u^{(m)}, \\tau_m^2) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-8","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.10 Lin()","what":"Code","title":"2. Mathematical Details","text":"s \\(A_{\\tau}^{(m)}\\) sd \\(A_{\\eta}^{(m)}\\) along used indentify ‘along’ ‘’ dimensions","code":"Lin(s = 1, sd = 1, along = NULL)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-9","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.11 Lin_AR()","what":"Model","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\beta_{u,v}^{(m)} & = \\alpha_u^{(m)} + \\eta_u^{(m)} v + \\epsilon_{u,v}^{(m)}, \\quad u = 1, \\cdots, U_m, \\quad v = 1, \\cdots, V_m \\\\   \\alpha_u^{(m)} & \\sim \\text{N}\\left(0, 1\\right), \\quad u = 1, \\cdots, U_m \\\\   \\eta_u^{(m)} & \\sim \\text{N}\\left(0, A_{\\eta}^{(m)2}\\right), \\quad u = 1, \\cdots, U_m \\\\   \\epsilon_{u,v}^{(m)} & \\sim \\text{N}\\left(\\phi_1^{(m)} \\epsilon_{u,v-1}^{(m)} + \\cdots + \\phi_{K_m}^{(m)} \\epsilon_{u,v-{K_m}}^{(m)},  \\omega_m^2\\right), \\quad u = 1, \\cdots, U_m, \\quad v = K_m + 1, \\cdots, V_m. \\end{align}\\] Internally, TMB derives values \\(\\epsilon_{u,v}^{(m)}, v = 1, \\cdots, K_m\\), \\(\\omega_m\\), provide \\(\\epsilon_{u,v}^{(m)}\\) stationary distribution term marginal variance. denote marginal variance \\(\\tau_m^2\\), assign prior \\[\\begin{equation}   \\tau_m  \\sim \\text{N}^+(0, A_{\\tau}^{(m)2}). \\end{equation}\\] individual \\(\\phi_k^{(m)}\\) restricted interval \\((-1, 1)\\), \\(\\phi_k^{(m)}\\) jointly restricted values yield stationary models. Let \\[\\begin{equation}   r^{(m)} = \\sqrt{\\phi_1^{(m)2} + \\cdots + \\phi_{K_m}^{(m)2}}. \\end{equation}\\] assign \\(r^{(m)}\\) prior \\[\\begin{equation}   r^{(m)} \\sim \\text{Beta}(2, 2). \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-9","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.11 Lin_AR()","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\text{N}^+\\left(\\tau_m \\mid 0, A_{\\tau}^{(m)2} \\right) \\text{Beta}\\left( r_k^{(m)} \\mid 2, 2 \\right) \\prod_{u=1}^{U_m} \\text{N}(\\alpha_u^{(m)} \\mid 0, 1) \\text{N}(\\eta_u^{(m)} \\mid 0, A_{\\eta}^{(m)2}) p\\left( \\epsilon_{u,1}^{(m)}, \\cdots, \\epsilon_{u,V_m}^{(m)} \\mid \\phi_1^{(m)}, \\cdots, \\phi_{K_m}^{(m)}, \\tau_m \\right) \\end{equation}\\] \\(p\\left( \\epsilon_{u,1}^{(m)}, \\cdots, \\epsilon_{u,V_m}^{(m)} \\mid \\phi_1^{(m)}, \\cdots, \\phi_{K_m}^{(m)}, \\tau_m \\right)\\) calculated internally TMB.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-9","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.11 Lin_AR()","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\beta_{u, V_m + h}^{(m)} & = \\alpha_u^{(m)} + \\eta_u^{(m)} (V_m + h) + \\epsilon_{u,V_m+h}^{(m)} \\\\   \\epsilon_{u,V_m+h}^{(m)} & \\sim \\text{N}\\left(\\phi_1^{(m)} \\epsilon_{u,V_m + h - 1}^{(m)} + \\cdots + \\phi_{K_m}^{(m)} \\epsilon_{u,V_m+h-K_m}^{(m)}, \\omega_m^2\\right) \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-9","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.11 Lin_AR()","what":"Code","title":"2. Mathematical Details","text":"s \\(A_{\\tau}^{(m)}\\) sd \\(A_{\\eta}^{(m)}\\) along used indentify ‘along’ ‘’ variables","code":"Lin_AR(s = 1, sd = 1, along = NULL)"},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:pr-lin-ar-1","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions","what":"Lin_AR()","title":"2. Mathematical Details","text":"TODO - WRITE DETAILS","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-10","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.13 Sp()","what":"Model","title":"2. Mathematical Details","text":"Penalised spline (P-spline) \\[\\begin{equation}   \\pmb{\\beta}_u^{(m)} = \\pmb{B}^{(m)} \\pmb{\\alpha}_u^{(m)}, \\quad u = 1, \\cdots, U_m \\end{equation}\\] \\(\\pmb{\\beta}_u^{(m)}\\) subvector \\(\\pmb{\\beta}^{(m)}\\) composed elements \\(u\\)th combination ‘’ variables, \\(\\pmb{B}^{(m)}\\) \\(V_m \\times K_m\\) matrix B-splines, \\(\\pmb{\\alpha}_u^{(m)}\\) second-order random walk prior (Section 5.5). \\(\\pmb{B}^{(m)} = (\\pmb{b}_1^{(m)}(\\pmb{v}), \\cdots, \\pmb{b}_{K_m}^{(m)}(\\pmb{v}))\\), \\(\\pmb{v} = (1, \\cdots, V_m)^{\\top}\\). B-splines centered, \\(\\pmb{1}^{\\top} \\pmb{b}_k^{(m)}(\\pmb{v}) = 0\\), \\(k = 1, \\cdots, K_m\\).","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-10","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.13 Sp()","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\prod_{u=1}^{U_m} \\prod_{k=1}^2 \\text{N}(\\alpha_{u,k}^{(m)} \\mid 0, 1) \\prod_{u=1}^{U_m}\\prod_{k=3}^{K_m} \\text{N}\\left(\\alpha_{u,k}^{(m)} - 2 \\alpha_{u,k-1}^{(m)} + \\alpha_{u,k-2}^{(m)} \\mid 0, \\tau_m^2 \\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-10","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.13 Sp()","what":"Forecasting","title":"2. Mathematical Details","text":"Terms P-Spline prior forecasted.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-10","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.13 Sp()","what":"Code","title":"2. Mathematical Details","text":"n \\(K_m\\). Defaults \\(\\max(0.7 J_m, 4)\\). s \\(A_{\\tau}^{(m)}\\) second-order random walk prior. Defaults 1. along used identify ‘along’ ‘’ variables","code":"Sp(n = NULL, s = 1)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-11","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.14 SVD()","what":"Model","title":"2. Mathematical Details","text":"Age sex gender Let \\(\\pmb{\\beta}_u\\) age effect \\(u\\)th combination ‘’ variables. SVD prior, \\[\\begin{equation}   \\pmb{\\beta}_u^{(m)} = \\pmb{F}^{(m)} \\pmb{\\alpha}_u^{(m)} + \\pmb{g}^{(m)}, \\quad u = 1, \\cdots, U_m \\end{equation}\\] \\(\\pmb{F}^{(m)}\\) \\(V_m \\times K_m\\) matrix, \\(\\pmb{g}^{(m)}\\) vector \\(V_m\\) elements, derived singular value decomposition (SVD) external dataset age-specific values sexes/genders combined. construction \\(\\pmb{F}^{(m)}\\) \\(\\pmb{g}^{(m)}\\) described Appendix 13.2. centering scaling used construction allow use simple prior \\[\\begin{equation}   \\alpha_{u,k}^{(m)} \\sim \\text{N}(0, 1), \\quad u = 1, \\cdots, U_m, k = 1, \\cdots, K_m. \\end{equation}\\] Joint model age sex/gender joint model, vector \\(\\pmb{\\beta}_u\\) represents interaction age sex/gender \\(u\\)th combination ‘’ variables. Matrix \\(\\pmb{F}^{(m)}\\) vector \\(\\pmb{g}^{(m)}\\) calculated data separate sexes/genders. model otherwise unchanged. Independent models sex/gender independent model, vector \\(\\pmb{\\beta}_{s,u}\\) represents age effects sex/gender \\(s\\) \\(u\\)th combination ‘’ variables, \\[\\begin{equation}   \\pmb{\\beta}_{s,u}^{(m)} = \\pmb{F}_s^{(m)} \\pmb{\\alpha}_{s,u}^{(m)} + \\pmb{g}_s^{(m)}, \\quad s = 1, \\cdots, S; \\quad u = 1, \\cdots, U_m \\end{equation}\\] Matrix \\(\\pmb{F}_s^{(m)}\\) vector \\(\\pmb{g}_s^{(m)}\\) calculated data separate sexes/genders. prior \\[\\begin{equation}   \\alpha_{s,u,k}^{(m)} \\sim \\text{N}(0, 1), \\quad s = 1, \\cdots, S; \\quad u = 1, \\cdots, U_m; \\quad k = 1, \\cdots, K_m. \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-11","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.14 SVD()","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   \\prod_{u=1}^{U_m}\\prod_{k=1}^{K_m} \\text{N}\\left(\\alpha_{uk}^{(m)} \\mid 0, 1 \\right) \\end{equation}\\] age-joint models, \\[\\begin{equation}   \\prod_{s=1}^S \\prod_{u=1}^{U_m}\\prod_{k=1}^{K_m} \\text{N}\\left(\\alpha_{s,u,k}^{(m)} \\mid 0, 1 \\right) \\end{equation}\\] independent model","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-11","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.14 SVD()","what":"Forecasting","title":"2. Mathematical Details","text":"Terms SVD prior forecasted.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-11","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.14 SVD()","what":"Code","title":"2. Mathematical Details","text":"- ssvd object containing \\(\\pmb{F}\\) \\(\\pmb{g}\\) - n_comp number components used (defaults ceiling(n/2), n number components ssvd - indep determines whether independent joint model used term modelled contains sex gender variable.","code":"SVD(ssvd, n_comp = NULL, indep = TRUE)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-12","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.15 SVD_RW()","what":"Model","title":"2. Mathematical Details","text":"SVD_RW() prior identical SVD() prior except coefficients evolve time, following independent random walks. instance, combined-sex/gender joint models, \\[\\begin{align}   \\pmb{\\beta}_{u,t}^{(m)} & = \\pmb{F}^{(m)} \\pmb{\\alpha}_{u,t}^{(m)} + \\pmb{g}^{(m)}, \\quad u = 1, \\cdots, U_m; \\quad t = 1, \\cdots, T \\\\   \\alpha_{u,k,1}^{(m)} & \\sim \\text{N}(0, 1), \\quad u = 1, \\cdots, U_m, k = 1, \\cdots, K_m \\\\   \\alpha_{u,k,t}^{(m)} & \\sim \\text{N}(\\alpha_{u,k,t-1}^{(m)}, \\tau_m^2), \\quad u = 1, \\cdots, U_m, k = 1, \\cdots, K_m; t = 2, \\cdots, T \\\\   \\tau_m & \\sim \\text{N}^+\\left(0, A_{\\tau}^{(m)2}\\right) \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-12","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.15 SVD_RW()","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"combined-sex/gender joint models, \\[\\begin{equation}   \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\prod_{u=1}^{U_m} \\prod_{k=1}^{K_m} \\text{N}(\\alpha_{u,k,1}^{(m)} \\mid 0, 1)  \\prod_{t=2}^{T} \\text{N}\\left(\\alpha_{u,k,t}^{(m)} \\mid \\alpha_{u,k,t-1}^{(m)}, \\tau_m^2 \\right), \\end{equation}\\] independent model, \\[\\begin{equation}   \\text{N}(\\tau_m \\mid 0, A_{\\tau}^{(m)2}) \\prod_{u=1}^{U_m} \\prod_{s=1}^{S} \\prod_{k=1}^{K_m} \\text{N}(\\alpha_{u,s,k,1}^{(m)} \\mid 0, 1)  \\prod_{t=2}^{T} \\text{N}\\left(\\alpha_{u,s,k,t}^{(m)} \\mid \\alpha_{u,s,k,t-1}^{(m)}, \\tau_m^2 \\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"simulation","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.15 SVD_RW()","what":"Simulation","title":"2. Mathematical Details","text":"TODO - write","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-12","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.15 SVD_RW()","what":"Forecasting","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\alpha_{u,k,T+h}^{(m)} & \\sim \\text{N}(\\alpha_{u,k,T+h-1}^{(m)}, \\tau_m^2), \\quad u = 1, \\cdots, U_m; \\quad k = 1, \\cdots, K_m \\\\   \\pmb{\\beta}_{u,T+h}^{(m)} & = \\pmb{F}^{(m)} \\pmb{\\alpha}_{u,T+h}^{(m)} + \\pmb{g}^{(m)}, \\quad u = 1, \\cdots, U_m \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-12","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.15 SVD_RW()","what":"Code","title":"2. Mathematical Details","text":"- ssvd object containing \\(\\pmb{F}\\) \\(\\pmb{g}\\) - n_comp \\(K_m\\) (defaults ceiling(n/2), n number components ssvd - s \\(A_{\\tau}^{(m)}\\) - indep determines whether independent joint model used term modelled contains sex gender variable.","code":"SVD_RW(ssvd, n_comp = NULL, s = 1, indep = TRUE)"},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:pr-svd-rw2","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions","what":"SVD_RW2()","title":"2. Mathematical Details","text":"structure SVD_RW(). TODO - write details.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:pr-svd-ar","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions","what":"SVD_AR()","title":"2. Mathematical Details","text":"structure SVD_RW(). TODO - write details.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:pr-svd-ar1","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions","what":"SVD_AR1()","title":"2. Mathematical Details","text":"structure SVD_RW(). TODO - write details.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-13","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.19 Known","what":"Model","title":"2. Mathematical Details","text":"Elements \\(\\pmb{\\beta}^{(m)}\\) treated known certainty.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-13","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.19 Known","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"Known priors make contribution posterior density.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-13","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.19 Known","what":"Forecasting","title":"2. Mathematical Details","text":"Main effects known prior forecasted.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-13","dir":"Articles","previous_headings":"5 Priors for Intercept, Main Effects, and Interactions > 5.19 Known","what":"Code","title":"2. Mathematical Details","text":"values vector containing \\(\\beta_j^{(m)}\\).","code":"Known(values)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-14","dir":"Articles","previous_headings":"6 Covariates","what":"Model","title":"2. Mathematical Details","text":"columns matrix \\(\\pmb{Z}\\) assumed standardised mean 0 standard deviation 1. \\(\\pmb{Z}\\) contain column intercept. implement two priors coefficient vector \\(\\pmb{\\zeta}\\). first prior designed case \\(P\\), number colums \\(\\pmb{Z}\\), small, \\(\\zeta_p\\) likely distinguishable zero. second prior designed case \\(P\\) large, \\(\\zeta_p\\) likely distinguishable zero.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"standard-prior","dir":"Articles","previous_headings":"6 Covariates > 6.1 Model","what":"Standard prior","title":"2. Mathematical Details","text":"\\[\\begin{align}   \\zeta_p \\mid \\varphi & \\sim \\text{N}(0, \\varphi^2) \\\\   \\varphi & \\sim \\text{N}^+(0, 1) \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"shrinkage-prior","dir":"Articles","previous_headings":"6 Covariates > 6.1 Model","what":"Shrinkage prior","title":"2. Mathematical Details","text":"Regularized horseshoe prior (Piironen Vehtari 2017) \\[\\begin{align}   \\zeta_p \\mid \\vartheta_p, \\varphi & \\sim \\text{N}(0, \\vartheta_p^2 \\varphi^2) \\\\   \\vartheta_p & \\sim \\text{Cauchy}^+(0, 1) \\\\   \\varphi & \\sim \\text{Cauchy}^+(0, A_{\\varphi}^2) \\\\   A_{\\varphi} & = \\frac{p_0}{p_0 + P} \\frac{\\hat{\\sigma}}{\\sqrt{n}} \\end{align}\\] \\(p_0\\) initial guess number \\(\\zeta_p\\) non-zero, \\(\\hat{\\sigma}\\) obtained follows: Poisson. Using maximum likelihood, fit GLM \\[\\begin{align} y_i & \\sim \\text{Poisson}(w_i \\gamma_i) \\\\ \\log \\gamma_i & = \\sum_{m=0}^{M} \\pmb{X}^{(m)} \\pmb{\\beta}^{(m)}, \\end{align}\\] set \\[\\begin{equation} \\hat{\\sigma} = \\frac{1}{n}\\sum_{=1}^n \\frac{1}{w_i \\hat{\\gamma}_i}. \\end{equation}\\] Binomial. Using maximum likelihood, fit GLM \\[\\begin{align} y_i & \\sim \\text{binomial}(w_i, \\gamma_i) \\\\ \\text{logit} \\gamma_i & = \\sum_{m=0}^{M} \\pmb{X}^{(m)} \\pmb{\\beta}^{(m)}, \\end{align}\\] set \\[\\begin{equation} \\hat{\\sigma} = \\frac{1}{n}\\sum_{=1}^n \\frac{1}{w_i \\hat{\\gamma}_i (1 - \\hat{\\gamma}_i)}. \\end{equation}\\] Normal. Using maximum likelihood, fit linear model \\[\\begin{equation} y_i \\sim \\text{N}\\left(\\sum_{m=0}^{M} \\pmb{X}^{(m)} \\pmb{\\beta}^{(m)}, w_i^{-1}\\xi^2 \\right) \\end{equation}\\] set \\(\\hat{\\sigma} = \\hat{\\xi}\\). quantities used Poisson binomial likelihoods derived normal approximations GLMs (Piironen Vehtari 2017; Gelman et al. 2014, sec. 16.2).","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-posterior-density-14","dir":"Articles","previous_headings":"6 Covariates","what":"Contribution to posterior density","title":"2. Mathematical Details","text":"TODO - write","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"forecasting-14","dir":"Articles","previous_headings":"6 Covariates","what":"Forecasting","title":"2. Mathematical Details","text":"TODO - write","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-14","dir":"Articles","previous_headings":"6 Covariates","what":"Code","title":"2. Mathematical Details","text":"formula one-sided R formula describing covariates used data data frame. value data supplied, formula interpreted context data frame. value data supplied, formula interpreted context data frame used original call mod_pois(), mod_binom(), mod_norm(). n_coef effective number non-zero coefficients. value supplied, shrinkage prior used; otherwise standard prior used. Examples:","code":"set_covariates(formula, data = NULL, n_coef = NULL) set_covariates(~ mean_income + distance * employment) set_covariates(~ ., data = cov_data, n_coef = 5)"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"model-15","dir":"Articles","previous_headings":"7 Prior for dispersion terms","what":"Model","title":"2. Mathematical Details","text":"Use exponential distribution, parameterised using mean, \\[\\begin{equation}   \\xi \\sim \\text{Exp}(\\mu_{\\xi}) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"contribution-to-prior-density","dir":"Articles","previous_headings":"7 Prior for dispersion terms","what":"Contribution to prior density","title":"2. Mathematical Details","text":"\\[\\begin{equation}   p(\\xi) = \\frac{1}{\\mu_{\\xi}} \\exp\\left(\\frac{-\\xi}{\\mu_{\\xi}}\\right) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-15","dir":"Articles","previous_headings":"7 Prior for dispersion terms","what":"Code","title":"2. Mathematical Details","text":"mean \\(\\mu_{\\xi}\\)","code":"set_disp(mean = 1)"},{"path":[]},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"random-rounding-to-base-3","dir":"Articles","previous_headings":"8 Data models > 8.1 Data models for outcome","what":"Random Rounding to Base 3","title":"2. Mathematical Details","text":"Random rounding base 3 (RR3) confidentialization method used statistical agencies. applied counts data. count \\(x\\) rounded randomly follows: \\(x \\mod 3 = 0\\), \\(x\\) left unchanged; \\(x \\mod 3 = 1\\) \\(x\\) changed \\(x-1\\) probability 2/3, changed \\(x + 2\\) probability 1/3; \\(x \\mod 3 = 2\\) \\(x\\) changed \\(x-2\\) probability 1/3, changed \\(x + 1\\) probability 2/3. RR3 data models can used Poisson binomial likelihoods. Let \\(y_i\\) denote observed value outcome, \\(y_i^*\\) true value. likelihood RR3 data model \\[\\begin{align}   p(y_i | \\gamma_i, w_i) & = \\sum_{y_i^*} p(y_i | y_i^*) p(y_i^* | \\gamma_i, w_i) \\\\    & =  \\sum_{k = -2, -1, 0, 1, 2} p(y_i | y_i + k) p(y_i + k | \\gamma_i, w_i) \\\\    & = \\tfrac{1}{3} p(y_i - 2 | \\gamma_i, w_i) + \\tfrac{2}{3} p(y_i - 1 | \\gamma_i, w_i) + p(y_i | \\gamma_i, w_i) + \\tfrac{2}{3} p(y_i + 1 | \\gamma_i, w_i) + \\tfrac{1}{3} p(y_i + 2 | \\gamma_i, w_i) \\end{align}\\]","code":""},{"path":[]},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"sec:filter-ag","dir":"Articles","previous_headings":"9 Estimation","what":"Filtering and Aggregation","title":"2. Mathematical Details","text":"data supply TMB filtered aggregated version data user provides data argument. filtering stage, remove rows () offset 0 NA, (ii) outcome variable NA. aggregation stage, identify rows data duplicated combinations classification variables. instance, classification variables age sex, two rows age \"20-24\" sex \"Female\", rows count duplicated combinations. aggregate offset outcome variables across duplicates. Poisson binomial models, aggregation formula outcomes \\[\\begin{equation}   y^{\\text{new}} = \\sum_{=1}^D y_i^{\\text{old}}, \\end{equation}\\] aggregation formula exposure/size \\[\\begin{equation}   w^{\\text{new}} = \\sum_{=1}^D w_i^{\\text{old}}, \\end{equation}\\] \\(D\\) number times particular combination duplicated. normal models, aggregation formula outcomes \\[\\begin{equation}   y^{\\text{new}} = \\frac{\\sum_{=1}^D y_i^{\\text{old}}}{D}, \\end{equation}\\] aggregation formuala weights \\[\\begin{equation}   w^{\\text{new}} = \\frac{1}{\\sum_{=1}^D \\frac{1}{w_i^{\\text{old}}}}. \\end{equation}\\]","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"step-0-select-inner-and-outer-variables","dir":"Articles","previous_headings":"9 Estimation > 9.2 Inner-Outer Approximation","what":"Step 0: Select ‘inner’ and ‘outer’ variables","title":"2. Mathematical Details","text":"Select variables used inner model. default, age, sex, time variables model. remaining variables ‘outer’ variables.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"step-1-fit-inner-model","dir":"Articles","previous_headings":"9 Estimation > 9.2 Inner-Outer Approximation","what":"Step 1: Fit inner model","title":"2. Mathematical Details","text":"Aggregate data using classification formed inner variables. (See Section 9.1 aggregation procedures.) Remove terms involving ‘inner’ variables, intercept term, model. Set dispersion 0. Fit resulting model.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"step-2-fit-outer-model","dir":"Articles","previous_headings":"9 Estimation > 9.2 Inner-Outer Approximation","what":"Step 2: Fit outer model","title":"2. Mathematical Details","text":"Let \\(\\hat{\\mu}_i^{\\text{}}\\) point estimates linear predictor \\(\\mu_i\\) obtained inner model. Poisson model Aggregate data using classification formed outer variables. Remove terms involving ‘inner’ variables, plus intercept, model. Set dispersion 0. Set exposure \\(w_i^{\\text{}} = \\hat{\\mu}^{\\text{}} w_i\\). Fit model. Binomial model Fit original model, set dispersion 0, terms ‘inner’ model, use Known priors using point estimates inner model. Normal model Aggregate data using classification formed outer variables. Remove terms involving ‘inner’ variables, plus intercept, model. Set outcome variable $y_i^{} = y_i - ^{}. Fit model.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"step-4-concatenate-estimates","dir":"Articles","previous_headings":"9 Estimation > 9.2 Inner-Outer Approximation","what":"Step 4: Concatenate estimates","title":"2. Mathematical Details","text":"Concatenate posterior distributions inner terms inner model posterior distributions outer terms outer model.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"step-5-calculate-dispersion","dir":"Articles","previous_headings":"9 Estimation > 9.2 Inner-Outer Approximation","what":"Step 5: Calculate dispersion","title":"2. Mathematical Details","text":"original model includes dispersion term, estimate dispersion. Let \\(\\hat{\\mu}_i^{\\text{comb}}\\) point estimates linear predictor obtained concatenated estimates. Poisson model Use original disaggregated data, , original data contains 10,000 rows, select 10,000 rows random original data. Remove terms original model except intercept. Set exposure \\(w_i^{\\text{}} = \\hat{\\mu}^{\\text{comb}} w_i\\). Binomial model Fit original model, terms except intercept Known priors, values obtained point estimates concatenated estimates. Normal model Use original disaggregated data, , original data contains 10,000 rows, select 10,000 rows random original data. Remove terms original model except intercept. Set outcome \\(y_i^{\\text{}} = y_i - \\hat{\\mu}^{\\text{comb}}\\).","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"deriving-outputs","dir":"Articles","previous_headings":"","what":"Deriving outputs","title":"2. Mathematical Details","text":"Running TMB yields set means \\(\\pmb{m}\\), precision matrix \\(\\pmb{Q}^{-1}\\), together define approximate joint posterior distribution \\(\\pmb{\\beta}^{(m)}\\) terms independent normal, fixed normal, multivariate normal, random walk, second-order random walk, AR1, Linear, Linear-AR1 priors, \\(\\pmb{\\alpha}\\) terms Spline SVD priors, hyper-parameters \\(\\pmb{\\beta}^{(m)}\\) \\(\\pmb{\\alpha}^{(m)}\\) typically transformed another scale, log scale, dispersion term \\(\\xi\\), seasonal effects \\(\\pmb{\\lambda}\\), together associated hyper-parameters \\(\\tau_{\\lambda}\\) (log scale). use \\(\\tilde{\\pmb{\\theta}}\\) denote vector containing quantities. perform Cholesky decomposition \\(\\pmb{Q}^{-1}\\), obtain \\(\\pmb{R}\\) \\[\\begin{equation}   \\pmb{R}^{\\top} \\pmb{R} = \\pmb{Q}^{-1} \\end{equation}\\] store \\(\\pmb{R}\\) part model object. draw generate values \\(\\tilde{\\pmb{\\theta}}\\) generating vector standard normal variates \\(\\pmb{z}\\), back-solving equation \\[\\begin{equation}   \\pmb{R} \\pmb{v} = \\pmb{z} \\end{equation}\\] setting \\[\\begin{equation}   \\tilde{\\pmb{\\theta}} = \\pmb{v} + \\pmb{m}. \\end{equation}\\] Next convert transformed hyper-parameters back original units, insert values \\(\\pmb{\\beta}^{(m)}\\) terms Known priors. denote resulting vector \\(\\pmb{\\theta}\\). Finally draw distribution \\(\\pmb{\\gamma} \\mid \\pmb{y}, \\pmb{\\theta}\\) using methods described Sections 3.1-3.3.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"simulation-1","dir":"Articles","previous_headings":"","what":"Simulation","title":"2. Mathematical Details","text":"generate one set simulated values, start values exposure, trials, weights, \\(\\pmb{w}\\), possibly covariates \\(\\pmb{Z}\\), go following steps: Draw values parameters priors \\(\\pmb{\\beta}^{(m)}\\), \\(m = 1, \\cdots, M\\). Conditional values drawn Step 1, draw values \\(\\pmb{\\beta}^{(m)}\\), \\(m = 0, \\cdots, M\\). model contains seasonal effects, draw standard deviation \\(\\kappa_m\\), effects \\(\\pmb{\\lambda}^{(m)}\\). model contains covariates, draw \\(\\varphi\\) \\(\\vartheta_p\\) necessary, draw coefficient vector \\(\\pmb{\\zeta}\\). Use values steps 2–4 form linear predictor \\(\\sum_{m=0}^{M} \\pmb{X}^{(m)} (\\pmb{\\beta}^{(m)} + \\pmb{\\lambda}^{(m)}) + \\pmb{Z} \\pmb{\\zeta}\\). Back-transform linear predictor, obtain vector cell-specific parameters \\(\\pmb{\\mu}\\). model contains dispersion parameter \\(\\xi\\), draw values prior \\(\\xi\\). Poisson binomial models, use \\(\\pmb{\\mu}\\) , present, \\(\\xi\\) draw \\(\\pmb{\\gamma}\\). Poisson binomial models, use \\(\\pmb{\\gamma}\\) \\(\\pmb{w}\\) draw \\(\\pmb{y}\\); normal models, use \\(\\pmb{\\mu}\\), \\(\\xi\\), \\(\\pmb{w}\\) draw \\(\\pmb{y}\\).","code":""},{"path":[]},{"path":[]},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"condition-on-pmbgamma","dir":"Articles","previous_headings":"12 Replicate data > 12.1 Model > 12.1.1 Poisson likelihood","what":"Condition on \\(\\pmb{\\gamma}\\)","title":"2. Mathematical Details","text":"\\[\\begin{equation}   y_i^{\\text{rep}} \\sim \\text{Poisson}(\\gamma_i w_i) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"condition-on-pmbmu-xi","dir":"Articles","previous_headings":"12 Replicate data > 12.1 Model > 12.1.1 Poisson likelihood","what":"Condition on \\((\\pmb{\\mu}, \\xi)\\)","title":"2. Mathematical Details","text":"\\[\\begin{align}   y_i^{\\text{rep}} & \\sim \\text{Poisson}(\\gamma_i^{\\text{rep}} w_i) \\\\   \\gamma_i^{\\text{rep}} & \\sim \\text{Gamma}(\\xi^{-1}, (\\xi \\mu_i)^{-1}) \\end{align}\\] equivalent \\[\\begin{equation}   y_i^{\\text{rep}} \\sim \\text{NegBinom}\\left(\\xi^{-1}, (1 + \\mu_i w_i \\xi)^{-1}\\right) \\end{equation}\\]","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"condition-on-pmbgamma-1","dir":"Articles","previous_headings":"12 Replicate data > 12.1 Model > 12.1.2 Binomial likelihood","what":"Condition on \\(\\pmb{\\gamma}\\)","title":"2. Mathematical Details","text":"\\[\\begin{equation}   y_i^{\\text{rep}} \\sim \\text{Binomial}(w_i, \\gamma_i) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"condition-on-pmbmu-xi-1","dir":"Articles","previous_headings":"12 Replicate data > 12.1 Model > 12.1.2 Binomial likelihood","what":"Condition on \\((\\pmb{\\mu}, \\xi)\\)","title":"2. Mathematical Details","text":"\\[\\begin{align}   y_i^{\\text{rep}} & \\sim \\text{Binomial}(w_im \\gamma_i^{\\text{rep}}) \\\\   \\gamma_i^{\\text{rep}} & \\sim \\text{Beta}\\left(\\xi^{-1} \\mu_i, \\xi^{-1}(1 - \\mu_i)\\right) \\end{align}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"normal-likelihood","dir":"Articles","previous_headings":"12 Replicate data > 12.1 Model","what":"Normal likelihood","title":"2. Mathematical Details","text":"\\[\\begin{equation}   y_i^{\\text{rep}} \\sim \\text{N}(\\gamma_i, \\xi^2 / w_i) \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"data-models-for-outcomes","dir":"Articles","previous_headings":"12 Replicate data > 12.1 Model","what":"Data models for outcomes","title":"2. Mathematical Details","text":"overall model includes data model outcome, set draws made, deriving values observed outcomes, given values true outcomes.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"code-16","dir":"Articles","previous_headings":"12 Replicate data","what":"Code","title":"2. Mathematical Details","text":"","code":"replicate_data(x, condition_on = c(\"fitted\", \"expected\"), n = 20)"},{"path":[]},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig2_math.html","id":"app:svd","dir":"Articles","previous_headings":"13 Appendices","what":"SVD prior for age","title":"2. Mathematical Details","text":"Let \\(\\pmb{}\\) matrix age-specific estimates international database, transformed take values range \\((-\\infty, \\infty)\\). column \\(\\pmb{}\\) represents one set age-specific estimates, log mortality rates Japan 2010, logit labour participation rates Germany 1980. Let \\(\\pmb{U}\\), \\(\\pmb{D}\\), \\(\\pmb{V}\\) matrices singular value decomposition \\(\\pmb{}\\), retained first \\(K\\) components. \\[\\begin{equation}   \\pmb{} \\approx \\pmb{U} \\pmb{D} \\pmb{V}. \\tag{13.1} \\end{equation}\\] Let \\(m_k\\) \\(s_k\\) mean sample standard deviation elements \\(k\\)th row \\(\\pmb{V}\\), \\(\\pmb{m} = (m_1, \\cdots, m_k)^{\\top}\\) \\(\\pmb{s} = (s_1, \\cdots, s_k)^{\\top}\\). \\[\\begin{equation}   \\tilde{\\pmb{V}} = (\\text{diag}(\\pmb{s}))^{-1} (\\pmb{V} - \\pmb{m} \\pmb{1}^{\\top}) \\end{equation}\\] standardized version \\(\\pmb{V}\\). can rewrite (13.1) \\[\\begin{align}   \\pmb{} & \\approx \\pmb{U} \\pmb{D} (\\text{diag}(\\pmb{s}) \\tilde{\\pmb{V}} + \\pmb{m} \\pmb{1}^{\\top}) \\\\   & = \\pmb{F} \\tilde{\\pmb{V}} + \\pmb{g} \\pmb{1}^{\\top}, \\tag{13.2} \\end{align}\\] \\(\\pmb{F} = \\pmb{U} \\pmb{D} \\text{diag}(\\pmb{s})\\) \\(\\pmb{g} = \\pmb{U} \\pmb{D} \\pmb{m}\\). Let \\(\\tilde{\\pmb{v}}_l\\) randomly-selected column \\(\\tilde{\\pmb{V}}\\). construction \\(\\tilde{\\pmb{V}}\\) \\(\\text{E}[\\tilde{v}_{kl}] = 0\\) \\(\\text{var}[\\tilde{v}_{kl}] = 1\\). \\(\\pmb{z}\\) vector standard normal variables, \\[\\begin{equation}   \\pmb{F} \\pmb{z} + \\pmb{g} \\end{equation}\\] look approximately like randomly-selected column original data matrix \\(\\pmb{}\\).","code":""},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig5_workflow.html","id":"prior-predictive-checking","dir":"Articles","previous_headings":"","what":"Prior predictive checking","title":"5. Bayesian Workflow","text":"Given model, priors, typically exposure/size term, generate data parts data generating model need stronger priors standard estimation model - eg can’t put weakly informative prior intercept “common Bayesian analysis use models fully generative. example, regression typically model outcome y given predictors x without generative model x.” (Gelman et al 2020: 11-12) [actually model ever fully generative - always assumptions part ] generating data given model priors step 1 simulation study - can re-use functions prior predictive checking simulation studies","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig5_workflow.html","id":"fitting-a-model","dir":"Articles","previous_headings":"","what":"Fitting a model","title":"5. Bayesian Workflow","text":"“generic diagnostic tools described Yao et al. (2018a) Talts et al. (2020) can used verify particular approximate algorithm reproduces features posterior care specific model.”Yao, Y., Vehtari, ., Simpson, D., Gelman, . (2018a). Yes, work?: Evaluating variational inference. Proceedings International Conference Machine Learning, 5581– 5590. Talts, S., Betancourt, M., Simpson, D., Vehtari, ., Gelman, . (2020). Validating Bayesian inference algorithms simulation-based calibration. www.stat.columbia.edu/~gelman/ research/unpublished/sbc.pdf [looks like something might implement] “Laplace approximation can viewed data-dependent linearization desired model” (Gelman et al 2020: 15) “Fit fast, fail fast” [can !]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig5_workflow.html","id":"using-constructed-data-to-find-and-understand-problems","dir":"Articles","previous_headings":"","what":"Using constructed data to find and understand problems","title":"5. Bayesian Workflow","text":"“implies fake data simulation can particularly relevant zone parameter space predictive data. turn suggests two-step procedure first fit model real data, draw parameters resulting posterior distribution use fake-data checking. statistical properties procedure unclear practice found checks helpful, revealing problems computation model, providing reassurance fake-data-based inferences reproduce assumed parameter value.” (Gelman et al 2020: 17)","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig5_workflow.html","id":"addressing-computational-problems","dir":"Articles","previous_headings":"","what":"Addressing computational problems","title":"5. Bayesian Workflow","text":"“Starting simple complex models meeting middle” (Gelman et al 2020: 22-23) - Easy bage - eg number terms, complexity priors","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig5_workflow.html","id":"evaluating-and-using-a-fitted-model","dir":"Articles","previous_headings":"","what":"Evaluating and using a fitted model","title":"5. Bayesian Workflow","text":"bayesplot package tools posterior predictive checking [need generate outputs can fed plots]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig5_workflow.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"5. Bayesian Workflow","text":"@article{gelman2020bayesian, title={Bayesian workflow}, author={Gelman, Andrew Vehtari, Aki Simpson, Daniel Margossian, Charles C Carpenter, Bob Yao, Yuling Kennedy, Lauren Gabry, Jonah B{\"u}rkner, Paul-Christian Modr{'}k, Martin}, journal={arXiv preprint arXiv:2011.01808}, year={2020} } @article{van2021bayesian, title={Bayesian statistics modelling}, author={van de Schoot, Rens Depaoli, Sarah King, Ruth Kramer, Bianca M{\"}rtens, Kaspar Tadesse, Mahlet G Vannucci, Marina Gelman, Andrew Veen, Duco Willemsen, Joukje others}, journal={Nature Reviews Methods Primers}, volume={1}, number={1}, pages={1}, year={2021}, publisher={Nature Publishing Group UK London} } https://betanalpha.github.io/assets/case_studies/principled_bayesian_workflow.html","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"6. Modelling Mortality","text":"vignette, estimate mortality rates, summary indicators life expectancy. work data Iceland. try several methods representing age patterns, including one uses typically patterns Human Mortality Database. model-based estimates come measures uncertainty. addition bage , need package poputils, contains functions calculating life expectancy, rvec, contains data structures functions working random draws. use standard tidyverse tools data manipulation graphing.","code":"library(bage) #> Loading required package: rvec #>  #> Attaching package: 'rvec' #> The following objects are masked from 'package:stats': #>  #>     sd, var #> The following object is masked from 'package:base': #>  #>     rank library(poputils) library(rvec) library(dplyr, warn.conflicts = FALSE) library(tidyr) library(ggplot2)"},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"the-data","dir":"Articles","previous_headings":"","what":"The data","title":"6. Modelling Mortality","text":"Iceland deaths data included bage package. contains counts deaths, estimates mid-year population, disaggregated age sex, years 1998–2022. oldest age group 105 years older. data sparse. Twenty-two percent death counts 0, half 3 less. plot ‘direct’ estimates death rates first least years data. Direct estimates calculated dividing number deaths corresponding population risk, independently combination age, sex, time. results shown , log scale. dots bottom graph represent log-rates negative infinity, occur cells deaths observed. Random variation obscures patterns age 50. age 50, rates increase less linearly.","code":"dth <- bage::isl_deaths dth #> # A tibble: 5,300 × 5 #>    age   sex     time deaths  popn #>    <fct> <fct>  <int>  <int> <dbl> #>  1 0     Female  1998      7 2051  #>  2 1     Female  1998      1 2082. #>  3 2     Female  1998      1 2088  #>  4 3     Female  1998      3 2112. #>  5 4     Female  1998      1 2204  #>  6 5     Female  1998      0 2232. #>  7 6     Female  1998      1 2175  #>  8 7     Female  1998      0 2240  #>  9 8     Female  1998      0 2261  #> 10 9     Female  1998      0 2182. #> # ℹ 5,290 more rows tail(dth, n = 3) #> # A tibble: 3 × 5 #>   age   sex    time deaths  popn #>   <fct> <fct> <int>  <int> <dbl> #> 1 103   Male   2022      0   1.5 #> 2 104   Male   2022      1   1   #> 3 105+  Male   2022      0   0 dth |>   count(deaths) |>   mutate(percent = round(100 * n / sum(n)),          cumulative_percent = cumsum(percent)) |>   head() #> # A tibble: 6 × 4 #>   deaths     n percent cumulative_percent #>    <int> <int>   <dbl>              <dbl> #> 1      0  1180      22                 22 #> 2      1   701      13                 35 #> 3      2   424       8                 43 #> 4      3   333       6                 49 #> 5      4   239       5                 54 #> 6      5   194       4                 58 dth |>   filter(time %in% c(1998, 2010, 2022)) |>   mutate(rate = deaths / popn) |>   ggplot(aes(x = age_mid(age), y = rate)) + ## 'age_mid()' returns the mid point   facet_grid(vars(sex), vars(time)) +       ## of the age group, which is useful   geom_point(alpha = 0.5) +                 ## for plotting   scale_y_log10() +   ggtitle(\"Direct estimates of mortality rates\") #> Warning in scale_y_log10(): log-10 transformation introduced #> infinite values. #> Warning: Removed 6 rows containing missing values or values outside the scale range #> (`geom_point()`)."},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"specifying-the-model","dir":"Articles","previous_headings":"Initial model","what":"Specifying the model","title":"6. Modelling Mortality","text":"fit initial simple model. prior model, allow interaction age sex, allow interactions involving time. assume, words, mortality rates rise fall rate across age-sex groups. assumption unlikely met exactly practice, revisit later. accept default priors main effects interactions. can seen bottom printout, mod_pois() guessed variables represent age, sex, time. (bases guesses variable names.) Age time main effects, default, get “random walk” priors, terms get “normal” priors. running model annoying, common, problem data . turns 5 cases non-zero deaths zero population. edit data directly, removing modify cases. However, dealing cases modelling decision, like include model . make use fact exposure can specified via formula modify cases deaths population. model model ","code":"dth |>   filter(deaths > 0 & popn == 0) #> # A tibble: 5 × 5 #>   age   sex     time deaths  popn #>   <fct> <fct>  <int>  <int> <dbl> #> 1 104   Male    2001      1     0 #> 2 104   Male    2007      1     0 #> 3 104   Male    2012      1     0 #> 4 104   Female  2019      2     0 #> 5 105+  Male    2020      1     0 mod_base <- mod_pois(deaths ~ age * sex + time,                  data = dth,                  exposure = ~ ifelse(deaths > 0 & popn == 0, 0.5, popn)) mod_base #>  #>     ------ Unfitted Poisson model ------ #>  #>  #>    deaths ~ age * sex + time #>  #>  #>         term  prior along zero_sum n_par n_par_free #>  (Intercept) NFix()     -        -     1          1 #>          age   RW()   age        -   106        105 #>          sex NFix()     -        -     2          2 #>         time   RW()  time        -    25         24 #>      age:sex   RW()   age    FALSE   212        210 #>  #>  #>           dispersion: mean=1 #>             exposure: ~ifelse(deaths > 0 & popn == 0, 0.5, popn) #>              var_age: age #>        var_sexgender: sex #>             var_time: time #>               n_draw: 1000"},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"mathematical-description-of-the-model","dir":"Articles","previous_headings":"Initial model","what":"Mathematical description of the model","title":"6. Modelling Mortality","text":"model implemented mod_base assumes \\[\\begin{equation}   y_i \\sim \\text{Poisson}(\\gamma_i w_i) \\end{equation}\\] \\(y_i\\) deaths age-sex-time cell \\(\\), \\(w_i\\) population risk, \\(\\gamma_i\\) underlying death rate. modelling deaths draws Poisson distribution, model recognizes contribution individual-level randomness observed death counts. Recognizing individual-level randomness important analyzing data cell counts small. Death rates \\(\\gamma_i\\) treated draws Gamma distribution, \\[\\begin{equation}   \\gamma_i \\sim \\text{Gamma}(\\xi^{-1}, (\\xi \\mu_i)^{-1}). \\end{equation}\\] expected value \\(\\gamma_i\\) \\(\\mu_i\\), variance \\(\\xi \\mu_i^2\\). modelling \\(\\gamma_i\\) draw distribution, recognizing model able explain variation \\(\\gamma_i\\). Larger values \\(\\xi\\) imply unexplained variation. model \\(\\mu_i\\), log scale, sum factors formed dimensions data, \\[\\begin{equation}   \\log \\mu_i = \\sum_{m=0}^4 \\beta_{j_i^m}^{(m)} \\end{equation}\\] \\(\\pmb{\\beta}^{(0)}\\) intercept, \\(\\pmb{\\beta}^{(m)}\\), \\(m = 1, \\cdots, 4\\), main effect interaction, \\(j_i^m\\) element \\(\\pmb{\\beta}^{(m)}\\) associated cell \\(\\). \\(\\beta^{(m)}\\) model \\(\\mu_i\\) receives prior. default prior intercept \\[\\begin{equation}   \\beta^{(0)} \\sim \\text{N}(0, 10^2) \\end{equation}\\] prior allows much broader range values expect see practice. rarely expect see values \\(\\gamma_i\\) lower 0.001 (-7 log scale) higher 1 (0). default prior age first-order random walk, \\[\\begin{equation}   \\beta_j^{(1)} \\sim \\text{N}(\\beta_{j-1}^{(1)}, \\tau_1^2), \\quad j = 2, \\dots, J_1 \\end{equation}\\] random walk prior embodies idea expect changes one age group next relatively small, neighboring age groups strongly correlated distant age groups. value standard deviation parameter \\(\\tau_1\\) estimated part model, prior, \\[\\begin{equation}     \\tau_1^2 \\sim \\text{N}^+(0, 1) \\end{equation}\\] \\(\\text{N}^+(0, 1)\\) denotes half-normal distribution, , normal distribution restricted non-negative values. prior properly identified, need place constraint overall level. use soft constraint mean, \\[\\begin{equation}   \\frac{1}{J_1}\\sum_{j=1}^{J_1} \\beta_j^{(1)} \\sim \\text{N}(0, 1) \\end{equation}\\] sex main effect prior \\[\\begin{align}   \\beta_j^{(2)} & \\sim \\text{N}(0, \\tau_2^2), \\quad j = 1, 2 \\\\   \\tau_2^2 & \\sim \\text{N}^+(0, 1) \\end{align}\\] time term \\(\\beta^{(3)}\\) random-walk prior age effect. age-sex interaction \\(\\beta^{(4)}\\) prior sex effect. Finally, dispersion term \\(\\xi\\) penalized-complexity prior [@simpson2022priors], \\[\\begin{equation}     p(\\xi) = \\frac{1}{2 \\sqrt{\\xi}}e^{-\\sqrt{\\xi}}. \\end{equation}\\]","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"fitting-the-model","dir":"Articles","previous_headings":"Initial model","what":"Fitting the model","title":"6. Modelling Mortality","text":"fit model calling function fit():","code":"mod_base <- fit(mod_base) mod_base #>  #>     ------ Fitted Poisson model ------ #>  #>  #>    deaths ~ age * sex + time #>  #>  #>         term  prior along zero_sum n_par n_par_free std_dev #>  (Intercept) NFix()     -        -     1          1       - #>          age   RW()   age        -   106        105    2.68 #>          sex NFix()     -        -     2          2    0.15 #>         time   RW()  time        -    25         24    0.10 #>      age:sex   RW()   age    FALSE   212        210    0.17 #>  #>  #>           dispersion: mean=1 #>             exposure: ~ifelse(deaths > 0 & popn == 0, 0.5, popn) #>              var_age: age #>        var_sexgender: sex #>             var_time: time #>               n_draw: 1000 #>  #>  #>  time_total time_optim time_draws iter                    message #>        2.59       1.59       0.06   17   relative convergence (4)"},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"extracting-rates","dir":"Articles","previous_headings":"Initial model","what":"Extracting rates","title":"6. Modelling Mortality","text":"extract estimated rates fitted model object, use function augment(). Function augment() starts original data, adds column called .observed containing direct estimates (\\(y_i/w_i\\)), column called .fitted containing estimates rates (\\(\\gamma_i\\)), column called .expected containing expected values rates (\\(\\mu_i\\)). .fitted .expected columns consist rvecs. rvec vector-like object holds multiple draws, case draws posterior distributions. Next extract rates estimates selected years, summarize posterior distributions. plot point estimates 95% credible intervals modelled estimates, together original direct estimates,","code":"aug_base <- augment(mod_base) aug_base #> # A tibble: 5,300 × 8 #>    age   sex     time deaths  popn .observed                    .fitted #>    <fct> <fct>  <int>  <int> <dbl>     <dbl>               <rdbl<1000>> #>  1 0     Female  1998      7 2051   0.00341     0.0021 (0.0017, 0.0026) #>  2 1     Female  1998      1 2082.  0.000480   5e-04 (0.00037, 0.00066) #>  3 2     Female  1998      1 2088   0.000479 0.00026 (0.00018, 0.00036) #>  4 3     Female  1998      3 2112.  0.00142  0.00017 (0.00012, 0.00024) #>  5 4     Female  1998      1 2204   0.000454 0.00012 (8.5e-05, 0.00018) #>  6 5     Female  1998      0 2232.  0        0.00011 (7.2e-05, 0.00016) #>  7 6     Female  1998      1 2175   0.000460 9.5e-05 (6.1e-05, 0.00014) #>  8 7     Female  1998      0 2240   0        7.5e-05 (4.8e-05, 0.00011) #>  9 8     Female  1998      0 2261   0          7.8e-05 (5e-05, 0.00012) #> 10 9     Female  1998      0 2182.  0        8.2e-05 (5.3e-05, 0.00012) #> # ℹ 5,290 more rows #> # ℹ 1 more variable: .expected <rdbl<1000>> rates_base <- aug_base |>   filter(time %in% c(1998, 2010, 2022)) |>   select(age, sex, time, .observed, .fitted) |>   mutate(draws_ci(.fitted)) rates_base #> # A tibble: 636 × 8 #>    age   sex     time .observed                    .fitted .fitted.lower #>    <fct> <fct>  <int>     <dbl>               <rdbl<1000>>         <dbl> #>  1 0     Female  1998  0.00341     0.0021 (0.0017, 0.0026)     0.00166   #>  2 1     Female  1998  0.000480   5e-04 (0.00037, 0.00066)     0.000367  #>  3 2     Female  1998  0.000479 0.00026 (0.00018, 0.00036)     0.000184  #>  4 3     Female  1998  0.00142  0.00017 (0.00012, 0.00024)     0.000116  #>  5 4     Female  1998  0.000454 0.00012 (8.5e-05, 0.00018)     0.0000852 #>  6 5     Female  1998  0        0.00011 (7.2e-05, 0.00016)     0.0000724 #>  7 6     Female  1998  0.000460 9.5e-05 (6.1e-05, 0.00014)     0.0000606 #>  8 7     Female  1998  0        7.5e-05 (4.8e-05, 0.00011)     0.0000481 #>  9 8     Female  1998  0          7.8e-05 (5e-05, 0.00012)     0.0000499 #> 10 9     Female  1998  0        8.2e-05 (5.3e-05, 0.00012)     0.0000532 #> # ℹ 626 more rows #> # ℹ 2 more variables: .fitted.mid <dbl>, .fitted.upper <dbl> ggplot(rates_base, aes(x = age_mid(age),               ymin = .fitted.lower,              y = .fitted.mid,              ymax = .fitted.upper)) +   facet_grid(vars(sex), vars(time)) +   geom_ribbon(fill = \"lightblue\") +   geom_line(col= \"darkblue\") +   geom_point(aes(y = .observed),              size = 0.2) +   scale_y_log10() +   ggtitle(\"Modelled and direct estimates of mortality rates - base model\") #> Warning in scale_y_log10(): log-10 transformation introduced #> infinite values. #> Warning: Removed 6 rows containing missing values or values outside the scale range #> (`geom_point()`)."},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"extracting-higher-level-terms","dir":"Articles","previous_headings":"Initial model","what":"Extracting higher-level terms","title":"6. Modelling Mortality","text":"can gain insights model extracting graphing estimates main effects interactions, \\(\\pmb{\\beta}^{(m)}\\). Estimates main effects interactions, higher-level parameters, can obtained function components(). components() returns tibble contain estimates higher-level parameters. extract age effect, prepare graphing, use graph age effect reveals typical profile mortality rates,","code":"comp_base <- components(mod_base) comp_base #> # A tibble: 350 × 4 #>    term        component level                 .fitted #>    <chr>       <chr>     <chr>            <rdbl<1000>> #>  1 (Intercept) effect    (Intercept)   -4 (-5.3, -2.9) #>  2 age         effect    0                    0 (0, 0) #>  3 age         effect    1           -1.4 (-1.7, -1.1) #>  4 age         effect    2             -2 (-2.3, -1.7) #>  5 age         effect    3           -2.5 (-2.8, -2.1) #>  6 age         effect    4           -2.8 (-3.1, -2.4) #>  7 age         effect    5           -2.8 (-3.2, -2.5) #>  8 age         effect    6             -3 (-3.4, -2.6) #>  9 age         effect    7           -3.2 (-3.6, -2.8) #> 10 age         effect    8           -3.2 (-3.6, -2.7) #> # ℹ 340 more rows age_effect <- comp_base |>   filter(component == \"effect\",          term == \"age\") |>   mutate(draws_ci(.fitted)) ggplot(age_effect,        aes(x = age_mid(level),            y = .fitted.mid,            ymin = .fitted.lower,            ymax = .fitted.upper)) +   geom_ribbon(fill = \"lightblue\") +   geom_line() +   ggtitle(\"Age effect\")"},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"mathematical-structure","dir":"Articles","previous_headings":"Revised model","what":"Mathematical structure","title":"6. Modelling Mortality","text":"Human Mortality Database provides estimates mortality rates many countries. Let \\(\\pmb{M}\\) denote matrix holding estimates, log scale. applying Singlar Value Decomposition \\(\\pmb{M}\\), rescaling, can construct matrix \\(\\pmb{F}\\) column vector \\(\\pmb{g}\\), parsimoniously summarize age-profiles, age-sex profiles, observed \\(\\pmb{M}\\). \\(z\\) vector independent draws \\(\\text{N}(0,1)\\) distribution, resulting vector \\[\\begin{equation}   \\pmb{m} = \\pmb{F} \\pmb{z} + \\pmb{g} \\end{equation}\\] looks like randomly-selected column \\(\\pmb{M}\\). use \\(\\pmb{F}\\) \\(\\pmb{g}\\) build priors age effects age-sex interactions. prior age effects \\[\\begin{align}   \\pmb{\\beta}^{(1)} & = \\pmb{F} \\pmb{\\alpha} + \\pmb{g} \\\\   \\alpha_k & \\sim \\text{N}(0, 1), \\quad k = 1, \\cdots, K \\end{align}\\] \\(K\\) chosen user. prior age-sex interactions looks except , default, calculations done separately sex.","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"specifying-the-new-model","dir":"Articles","previous_headings":"Revised model","what":"Specifying the new model","title":"6. Modelling Mortality","text":"","code":"mod_hmd <- mod_pois(deaths ~ age:sex + time,                     data = dth,                     exposure = ~ ifelse(deaths > 0 & popn == 0, 0.5, popn)) |>   set_prior(age:sex ~ SVD(HMD)) mod_hmd #>  #>     ------ Unfitted Poisson model ------ #>  #>  #>    deaths ~ age:sex + time #>  #>  #>         term    prior along zero_sum n_par n_par_free #>  (Intercept)   NFix()     -        -     1          1 #>         time     RW()  time        -    25         24 #>      age:sex SVD(HMD)     -        -   212          6 #>  #>  #>           dispersion: mean=1 #>             exposure: ~ifelse(deaths > 0 & popn == 0, 0.5, popn) #>              var_age: age #>        var_sexgender: sex #>             var_time: time #>               n_draw: 1000 mod_hmd <- fit(mod_hmd) mod_hmd #>  #>     ------ Fitted Poisson model ------ #>  #>  #>    deaths ~ age:sex + time #>  #>  #>         term    prior along zero_sum n_par n_par_free std_dev #>  (Intercept)   NFix()     -        -     1          1       - #>         time     RW()  time        -    25         24    0.10 #>      age:sex SVD(HMD)     -        -   212          6    2.80 #>  #>  #>           dispersion: mean=1 #>             exposure: ~ifelse(deaths > 0 & popn == 0, 0.5, popn) #>              var_age: age #>        var_sexgender: sex #>             var_time: time #>               n_draw: 1000 #>  #>  #>  time_total time_optim time_draws iter                    message #>        2.42       1.50       0.00   10   relative convergence (4) aug_hmd <- augment(mod_hmd)  rates_hmd <- aug_hmd |>   filter(time %in% c(1998, 2010, 2022)) |>   select(age, sex, time, .observed, .fitted) |>   mutate(draws_ci(.fitted))  ggplot(rates_hmd, aes(x = age_mid(age),               ymin = .fitted.lower,              y = .fitted.mid,              ymax = .fitted.upper)) +   facet_grid(vars(sex), vars(time)) +   geom_ribbon(fill = \"lightblue\") +   geom_line(col= \"darkblue\") +   geom_point(aes(y = .observed),              size = 0.2) +   scale_y_log10() +   ggtitle(\"Modelled and direct estimates of mortality rates - HMD model\") #> Warning in scale_y_log10(): log-10 transformation introduced #> infinite values. #> Warning: Removed 6 rows containing missing values or values outside the scale range #> (`geom_point()`). comp_hmd <- components(mod_hmd)  age_sex_interact <- comp_hmd |>   filter(component == \"effect\",          term == \"age:sex\") |>   separate_wider_delim(level, delim = \".\", names = c(\"age\", \"sex\")) |>   mutate(draws_ci(.fitted))  ggplot(age_sex_interact,        aes(x = age_mid(age),            y = .fitted.mid,            ymin = .fitted.lower,            ymax = .fitted.upper)) +   geom_ribbon(aes(fill = sex),               alpha = 0.3) +   geom_line(aes(col = sex)) +   ggtitle(\"Age-sex interaction\")"},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"model-testing","dir":"Articles","previous_headings":"","what":"Model testing","title":"6. Modelling Mortality","text":"","code":"rep_data_base <- replicate_data(mod_base, condition_on = \"expected\")  data <- rep_data_base |>   filter(time == 2022) |>   select(-popn) |>   pivot_wider(names_from = sex, values_from = deaths) |>   mutate(diff = Female - Male) ggplot(data, aes(x = age_mid(age), y = diff)) +   facet_wrap(vars(.replicate)) +   geom_point(size = 0.2) rep_data_hmd <- replicate_data(mod_hmd, condition_on = \"expected\")  data <- rep_data_hmd |>   filter(time == 2022) |>   select(-popn) |>   pivot_wider(names_from = sex, values_from = deaths) |>   mutate(diff = Female - Male) ggplot(data, aes(x = age_mid(age), y = diff)) +   facet_wrap(vars(.replicate)) +   geom_point(size = 0.2)"},{"path":"https://bayesiandemography.github.io/bage/articles/vig6_mortality.html","id":"life-expectancy-and-life-tables","dir":"Articles","previous_headings":"","what":"Life expectancy and life tables","title":"6. Modelling Mortality","text":"","code":"lifeexp_hmd <- mod_hmd |>   augment() |>   lifeexp(mx = .fitted,           by = c(time, sex)) lifeexp_hmd #> # A tibble: 50 × 3 #>     time sex              ex #>    <int> <fct>  <rdbl<1000>> #>  1  1998 Female  82 (81, 82) #>  2  1998 Male    78 (77, 78) #>  3  1999 Female  82 (81, 82) #>  4  1999 Male    78 (77, 78) #>  5  2000 Female  82 (82, 82) #>  6  2000 Male    78 (78, 79) #>  7  2001 Female  82 (82, 83) #>  8  2001 Male    79 (78, 79) #>  9  2002 Female  82 (82, 83) #> 10  2002 Male    79 (78, 79) #> # ℹ 40 more rows lifeexp_hmd <- mod_hmd |>   augment() |>   lifeexp(mx = .fitted,           by = c(time, sex)) lifeexp_hmd #> # A tibble: 50 × 3 #>     time sex              ex #>    <int> <fct>  <rdbl<1000>> #>  1  1998 Female  82 (81, 82) #>  2  1998 Male    78 (77, 78) #>  3  1999 Female  82 (81, 82) #>  4  1999 Male    78 (77, 78) #>  5  2000 Female  82 (82, 82) #>  6  2000 Male    78 (78, 79) #>  7  2001 Female  82 (82, 83) #>  8  2001 Male    79 (78, 79) #>  9  2002 Female  82 (82, 83) #> 10  2002 Male    79 (78, 79) #> # ℹ 40 more rows"},{"path":"https://bayesiandemography.github.io/bage/articles/vig7_simulation.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"7. Simulation","text":"Figure 1.1: Simulation study model Function report_sim() automates process simulation study. still experimenting report_sim(), interface may change. Suggestions welcome, ideally raising issue .","code":""},{"path":"https://bayesiandemography.github.io/bage/articles/vig7_simulation.html","id":"estimation-model-matches-data-generation-model","dir":"Articles","previous_headings":"","what":"Estimation model matches data generation model","title":"7. Simulation","text":"straightforward type simulation estimation model' used inference matches thedata generation model’ used create data. Even estimation model matches data generation model, inferred values parameters exactly reproduce actual values, since data drawn random, provides noisy signal parameters generated . However, experiment repeated many times, different randomly-drawn dataset time, errors less average zero, 50% credible intervals contain true values close 50% time, 95% credible intervals contain true values close 95% time. illustrate, use investigate performance model divorce rates New Zealand. reduce number ages time periods speed calculations. simulation study, pass model report_sim(). one model supplied, report_sim() assumes model used estimation model data generation model. default report_sim() repeats experiment 100 times, generating different dataset time. output report_sim() list two data frames. first data frame contains results parameters associated components() function: main effects interactions, associated hyper-parameters, dispersion. second data frame contains results parameters associated augment() function: lowest-level rates parameters. can seen results, errors average exactly zero, 50% credible intervals contain true value exactly 50% time, 95% credible intervals contain true value exactly 95% time. However, increasing number simulations default value 100 , say, 1000 reduce average size errors closer zero, bring actual coverage rates closer advertised values. larger values n_sim used, can helpful use parallel processing speed calculations, done n_core argument. One slightly odd feature results mean .expected large. reflects fact data generation model draws extreme values. developing set informative priors avoid behavior future versions bage.","code":"library(bage) #> Loading required package: rvec #>  #> Attaching package: 'rvec' #> The following objects are masked from 'package:stats': #>  #>     sd, var #> The following object is masked from 'package:base': #>  #>     rank library(dplyr, warn.conflicts = FALSE) library(poputils)  divorces_small <- nzl_divorces |>   filter(age_upper(age) < 40,          time >= 2016) |>   droplevels()  mod <- mod_pois(divorces ~ age * sex + time,                 data = divorces_small,                     exposure = population) mod      #>  #>     ------ Unfitted Poisson model ------ #>  #>  #>    divorces ~ age * sex + time #>  #>  #>         term  prior along zero_sum n_par n_par_free #>  (Intercept) NFix()     -        -     1          1 #>          age   RW()   age        -     4          3 #>          sex NFix()     -        -     2          2 #>         time   RW()  time        -     6          5 #>      age:sex   RW()   age    FALSE     8          6 #>  #>  #>           dispersion: mean=1 #>             exposure: population #>              var_age: age #>        var_sexgender: sex #>             var_time: time #>               n_draw: 1000 set.seed(0) res <- report_sim(mod_est = mod) res #> $components #> # A tibble: 9 × 7 #>   term        component  .error .cover_50 .cover_95 .length_50 .length_95 #>   <chr>       <chr>       <dbl>     <dbl>     <dbl>      <dbl>      <dbl> #> 1 (Intercept) effect     0.0334     0.56      0.97       0.839      2.37  #> 2 age         effect    -0.0564     0.7       0.955      0.752      2.14  #> 3 age         hyper      0.0947     0.38      0.81       0.593      2.08  #> 4 sex         effect    -0.0276     0.48      0.935      0.841      2.44  #> 5 time        effect    -0.0396     0.623     0.948      0.434      1.23  #> 6 time        hyper      0.0211     0.55      0.95       0.384      1.26  #> 7 age:sex     effect     0.0365     0.669     0.941      0.751      2.16  #> 8 age:sex     hyper     -0.0404     0.42      0.87       0.489      1.58  #> 9 disp        disp       0.0324     0.44      0.91       0.244      0.723 #>  #> $augment #> # A tibble: 2 × 7 #>   .var      .observed     .error .cover_50 .cover_95 .length_50 .length_95 #>   <chr>         <dbl>      <dbl>     <dbl>     <dbl>      <dbl>      <dbl> #> 1 .fitted        273.  -0.000490     0.499     0.947    0.00739     0.0216 #> 2 .expected      273. -23.0          0.539     0.952   90.8       325."},{"path":"https://bayesiandemography.github.io/bage/articles/vig7_simulation.html","id":"estimation-model-different-from-data-generation-model","dir":"Articles","previous_headings":"","what":"Estimation model different from data generation model","title":"7. Simulation","text":"actual applications, estimation model ever perfectly describes true data generating process. can therefore helpful see robust given model misspecification, , cases estimation model differs data generation model. report_sim(), can done using one model mod_est argument, different model mod_sim argument. Consider, instance, case time effect generated AR1() prior, estimation model continues use default value RW() prior, set mod_sim argument mod_ar1 generate report. case, although actual coverage hyper-parameters (components part results) now diverges advertised coverage, coverage low-level rates (augment part results) still close advertised coverage.","code":"mod_ar1 <- mod |>   set_prior(time ~ AR1()) mod_ar1  #>  #>     ------ Unfitted Poisson model ------ #>  #>  #>    divorces ~ age * sex + time #>  #>  #>         term  prior along zero_sum n_par n_par_free #>  (Intercept) NFix()     -        -     1          1 #>          age   RW()   age        -     4          3 #>          sex NFix()     -        -     2          2 #>         time  AR1()  time        -     6          6 #>      age:sex   RW()   age    FALSE     8          6 #>  #>  #>           dispersion: mean=1 #>             exposure: population #>              var_age: age #>        var_sexgender: sex #>             var_time: time #>               n_draw: 1000 res_ar1 <- report_sim(mod_est = mod, mod_sim = mod_ar1) res_ar1 #> $components #> # A tibble: 9 × 7 #>   term        component  .error .cover_50 .cover_95 .length_50 .length_95 #>   <chr>       <chr>       <dbl>     <dbl>     <dbl>      <dbl>      <dbl> #> 1 (Intercept) effect    -0.172      0.34      0.79       0.834      2.36  #> 2 age         effect    -0.0473     0.678     0.948      0.714      2.04  #> 3 age         hyper      0.105      0.4       0.77       0.579      2.00  #> 4 sex         effect     0.0381     0.455     0.93       0.838      2.42  #> 5 time        effect     0.0755     0.233     0.543      0.391      1.11  #> 6 time        hyper     -0.357      0.19      0.61       0.335      1.16  #> 7 age:sex     effect     0.0539     0.659     0.949      0.719      2.07  #> 8 age:sex     hyper     -0.0523     0.43      0.88       0.466      1.51  #> 9 disp        disp       0.0134     0.57      0.96       0.245      0.727 #>  #> $augment #> # A tibble: 2 × 7 #>   .var      .observed   .error .cover_50 .cover_95 .length_50 .length_95 #>   <chr>         <dbl>    <dbl>     <dbl>     <dbl>      <dbl>      <dbl> #> 1 .fitted        86.9 0.000355     0.500     0.948    0.00671     0.0195 #> 2 .expected      86.9 3.08         0.488     0.946   44.6       146."},{"path":"https://bayesiandemography.github.io/bage/articles/vig7_simulation.html","id":"the-relationship-between-report_sim-and-replicate_data","dir":"Articles","previous_headings":"","what":"The relationship between report_sim() and replicate_data()","title":"7. Simulation","text":"Functions report_sim() replicate_data() overlap, use simulated data provide insights model performance. aims , however, different. Typically, report_sim() used fitting model, assess performance across random selection possible datasets, replicate_data() used fitting model, assess performance dataset hand.","code":""},{"path":"https://bayesiandemography.github.io/bage/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"John Bryant. Author, maintainer. Junni Zhang. Author. Bayesian Demography Limited. Copyright holder.","code":""},{"path":"https://bayesiandemography.github.io/bage/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Bryant J, Zhang J (2024). bage: Bayesian Estimation Forecasting Age-Specific Rates. R package version 0.8.0, https://github.com/bayesiandemography/bage, https://bayesiandemography.github.io/bage/.","code":"@Manual{,   title = {bage: Bayesian Estimation and Forecasting of Age-Specific Rates},   author = {John Bryant and Junni Zhang},   year = {2024},   note = {R package version 0.8.0, https://github.com/bayesiandemography/bage},   url = {https://bayesiandemography.github.io/bage/}, }"},{"path":"https://bayesiandemography.github.io/bage/index.html","id":"bage-","dir":"","previous_headings":"","what":"Bayesian Estimation and Forecasting of Age-Specific Rates","title":"Bayesian Estimation and Forecasting of Age-Specific Rates","text":"Fast Bayesian estimation forecasting age-specific rates.","code":""},{"path":"https://bayesiandemography.github.io/bage/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Bayesian Estimation and Forecasting of Age-Specific Rates","text":"","code":"install.packages(\"bage\") ## CRAN version devtools::install_github(\"bayesiandemography/bage\") ## development version"},{"path":"https://bayesiandemography.github.io/bage/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Bayesian Estimation and Forecasting of Age-Specific Rates","text":"Fit Poisson model data injuries Extract model-based direct estimates","code":"library(bage) #> Loading required package: rvec #>  #> Attaching package: 'rvec' #> The following objects are masked from 'package:stats': #>  #>     sd, var #> The following object is masked from 'package:base': #>  #>     rank mod <- mod_pois(injuries ~ age:sex + ethnicity + year,                 data = nzl_injuries,                 exposure = popn) |>   fit() mod #>  #>     ------ Fitted Poisson model ------ #>  #>  #>    injuries ~ age:sex + ethnicity + year #>  #>  #>         term  prior along zero_sum n_par n_par_free std_dev #>  (Intercept) NFix()     -        -     1          1       - #>    ethnicity NFix()     -        -     2          2    0.45 #>         year   RW()  year        -    19         18    0.09 #>      age:sex   RW()   age    FALSE    24         22    0.88 #>  #>  #>           dispersion: mean=1 #>             exposure: popn #>              var_age: age #>        var_sexgender: sex #>             var_time: year #>               n_draw: 1000 #>  #>  #>  time_total time_optim time_draws iter                    message #>        0.47       0.07       0.01   11   relative convergence (4) augment(mod) #> # A tibble: 912 × 9 #>    age   sex    ethnicity  year injuries  popn .observed #>    <fct> <chr>  <chr>     <int>    <int> <int>     <dbl> #>  1 0-4   Female Maori      2000       12 35830 0.000335  #>  2 5-9   Female Maori      2000        6 35120 0.000171  #>  3 10-14 Female Maori      2000        3 32830 0.0000914 #>  4 15-19 Female Maori      2000        6 27130 0.000221  #>  5 20-24 Female Maori      2000        6 24380 0.000246  #>  6 25-29 Female Maori      2000        6 24160 0.000248  #>  7 30-34 Female Maori      2000       12 22560 0.000532  #>  8 35-39 Female Maori      2000        3 22230 0.000135  #>  9 40-44 Female Maori      2000        6 18130 0.000331  #> 10 45-49 Female Maori      2000        6 13770 0.000436  #> # ℹ 902 more rows #> # ℹ 2 more variables: .fitted <rdbl<1000>>, .expected <rdbl<1000>>"},{"path":"https://bayesiandemography.github.io/bage/reference/AR.html","id":null,"dir":"Reference","previous_headings":"","what":"Autoregressive Prior — AR","title":"Autoregressive Prior — AR","text":"Use autoregressive process model main effect, use multiple autoregressive processes model interaction. Typically used time effects interactions involve time.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Autoregressive Prior — AR","text":"","code":"AR(n_coef = 2, s = 1, along = NULL, zero_sum = FALSE)"},{"path":"https://bayesiandemography.github.io/bage/reference/AR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Autoregressive Prior — AR","text":"n_coef Number lagged terms model, ie order model. Default 2. s Scale prior innovations. Default 1. along Name variable used 'along' variable. used interactions. zero_sum TRUE, values must sum 0 within combination '' variables. Default FALSE.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Autoregressive Prior — AR","text":"object class \"bage_prior_ar\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Autoregressive Prior — AR","text":"AR() used interaction, separate AR processes constructed along 'along' variable, within combination '' variables. default, autoregressive processes order 2. Alternative choices can specified n_coef argument. Argument s controls size innovations. Smaller values s tend give smoother estimates.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Autoregressive Prior — AR","text":"AR() used main effect, $$\\beta_j = \\phi_1 \\beta_{j-1} + \\cdots + \\phi_n \\beta_{j-n} + \\epsilon_j$$ $$\\epsilon_j \\sim \\text{N}(0, \\omega^2),$$ used interaction, $$\\beta_{u,v} = \\phi_1 \\beta_{u,v-1} + \\cdots + \\phi_n \\beta_{u,v-n} + \\epsilon_{u,v}$$ $$\\epsilon_{u,v} \\sim \\text{N}(0, \\omega^2),$$ \\(\\pmb{\\beta}\\) main effect interaction; \\(j\\) denotes position within main effect; \\(v\\) denotes position within 'along' variable interaction; \\(u\\) denotes position within '' variable(s) interaction; \\(n\\) n_coef. Internally, AR() derives value \\(\\omega\\) gives every element \\(\\beta\\) marginal variance \\(\\tau^2\\). Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ s provided user. autocorrelation coefficients \\(\\phi_1, \\cdots, \\phi_n\\) restricted values -1 1 jointly lead stationary model. quantity \\(r = \\sqrt{\\phi_1^2 + \\cdots + \\phi_n^2}\\) boundary-avoiding prior $$r \\sim \\text{Beta}(2, 2).$$","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Autoregressive Prior — AR","text":"AR() based TMB function ARk","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/AR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Autoregressive Prior — AR","text":"","code":"AR(n_coef = 3) #>   AR(n_coef=3)  #>     n_coef: 3 #>        min: -1 #>        max: 1 #>          s: 1 #>      along: NULL #>   zero_sum: FALSE AR(n_coef = 3, s = 2.4) #>   AR(n_coef=3,s=2.4)  #>     n_coef: 3 #>        min: -1 #>        max: 1 #>          s: 2.4 #>      along: NULL #>   zero_sum: FALSE AR(along = \"cohort\") #>   AR(along=\"cohort\")  #>     n_coef: 2 #>        min: -1 #>        max: 1 #>          s: 1 #>      along: cohort #>   zero_sum: FALSE"},{"path":"https://bayesiandemography.github.io/bage/reference/AR1.html","id":null,"dir":"Reference","previous_headings":"","what":"Autoregressive Prior of Order 1 — AR1","title":"Autoregressive Prior of Order 1 — AR1","text":"Use autoregressive process order 1 model main effect, use multiple AR1 processes model interaction. Typically used time effects interactions involve time.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Autoregressive Prior of Order 1 — AR1","text":"","code":"AR1(min = 0.8, max = 0.98, s = 1, along = NULL, zero_sum = FALSE)"},{"path":"https://bayesiandemography.github.io/bage/reference/AR1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Autoregressive Prior of Order 1 — AR1","text":"min, max Minimum maximum values autocorrelation coefficient. Defaults 0.8 0.98. s Scale prior innovations. Default 1. along Name variable used 'along' variable. used interactions. zero_sum TRUE, values must sum 0 within combination '' variables. Default FALSE.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR1.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Autoregressive Prior of Order 1 — AR1","text":"object class \"bage_prior_ar\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR1.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Autoregressive Prior of Order 1 — AR1","text":"AR() used interaction, separate AR processes constructed along 'along' variable, within combination '' variables. Arguments min max can used specify permissible range autocorrelation. Argument s controls size innovations. Smaller values s tend give smoother estimates.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR1.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Autoregressive Prior of Order 1 — AR1","text":"AR1() used main effect, $$\\beta_j = \\phi \\beta_{j-1} + \\epsilon_j$$ $$\\epsilon_j \\sim \\text{N}(0, \\omega^2),$$ used interaction, $$\\beta_{u,v} = \\phi \\beta_{u,v-1} + \\epsilon_{u,v}$$ $$\\epsilon_{u,v} \\sim \\text{N}(0, \\omega^2),$$ \\(\\pmb{\\beta}\\) main effect interaction; \\(j\\) denotes position within main effect; \\(v\\) denotes position within 'along' variable interaction; \\(u\\) denotes position within '' variable(s) interaction. Internally, AR1() derives value \\(\\omega\\) gives every element \\(\\beta\\) marginal variance \\(\\tau^2\\). Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ s provided user. Coefficient \\(\\phi\\) constrained lie min max. prior distribution $$\\phi = (\\text{max} - \\text{min}) \\phi' - \\text{min}$$ $$\\phi' \\sim \\text{Beta}(2, 2).$$","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/AR1.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Autoregressive Prior of Order 1 — AR1","text":"AR1() based TMB function AR1 defaults min max based defaults forecast::ets().","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/AR1.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Autoregressive Prior of Order 1 — AR1","text":"","code":"AR1() #>   AR1()  #>        min: 0.8 #>        max: 0.98 #>          s: 1 #>      along: NULL #>   zero_sum: FALSE AR1(min = 0, max = 1, s = 2.4) #>   AR1(min=0,max=1,s=2.4)  #>        min: 0 #>        max: 1 #>          s: 2.4 #>      along: NULL #>   zero_sum: FALSE AR1(along = \"cohort\") #>   AR1(along=\"cohort\")  #>        min: 0.8 #>        max: 0.98 #>          s: 1 #>      along: cohort #>   zero_sum: FALSE"},{"path":"https://bayesiandemography.github.io/bage/reference/HFD.html","id":null,"dir":"Reference","previous_headings":"","what":"Components from Human Fertility Database — HFD","title":"Components from Human Fertility Database — HFD","text":"object class \"bage_ssvd\" holding components extracted mortality data Human Fertility Database. object holds 5 components.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/HFD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Components from Human Fertility Database — HFD","text":"","code":"HFD"},{"path":"https://bayesiandemography.github.io/bage/reference/HFD.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Components from Human Fertility Database — HFD","text":"Object class \"bage_ssvd\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/HFD.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Components from Human Fertility Database — HFD","text":"Derived data Human Fertility Database.Max Planck Institute Demographic Research (Germany) Vienna Institute Demography (Austria). . Code create HFD folder 'data-raw/ssvd_hfd' source code bage package.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/HMD.html","id":null,"dir":"Reference","previous_headings":"","what":"Components from Human Mortality Database — HMD","title":"Components from Human Mortality Database — HMD","text":"object class \"bage_ssvd\" holding components extracted mortality data Human Mortality Database. object holds 5 components.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/HMD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Components from Human Mortality Database — HMD","text":"","code":"HMD"},{"path":"https://bayesiandemography.github.io/bage/reference/HMD.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Components from Human Mortality Database — HMD","text":"Object class \"bage_ssvd\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/HMD.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Components from Human Mortality Database — HMD","text":"Derived data Human Mortality Database. Max Planck Institute Demographic Research (Germany), University California, Berkeley (USA), French Institute Demographic Studies (France). Code create HMD folder 'data-raw/ssvd_hmd' source code bage package.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Known.html","id":null,"dir":"Reference","previous_headings":"","what":"Known Prior — Known","title":"Known Prior — Known","text":"Treat intercept, main effect, interaction fixed known.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Known.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Known Prior — Known","text":"","code":"Known(values)"},{"path":"https://bayesiandemography.github.io/bage/reference/Known.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Known Prior — Known","text":"values numeric vector","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Known.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Known Prior — Known","text":"object class \"bage_prior_known\".","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/Known.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Known Prior — Known","text":"","code":"Known(-2.3) #> Known(-2.3)  Known(c(0.1, 2, -0.11)) #> Known(c(0.1,2,-0.11))"},{"path":"https://bayesiandemography.github.io/bage/reference/LFP.html","id":null,"dir":"Reference","previous_headings":"","what":"Components from OECD Labor Force Participation Data — LFP","title":"Components from OECD Labor Force Participation Data — LFP","text":"object class \"bage_ssvd\" holding components extracted labor force participation data OECD Data Explorer.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/LFP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Components from OECD Labor Force Participation Data — LFP","text":"","code":"LFP"},{"path":"https://bayesiandemography.github.io/bage/reference/LFP.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Components from OECD Labor Force Participation Data — LFP","text":"Object class \"bage_ssvd\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/LFP.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Components from OECD Labor Force Participation Data — LFP","text":"Derived data \"Labor Force Indicators\" table OECD Data Explorer. Code create LFS folder 'data-raw/ssvd_lfp' source code bage package.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin.html","id":null,"dir":"Reference","previous_headings":"","what":"Linear Prior with Independent Normal Errors — Lin","title":"Linear Prior with Independent Normal Errors — Lin","text":"Use line lines independent normal errors model main effect interaction. Typically used time.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Linear Prior with Independent Normal Errors — Lin","text":"","code":"Lin(s = 1, mean_slope = 0, sd_slope = 1, along = NULL, zero_sum = FALSE)"},{"path":"https://bayesiandemography.github.io/bage/reference/Lin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Linear Prior with Independent Normal Errors — Lin","text":"s Scale prior errors. Default 1. Can 0. mean_slope Mean prior slope line. Default 0. sd_slope Standard deviation prior slope line. Default 1. along Name variable used 'along' variable. used interactions. zero_sum TRUE, values must sum 0 within combination '' variables. Default FALSE.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Linear Prior with Independent Normal Errors — Lin","text":"object class \"bage_prior_lin\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Linear Prior with Independent Normal Errors — Lin","text":"Lin() used interaction, separate lines constructed along 'along' variable, within combination '' variables. Argument s controls size errors. Smaller values tend give smoother estimates. s can zero. Argument sd_slope controls size slopes lines. Larger values can give steeply sloped lines.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Linear Prior with Independent Normal Errors — Lin","text":"Lin() used main effect, $$\\beta_j = \\alpha + j \\eta + \\epsilon_j$$ $$\\alpha \\sim \\text{N}(0, 1)$$ $$\\epsilon_j \\sim \\text{N}(0, \\tau^2),$$ used interaction, $$\\beta_{u,v} \\sim  \\alpha_u + v \\eta_u + \\epsilon_{u,v}$$ $$\\alpha_u \\sim \\text{N}(0, 1)$$ $$\\epsilon_{u,v} \\sim \\text{N}(0, \\tau^2),$$ \\(\\pmb{\\beta}\\) main effect interaction; \\(j\\) denotes position within main effect; \\(v\\) denotes position within 'along' variable interaction; \\(u\\) denotes position within '' variable(s) interaction. slopes priors $$\\eta \\sim \\text{N}(\\text{mean_slope}, \\text{sd_slope}^2)$$ $$\\eta_u \\sim \\text{N}(\\text{mean_slope}, \\text{sd_slope}^2).$$ Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2).$$","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/Lin.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Linear Prior with Independent Normal Errors — Lin","text":"","code":"Lin() #>   Lin()  #>          s: 1 #> mean_slope: 0 #>   sd_slope: 1 #>      along: NULL #>   zero_sum: FALSE Lin(s = 0.5, sd_slope = 2) #>   Lin(s=0.5,sd_slope=2)  #>          s: 0.5 #> mean_slope: 0 #>   sd_slope: 2 #>      along: NULL #>   zero_sum: FALSE Lin(s = 0) #>   Lin(s=0)  #>          s: 0 #> mean_slope: 0 #>   sd_slope: 1 #>      along: NULL #>   zero_sum: FALSE Lin(along = \"cohort\") #>   Lin(along=\"cohort\")  #>          s: 1 #> mean_slope: 0 #>   sd_slope: 1 #>      along: cohort #>   zero_sum: FALSE"},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR.html","id":null,"dir":"Reference","previous_headings":"","what":"Linear Prior with Autoregressive Errors — Lin_AR","title":"Linear Prior with Autoregressive Errors — Lin_AR","text":"Use line lines autoregressive errors model main effect interaction. Typically used time.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Linear Prior with Autoregressive Errors — Lin_AR","text":"","code":"Lin_AR(   n_coef = 2,   s = 1,   mean_slope = 0,   sd_slope = 1,   along = NULL,   zero_sum = FALSE )"},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Linear Prior with Autoregressive Errors — Lin_AR","text":"n_coef Number lagged terms model, ie order model. Default 2. s Scale innovations AR process. Default 1. mean_slope Mean prior slope line. Default 0. sd_slope Standard deviation prior slope line. Larger values imply steeper slopes. Default 1. along Name variable used 'along' variable. used interactions. zero_sum TRUE, values must sum 0 within combination '' variables. Default FALSE.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Linear Prior with Autoregressive Errors — Lin_AR","text":"object class \"bage_prior_linar\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Linear Prior with Autoregressive Errors — Lin_AR","text":"Lin_AR() used interaction, separate lines constructed along 'along' variable, within combination '' variables. order autoregressive errors controlled n_coef argument. default 2. Argument s controls size innovations. Smaller values tend give smoother estimates. Argument sd_slope controls size slopes lines. Larger values can give steeply sloped lines.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Linear Prior with Autoregressive Errors — Lin_AR","text":"Lin_AR() used main effect, $$\\beta_1 = \\alpha + \\epsilon_1$$ $$\\beta_j = \\alpha + (j - 1) \\eta + \\epsilon_j, \\quad j > 1$$ $$\\alpha \\sim \\text{N}(0, 1)$$ $$\\epsilon_j = \\phi_1 \\epsilon_{j-1} + \\cdots + \\phi_n \\epsilon_{j-n} + \\varepsilon_j$$ $$\\varepsilon_j \\sim \\text{N}(0, \\omega^2),$$ used interaction, $$\\beta_{u,1} = \\alpha_u + \\epsilon_{u,1}$$ $$\\beta_{u,v} = \\eta (v - 1) + \\epsilon_{u,v}, \\quad v = 2, \\cdots, V$$ $$\\alpha_u \\sim \\text{N}(0, 1)$$ $$\\epsilon_{u,v} = \\phi_1 \\epsilon_{u,v-1} + \\cdots + \\phi_n \\epsilon_{u,v-n} + \\varepsilon_{u,v},$$ $$\\varepsilon_{u,v} \\sim \\text{N}(0, \\omega^2).$$ \\(\\pmb{\\beta}\\) main effect interaction; \\(j\\) denotes position within main effect; \\(u\\) denotes position within 'along' variable interaction; \\(u\\) denotes position within '' variable(s) interaction; \\(n\\) n_coef. slopes priors $$\\eta \\sim \\text{N}(\\text{mean_slope}, \\text{sd_slope}^2)$$ $$\\eta_u \\sim \\text{N}(\\text{mean_slope}, \\text{sd_slope}^2).$$ Internally, Lin_AR() derives value \\(\\omega\\) gives \\(\\epsilon_j\\) \\(\\epsilon_{u,v}\\) marginal variance \\(\\tau^2\\). Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ value s provided user. \\(\\phi_1, \\cdots, \\phi_k\\) restricted values -1 1 jointly lead stationary model. quantity \\(r = \\sqrt{\\phi_1^2 + \\cdots + \\phi_k^2}\\) boundary-avoiding prior $$r \\sim \\text{Beta}(2, 2).$$","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Linear Prior with Autoregressive Errors — Lin_AR","text":"","code":"Lin_AR() #>   Lin_AR()  #>     n_coef: 2 #>          s: 1 #> mean_slope: 0 #>   sd_slope: 1 #>        min: -1 #>        max: 1 #>      along: NULL #>   zero_sum: FALSE Lin_AR(n_coef = 3, s = 0.5, sd_slope = 2) #>   Lin_AR(n_coef=3,s=0.5,sd_slope=2)  #>     n_coef: 3 #>          s: 0.5 #> mean_slope: 0 #>   sd_slope: 2 #>        min: -1 #>        max: 1 #>      along: NULL #>   zero_sum: FALSE"},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR1.html","id":null,"dir":"Reference","previous_headings":"","what":"Linear Prior with Autoregressive Errors of Order 1 — Lin_AR1","title":"Linear Prior with Autoregressive Errors of Order 1 — Lin_AR1","text":"Use line lines AR1 errors model main effect interaction. Typically used time.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Linear Prior with Autoregressive Errors of Order 1 — Lin_AR1","text":"","code":"Lin_AR1(   min = 0.8,   max = 0.98,   s = 1,   mean_slope = 0,   sd_slope = 1,   along = NULL,   zero_sum = FALSE )"},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Linear Prior with Autoregressive Errors of Order 1 — Lin_AR1","text":"min, max Minimum maximum values autocorrelation coefficient. Defaults 0.8 0.98. s Scale innovations AR process. Default 1. mean_slope Mean prior slope line. Default 0. sd_slope Standard deviation prior slope line. Larger values imply steeper slopes. Default 1. along Name variable used 'along' variable. used interactions. zero_sum TRUE, values must sum 0 within combination '' variables. Default FALSE.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR1.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Linear Prior with Autoregressive Errors of Order 1 — Lin_AR1","text":"object class \"bage_prior_linar\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR1.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Linear Prior with Autoregressive Errors of Order 1 — Lin_AR1","text":"Lin_AR() used interaction, separate lines constructed along 'along' variable, within combination '' variables. Arguments min max can used specify permissible range autocorrelation. Argument s controls size innovations. Smaller values tend give smoother estimates. Argument sd_slope controls size slopes lines. Larger values can give steeply sloped lines.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR1.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Linear Prior with Autoregressive Errors of Order 1 — Lin_AR1","text":"Lin_AR1() used main effect, $$\\beta_j = \\eta q_j + \\epsilon_j$$ $$\\epsilon_j = \\phi \\epsilon_{j-1} + \\varepsilon_j,$$ $$\\varepsilon_j \\sim \\text{N}(0, \\omega^2).$$ used interaction, $$\\beta_{u,v} = \\eta_j q_{u,v} + \\epsilon_{u,v}$$ $$\\epsilon_{u,v} = \\phi + \\varepsilon_{u,v},$$ $$\\varepsilon_{u,v} \\sim \\text{N}(0, \\omega^2).$$ \\(\\pmb{\\beta}\\) main effect interaction; \\(j\\) denotes position within main effect; \\(u\\) denotes position within 'along' variable interaction; \\(u\\) denotes position within '' variable(s) interaction; \\(q = - (J+1)/(J-1) + 2j/(J-1);\\) \\(q_v = - (V+1)/(V-1) + 2v/(V-1)\\). slopes priors $$\\eta \\sim \\text{N}(0, \\text{sd_slope}^2)$$ $$\\eta_u \\sim \\text{N}(0, \\text{sd_slope}^2).$$ Larger values sd_slope permit steeper slopes. Internally, Lin_AR1() derives value \\(\\omega\\) gives \\(\\epsilon_j\\) \\(\\epsilon_{u,v}\\) marginal variance \\(\\tau^2\\). Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ value s provided user. Coefficient \\(\\phi\\) constrained lie min max. prior distribution $$\\phi = (\\text{max} - \\text{min}) \\phi' - \\text{min}$$ $$\\phi' \\sim \\text{Beta}(2, 2).$$","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR1.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Linear Prior with Autoregressive Errors of Order 1 — Lin_AR1","text":"defaults min max based defaults forecast::ets().","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/Lin_AR1.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Linear Prior with Autoregressive Errors of Order 1 — Lin_AR1","text":"","code":"Lin_AR1() #>   Lin_AR1()  #>          s: 1 #> mean_slope: 0 #>   sd_slope: 1 #>        min: 0.8 #>        max: 0.98 #>      along: NULL #>   zero_sum: FALSE Lin_AR1(min = 0, s = 0.5, sd_slope = 2) #>   Lin_AR1(min=0,s=0.5,sd_slope=2)  #>          s: 0.5 #> mean_slope: 0 #>   sd_slope: 2 #>        min: 0 #>        max: 0.98 #>      along: NULL #>   zero_sum: FALSE"},{"path":"https://bayesiandemography.github.io/bage/reference/N.html","id":null,"dir":"Reference","previous_headings":"","what":"Normal Prior — N","title":"Normal Prior — N","text":"Use independent draws normal distribution model main effect interaction. Typically used variables age time, region ethnicity, natural ordering.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/N.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normal Prior — N","text":"","code":"N(s = 1)"},{"path":"https://bayesiandemography.github.io/bage/reference/N.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normal Prior — N","text":"s Scale standard deviation. Default 1.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/N.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normal Prior — N","text":"object class \"bage_prior_norm\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/N.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Normal Prior — N","text":"Argument s controls size errors. Smaller values s tend give tightly clustered estimates.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/N.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Normal Prior — N","text":"$$\\beta_j \\sim \\text{N}(0, \\tau^2)$$ \\(\\beta\\) main effect interaction. Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ s provided user.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/N.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normal Prior — N","text":"","code":"N() #>   N()  #>          s: 1 N(s = 0.5) #>   N(s=0.5)  #>          s: 0.5"},{"path":"https://bayesiandemography.github.io/bage/reference/NFix.html","id":null,"dir":"Reference","previous_headings":"","what":"Normal Prior with Fixed Variance — NFix","title":"Normal Prior with Fixed Variance — NFix","text":"Normal prior , contrast N(), variance treated fixed known. Typically used main effects interactions elements reliably estimate variance available data.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/NFix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normal Prior with Fixed Variance — NFix","text":"","code":"NFix(sd = 1)"},{"path":"https://bayesiandemography.github.io/bage/reference/NFix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normal Prior with Fixed Variance — NFix","text":"sd Standard deviation. Default 1.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/NFix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normal Prior with Fixed Variance — NFix","text":"object class \"bage_prior_normfixed\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/NFix.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Normal Prior with Fixed Variance — NFix","text":"NFix() default prior intercept.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/NFix.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Normal Prior with Fixed Variance — NFix","text":"$$\\beta_j \\sim \\text{N}(0, \\tau^2)$$ \\(\\beta\\) main effect interaction, value sd supplied user.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/NFix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normal Prior with Fixed Variance — NFix","text":"","code":"NFix() #>   NFix()  #>         sd: 1 NFix(sd = 10) #>   NFix(sd=10)  #>         sd: 10"},{"path":"https://bayesiandemography.github.io/bage/reference/RW.html","id":null,"dir":"Reference","previous_headings":"","what":"Random Walk Prior — RW","title":"Random Walk Prior — RW","text":"Use random walk model main effect, use multiple random walks model interaction. Typically used age time effects interactions involve age time.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Random Walk Prior — RW","text":"","code":"RW(s = 1, along = NULL, zero_sum = FALSE)"},{"path":"https://bayesiandemography.github.io/bage/reference/RW.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Random Walk Prior — RW","text":"s Scale prior innovations. Default 1. along Name variable used 'along' variable. used interactions. zero_sum TRUE, values must sum 0 within combination '' variables. Default FALSE.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Random Walk Prior — RW","text":"object class \"bage_prior_rw\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Random Walk Prior — RW","text":"RW() used interaction, separate random walks constructed along 'along' variable, within combination '' variables. Argument s controls size innovations. Smaller values s tend give smoother series.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Random Walk Prior — RW","text":"RW() used main effect, $$\\beta_j = \\beta_{j-1} + \\epsilon_j$$ $$\\epsilon_j \\sim \\text{N}(0, \\tau^2),$$ used interaction, $$\\beta_{u,v} = \\beta_{u,v-1} + \\epsilon_{u,v}$$ $$\\epsilon_{u,v} \\sim \\text{N}(0, \\tau^2),$$ \\(\\pmb{\\beta}\\) main effect interaction; \\(j\\) denotes position within main effect; \\(v\\) denotes position within 'along' variable interaction; \\(u\\) denotes position within '' variable(s) interaction. Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ s provided user.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/RW.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Random Walk Prior — RW","text":"","code":"RW() #>   RW()  #>          s: 1 #>      along: NULL #>   zero_sum: FALSE RW(s = 0.5) #>   RW(s=0.5)  #>          s: 0.5 #>      along: NULL #>   zero_sum: FALSE RW(along = \"cohort\") #>   RW(along=\"cohort\")  #>          s: 1 #>      along: cohort #>   zero_sum: FALSE"},{"path":"https://bayesiandemography.github.io/bage/reference/RW2.html","id":null,"dir":"Reference","previous_headings":"","what":"Second-Order Random Walk Prior — RW2","title":"Second-Order Random Walk Prior — RW2","text":"Use second-oder random walk model main effect, use multiple second-order random walks model interaction. second-order random walk effectively random walk drift drift term varies. typically used main effects interactions involve time, sustained trends upward downward.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Second-Order Random Walk Prior — RW2","text":"","code":"RW2(s = 1, sd_slope = 1, along = NULL, zero_sum = FALSE)"},{"path":"https://bayesiandemography.github.io/bage/reference/RW2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Second-Order Random Walk Prior — RW2","text":"s Scale prior innovations. Default 1. sd_slope Standard deviation initial slope. Default 1. along Name variable used 'along' variable. used interactions. zero_sum TRUE, values must sum 0 within combination '' variables. Default FALSE.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Second-Order Random Walk Prior — RW2","text":"object class \"bage_prior_rw2\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Second-Order Random Walk Prior — RW2","text":"RW2() used interaction, separate series used 'along' variable within combination '' variables. Argument s controls size innovations random walk. Smaller values s tend give smoother series. Argument n_seas controls number seasons. using quarterly data, instance, n_seas 4, using monthly data, n_seas 12. default, magnitude seasonal effects can change time. However, setting s_seas 0 produces seasonal effects fixed, eg \"January\" effect every year, \"Feburary\" effect every year, .","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Second-Order Random Walk Prior — RW2","text":"RW() used main effect, $$\\beta_j = 2 \\beta_{j-1} - \\beta_{j-2} + \\epsilon_j$$ $$\\epsilon_j \\sim \\text{N}(0, \\tau^2),$$ used interaction, $$\\beta_{u,v} = 2\\beta_{u,v-1} - \\beta_{u,v-2} + \\epsilon_{u,v}$$ $$\\epsilon_{u,v} \\sim \\text{N}(0, \\tau^2),$$ \\(\\pmb{\\beta}\\) main effect interaction; \\(j\\) denotes position within main effect; \\(v\\) denotes position within 'along' variable interaction; \\(u\\) denotes position within '' variable(s) interaction. Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ s provided user.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/RW2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Second-Order Random Walk Prior — RW2","text":"","code":"RW2() #>   RW2()  #>          s: 1 #>   sd_slope: 1 #>      along: NULL #>   zero_sum: FALSE RW2(s = 0.5) #>   RW2(s=0.5)  #>          s: 0.5 #>   sd_slope: 1 #>      along: NULL #>   zero_sum: FALSE"},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Infant.html","id":null,"dir":"Reference","previous_headings":"","what":"Second-Order Random Walk Prior with 'Infant' Indicator — RW2_Infant","title":"Second-Order Random Walk Prior with 'Infant' Indicator — RW2_Infant","text":"Use second-order random walk model variation age, indicator variable first age group. Designed use models mortality rates.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Infant.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Second-Order Random Walk Prior with 'Infant' Indicator — RW2_Infant","text":"","code":"RW2_Infant(s = 1, sd_slope = 1, zero_sum = FALSE)"},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Infant.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Second-Order Random Walk Prior with 'Infant' Indicator — RW2_Infant","text":"s Scale prior innovations. Default 1. sd_slope Standard deviation initial slope random walk. Default 1. zero_sum TRUE, values must sum 0 within combination '' variables. Default FALSE.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Infant.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Second-Order Random Walk Prior with 'Infant' Indicator — RW2_Infant","text":"Object class \"bage_prior_rw2infant\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Infant.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Second-Order Random Walk Prior with 'Infant' Indicator — RW2_Infant","text":"second-order random walk prior RW2() good job smoothing mortality rates age, except age 0, typically sudden jump rates, reflecting special risks infancy. RW2_Infant() RW2() prior special treatment first age group. RW2_Infant() used interaction, 'along' dimension always age, implying separate random walk along age within combination '' variables. Argument s controls size innovations random walk. Smaller values s tend give smoother series. Argument sd controls sl size innovations random walk. Smaller values s tend give smoother series.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Infant.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Second-Order Random Walk Prior with 'Infant' Indicator — RW2_Infant","text":"RW2_Infant() used main effect, $$\\beta_1 \\sim \\text{N}(0, 1)$$ $$\\beta_2 \\sim \\text{N}(0, \\omega^2)$$ $$\\beta_3 \\sim \\text{N}(2 \\beta_2, \\tau^2)$$ $$\\beta_j \\sim \\text{N}(2 \\beta_{j-1} - \\beta_{j-2}, \\tau^2)$$ used interaction, $$\\beta_{u,1} \\sim \\text{N}(0, 1)$$ $$\\beta_{u,2} \\sim \\text{N}(0, \\omega^2)$$ $$\\beta_{u,3} \\sim \\text{N}(2 \\beta_{u,2}, \\tau^2)$$ $$\\beta_{u,j} \\sim \\text{N}(2 \\beta_{u,v-1} - \\beta_{u,v-2}, \\tau^2)$$ \\(\\pmb{\\beta}\\) main effect interaction; \\(j\\) denotes position within main effect; \\(v\\) denotes position within 'along' variable interaction; \\(u\\) denotes position within '' variable(s) interaction. Parameter \\(\\omega\\) half-normal prior $$\\omega \\sim \\text{N}^+(0, \\text{sd}^2),$$ sd can specified user. Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ s can specified user.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Infant.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Second-Order Random Walk Prior with 'Infant' Indicator — RW2_Infant","text":"","code":"RW2_Infant() #>   RW2_Infant()  #>          s: 1 #>   sd_slope: 1 #>   zero_sum: FALSE RW2_Infant(s = 0.1) #>   RW2_Infant(s=0.1)  #>          s: 0.1 #>   sd_slope: 1 #>   zero_sum: FALSE"},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Seas.html","id":null,"dir":"Reference","previous_headings":"","what":"Second-Order Random Walk Prior with Seasonal Effect — RW2_Seas","title":"Second-Order Random Walk Prior with Seasonal Effect — RW2_Seas","text":"Use second-oder random walk seasonal effects model main effect, use multiple second-order random walks, seasonal effects, model interaction. second-order random walk effectively random walk drift drift term varies. typically used main effects interactions involve time, sustained trends upward downward.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Seas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Second-Order Random Walk Prior with Seasonal Effect — RW2_Seas","text":"","code":"RW2_Seas(   n_seas,   s = 1,   sd_slope = 1,   s_seas = 0,   sd_seas = 1,   along = NULL,   zero_sum = FALSE )"},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Seas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Second-Order Random Walk Prior with Seasonal Effect — RW2_Seas","text":"n_seas Number seasons s Scale prior innovations random walk. Default 1. sd_slope Standard deviation initial slope random walk. Default 1. s_seas Scale innovations seasonal effects. Default 0. sd_seas Standard deviation initial values seasonal effects. Default 1. along Name variable used 'along' variable. used interactions. zero_sum TRUE, values must sum 0 within combination '' variables. Default FALSE.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Seas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Second-Order Random Walk Prior with Seasonal Effect — RW2_Seas","text":"Object class \"bage_prior_rw2seasvary\" \"bage_prior_rw2seasfix\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Seas.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Second-Order Random Walk Prior with Seasonal Effect — RW2_Seas","text":"RW2_Seas() used interaction, separate series used 'along' variable within combination '' variables. Argument s controls size innovations random walk. Smaller values s tend give smoother series. Argument n_seas controls number seasons. using quarterly data, instance, n_seas 4, using monthly data, n_seas 12. default, magnitude seasonal effects fixed. However, setting s_seas value greater zero produces seasonal effects evolve time.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Seas.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Second-Order Random Walk Prior with Seasonal Effect — RW2_Seas","text":"RW2_Seas() used main effect, $$\\beta_j = \\alpha_j + \\lambda_j$$ $$\\alpha_j \\sim \\text{N}(2 \\alpha_{j-1} - \\alpha_{j-2}, \\tau^2)$$ $$\\lambda_j \\sim \\text{N}(\\lambda_{j-n}, \\omega^2),$$ used interaction, $$\\beta_{u,v} = \\alpha_{u,v} + \\lambda_{u,v}$$ $$\\alpha_{u,v} \\sim \\text{N}(2 \\alpha_{u,v-1} - \\alpha_{u,v-2}, \\tau^2),$$ $$\\lambda_{u,v} \\sim \\text{N}(\\lambda_{u,v-n}, \\omega^2)$$ \\(\\pmb{\\beta}\\) main effect interaction; \\(\\alpha_j\\) \\(\\alpha_{u,v}\\) element random walk; \\(\\lambda_j\\) \\(\\lambda_{u,v}\\) element seasonal effect; \\(j\\) denotes position within main effect; \\(v\\) denotes position within 'along' variable interaction; \\(u\\) denotes position within '' variable(s) interaction; \\(n\\) n_seas. Parameter \\(\\omega\\) half-normal prior $$\\omega \\sim \\text{N}^+(0, \\text{s\\_seas}^2),$$ s_seas provided user. s_seas set 0, \\(\\omega\\) 0, seasonal effects fixed time. Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ s provided user.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/RW2_Seas.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Second-Order Random Walk Prior with Seasonal Effect — RW2_Seas","text":"","code":"RW2_Seas(n_seas = 4)               ## seasonal effects fixed #>   RW2_Seas(n_seas=4)  #>     n_seas: 4 #>          s: 1 #>   sd_slope: 1 #>     s_seas: 0 #>    sd_seas: 1 #>      along: NULL #>   zero_sum: FALSE RW2_Seas(n_seas = 4, s_seas = 0.5) ## seasonal effects evolve #>   RW2_Seas(n_seas=4,s_seas=0.5)  #>     n_seas: 4 #>          s: 1 #>     s_seas: 0.5 #>    sd_seas: 1 #>      along: NULL #>   zero_sum: FALSE"},{"path":"https://bayesiandemography.github.io/bage/reference/RW_Seas.html","id":null,"dir":"Reference","previous_headings":"","what":"Random Walk Prior with Seasonal Effect — RW_Seas","title":"Random Walk Prior with Seasonal Effect — RW_Seas","text":"Use random walk seasonal effects model main effect, use multiple random walks, seasonal effects, model interaction. Typically used main effects interactions involve time.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW_Seas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Random Walk Prior with Seasonal Effect — RW_Seas","text":"","code":"RW_Seas(n_seas, s = 1, s_seas = 0, sd_seas = 1, along = NULL, zero_sum = FALSE)"},{"path":"https://bayesiandemography.github.io/bage/reference/RW_Seas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Random Walk Prior with Seasonal Effect — RW_Seas","text":"n_seas Number seasons s Scale prior innovations random walk. Default 1. s_seas Scale innovations seasonal effects. Default 0. sd_seas Standard deviation initial values seasonal effects. Default 1. along Name variable used 'along' variable. used interactions. zero_sum TRUE, values must sum 0 within combination '' variables. Default FALSE.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW_Seas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Random Walk Prior with Seasonal Effect — RW_Seas","text":"Object class \"bage_prior_rwseasvary\" \"bage_prior_rwseasfix\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW_Seas.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Random Walk Prior with Seasonal Effect — RW_Seas","text":"RW_Seas() used interaction, separate series used 'along' variable within combination '' variables. Argument s controls size innovations random walk. Smaller values s tend give smoother series. Argument n_seas controls number seasons. using quarterly data, instance, n_seas 4, using monthly data, n_seas 12. default, magnitude seasonal effects fixed. However, setting s_seas value greater zero produces seasonal effects evolve time.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/RW_Seas.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Random Walk Prior with Seasonal Effect — RW_Seas","text":"RW_Seas() used main effect, $$\\beta_j = \\alpha_j + \\lambda_j$$ $$\\alpha_j \\sim \\text{N}(\\alpha_{j-1}, \\tau^2)$$ $$\\lambda_j \\sim \\text{N}(\\lambda_{j-n}, \\omega^2),$$ used interaction, $$\\beta_{u,v} = \\alpha_{u,v} + \\lambda_{u,v}$$ $$\\alpha_{u,v} \\sim \\text{N}(\\alpha_{u,v-1}, \\tau^2),$$ $$\\lambda_{u,v} \\sim \\text{N}(\\lambda_{u,v-n}, \\omega^2)$$ \\(\\pmb{\\beta}\\) main effect interaction; \\(\\alpha_j\\) \\(\\alpha_{u,v}\\) element random walk; \\(\\lambda_j\\) \\(\\lambda_{u,v}\\) element seasonal effect; \\(j\\) denotes position within main effect; \\(v\\) denotes position within 'along' variable interaction; \\(u\\) denotes position within '' variable(s) interaction; \\(n\\) n_seas. Parameter \\(\\omega\\) half-normal prior $$\\omega \\sim \\text{N}^+(0, \\text{s\\_seas}^2),$$ s_seas provided user. s_seas set 0, \\(\\omega\\) 0, seasonal effects fixed time. Parameter \\(\\tau\\) half-normal prior $$\\tau \\sim \\text{N}^+(0, \\text{s}^2),$$ s provided user.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/RW_Seas.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Random Walk Prior with Seasonal Effect — RW_Seas","text":"","code":"RW_Seas(n_seas = 4)               ## seasonal effects fixed #>   RW_Seas(n_seas=4)  #>     n_seas: 4 #>          s: 1 #>     s_seas: 0 #>    sd_seas: 1 #>      along: NULL #>   zero_sum: FALSE RW_Seas(n_seas = 4, s_seas = 0.5) ## seasonal effects evolve #>   RW_Seas(n_seas=4,s_seas=0.5)  #>          n: NULL #>          s: 1 #>     s_seas: 0.5 #>    sd_seas: 1 #>      along: NULL #>   zero_sum: FALSE"},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":null,"dir":"Reference","previous_headings":"","what":"SVD-Based Prior for Age or Age-Sex Profiles — SVD","title":"SVD-Based Prior for Age or Age-Sex Profiles — SVD","text":"Use components Singular Value Decomposition (SVD) model main effect interaction involving age.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SVD-Based Prior for Age or Age-Sex Profiles — SVD","text":"","code":"SVD(ssvd, n_comp = NULL, indep = TRUE)"},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SVD-Based Prior for Age or Age-Sex Profiles — SVD","text":"ssvd Object class \"bage_ssvd\" holding scaled SVD. See scaled SVDs databases currently available bage. n_comp Number components scaled SVD use modelling. default half number components ssvd. indep Whether use separate combined SVDs terms involving sex gender. Default TRUE. See details.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"SVD-Based Prior for Age or Age-Sex Profiles — SVD","text":"object class \"bage_prior_svd\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"SVD-Based Prior for Age or Age-Sex Profiles — SVD","text":"SVD() prior assumes age, age-sex, age-gender profiles quantity modelled looks like drawn random external demographic database. instance, prior obtained via   assumes age age-sex profiles look like drawn Human Mortality Database. SVD() used interaction involving variables age sex/gender, separate profiles constructed within combination variables. bage chooses appropriate age-specific age-sex-specific SVD values internally. choice depends model term SVD() prior applied , age labels used data argument mod_pois(), mod_binom() mod_norm(). bage makes choice set_prior() called.","code":"SVD(HMD)"},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":"joint-or-independent-svds","dir":"Reference","previous_headings":"","what":"Joint or independent SVDs","title":"SVD-Based Prior for Age or Age-Sex Profiles — SVD","text":"Two possible ways extracting patterns age-sex-specific data carry separate SVDs separate datasets sex/gender; carry single SVD dataset separate entries sex/gender. Option 1 flexible. Option 2 robust sampling measurement errors. Option 1 obtained setting joint argument  FALSE. Option 1 obtained setting indep argument TRUE. default TRUE.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"SVD-Based Prior for Age or Age-Sex Profiles — SVD","text":"Case 1: Term involving age variables SVD() used age main effect, $$\\pmb{\\beta} = \\pmb{F} \\pmb{\\alpha} + \\pmb{g},$$ \\(\\pmb{\\beta}\\) main effect interaction involving age; \\(J\\) number elements \\(\\pmb{\\beta}\\); \\(n\\) number components SVD; \\(\\pmb{F}\\) known matrix dimension \\(J \\times n\\); \\(\\pmb{g}\\) known vector \\(J\\) elements. \\(\\pmb{F}\\) \\(\\pmb{g}\\) constructed large database age-specific demographic estimates performing SVD standardizing. elements \\(\\pmb{\\alpha}\\) prior $$\\alpha_k \\sim \\text{N}(0, 1), \\quad k = 1, \\cdots, K.$$ Case 2: Term involving age non-sex, non-gender variable(s) SVD() used interaction involves age involve sex gender, $$\\pmb{\\beta}_u = \\pmb{F} \\pmb{\\alpha}_u + \\pmb{g},$$ \\(\\pmb{\\beta}_u\\) subvector \\(\\pmb{\\beta}\\) holding values  \\(u\\)th combination non-age variables; \\(V\\) number elements \\(\\pmb{\\beta}_u\\); \\(n\\) number components SVD; \\(\\pmb{F}\\) known matrix dimension \\(V \\times n\\); \\(\\pmb{g}\\) known vector \\(V\\) elements. Case 3: Term involving age, sex/gender, variables SVD() used interaction involves age sex gender, two sub-cases, depending value indep. indep TRUE, $$\\pmb{\\beta}_{s} = \\pmb{F}_s \\pmb{\\alpha}_{s} + \\pmb{g}_s,$$ indep FALSE, $$\\pmb{\\beta} = \\pmb{F} \\pmb{\\alpha} + \\pmb{g},$$ \\(\\pmb{\\beta}\\) interaction involving age sex/gender; \\(\\pmb{\\beta}_{s}\\) subvector \\(\\pmb{\\beta}\\), holding values sex/gender \\(s\\); \\(J\\) number elements \\(\\pmb{\\beta}\\); \\(S\\) number sexes/genders; \\(n\\) number components SVD; \\(\\pmb{F}_s\\) known \\((J/S) \\times n\\) matrix, specific sex/gender \\(s\\); \\(\\pmb{g}_s\\) known vector \\(J/S\\) elements, specific sex/gender \\(s\\); \\(\\pmb{F}\\) known \\(J \\times n\\) matrix, values sexes/genders; \\(\\pmb{g}\\) known vector \\(J\\) elements, values sexes/genders. elements \\(\\pmb{\\alpha}_s\\) \\(\\pmb{\\alpha}\\) prior $$\\alpha_k \\sim \\text{N}(0, 1).$$ Case 4: Term involving age, sex/gender, variable(s) SVD() used interaction involves age, sex gender, variables, two sub-cases, depending value indep. indep TRUE, $$\\pmb{\\beta}_{u,s} = \\pmb{F}_s \\pmb{\\alpha}_{u,s} + \\pmb{g}_s,$$ indep FALSE, $$\\pmb{\\beta}_u = \\pmb{F} \\pmb{\\alpha}_u + \\pmb{g},$$ \\(\\pmb{\\beta}\\) interaction involving sex/gender; \\(\\pmb{\\beta}_{u,s}\\) subvector \\(\\pmb{\\beta}\\), holding values sex/gender \\(s\\) \\(u\\)th combination variables; \\(V\\) number elements \\(\\pmb{\\beta}_u\\); \\(S\\) number sexes/genders; \\(n\\) number components SVD; \\(\\pmb{F}_s\\) known \\((V/S) \\times n\\) matrix, specific sex/gender \\(s\\); \\(\\pmb{g}_s\\) known vector \\(V/S\\) elements, specific sex/gender \\(s\\); \\(\\pmb{F}\\) known \\(V \\times n\\) matrix, values sexes/genders; \\(\\pmb{g}\\) known vector \\(V\\) elements, values sexes/genders.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":"scaled-svds-of-demographic-databases-in-bage","dir":"Reference","previous_headings":"","what":"Scaled SVDs of demographic databases in bage","title":"SVD-Based Prior for Age or Age-Sex Profiles — SVD","text":"HMD Mortality rates Human Mortality Database. LFP Labor forcce participation rates OECD.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"SVD-Based Prior for Age or Age-Sex Profiles — SVD","text":"details construction scaled SVDS see vignette .","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/SVD.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SVD-Based Prior for Age or Age-Sex Profiles — SVD","text":"","code":"SVD(HMD)  #>   SVD(HMD)  #>       ssvd: HMD #>     n_comp: 3 SVD(HMD, n_comp = 3) #>   SVD(HMD)  #>       ssvd: HMD #>     n_comp: 3"},{"path":"https://bayesiandemography.github.io/bage/reference/SVD_AR.html","id":null,"dir":"Reference","previous_headings":"","what":"Dynamic SVD-Based Priors for Age Profiles or Age-Sex Profiles — SVD_AR","title":"Dynamic SVD-Based Priors for Age Profiles or Age-Sex Profiles — SVD_AR","text":"Use components Singular Value Decomposition (SVD) model interaction involving age time, age, sex/gender time, coefficients evolve time.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD_AR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dynamic SVD-Based Priors for Age Profiles or Age-Sex Profiles — SVD_AR","text":"","code":"SVD_AR(ssvd, n_comp = NULL, indep = TRUE, n_coef = 2, s = 1, zero_sum = FALSE)  SVD_AR1(   ssvd,   n_comp = NULL,   indep = TRUE,   min = 0.8,   max = 0.98,   s = 1,   zero_sum = FALSE )  SVD_RW(ssvd, n_comp = NULL, indep = TRUE, s = 1, zero_sum = FALSE)  SVD_RW2(   ssvd,   n_comp = NULL,   indep = TRUE,   s = 1,   sd_slope = 1,   zero_sum = FALSE )"},{"path":"https://bayesiandemography.github.io/bage/reference/SVD_AR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Dynamic SVD-Based Priors for Age Profiles or Age-Sex Profiles — SVD_AR","text":"ssvd Object class \"bage_ssvd\" holding scaled SVD. See scaled SVDs databases currently available bage. n_comp Number components scaled SVD use modelling. default half number components ssvd. indep Whether use separate combined SVDs terms involving sex gender. Default TRUE. See details. n_coef Number AR coefficients SVD_RW(). s Scale standard deviations terms. zero_sum TRUE, values must sum 0 within combination '' variables. Default FALSE. min, max Minimum maximum values autocorrelation coefficient SVD_AR(). Defaults 0.8 0.98. sd_slope Standard deviation prior initial slope. Default 1.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD_AR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Dynamic SVD-Based Priors for Age Profiles or Age-Sex Profiles — SVD_AR","text":"object class \"bage_prior_svd_ar\", \"bage_prior_svd_rw\", \"bage_prior_svd_rw2\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD_AR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Dynamic SVD-Based Priors for Age Profiles or Age-Sex Profiles — SVD_AR","text":"SVD_AR(), SVD_AR1(), SVD_RW(), SVD_RW2() priors assume , given period, age profiles age-sex profiles quantity modelled looks like drawn random external demographic database. instance, SVD_AR() prior obtained via   assumes profiles look like obtained Human Mortality Database.","code":"SVD_AR(HMD)"},{"path":"https://bayesiandemography.github.io/bage/reference/SVD_AR.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Dynamic SVD-Based Priors for Age Profiles or Age-Sex Profiles — SVD_AR","text":"interaction modelled involves age time, age, sex/gender, time $$\\pmb{\\beta}_t = \\pmb{F} \\pmb{\\alpha}_t + \\pmb{g},$$ involves variables besides age, sex/gender, time, $$\\pmb{\\beta}_{u,t} = \\pmb{F} \\pmb{\\alpha}_{u,t} + \\pmb{g},$$ \\(\\pmb{\\beta}\\) interaction involving age, time, possibly sex/gender, possibly variables; \\(\\pmb{\\beta}_t\\) subvector \\(\\pmb{\\beta}\\) holding values period \\(t\\); \\(\\pmb{\\beta}_{u,t}\\) subvector \\(\\pmb{\\beta}_t\\) holding values  \\(u\\)th combination non-age, non-time, non-sex/gender variables period \\(t\\); \\(J\\) number elements \\(\\pmb{\\beta}_t\\); \\(V\\) number elements \\(\\pmb{\\beta}_{u,t}\\); \\(n\\) n_coef; \\(\\pmb{F}\\) known matrix dimension \\(J \\times n\\) \\(V \\times n\\); \\(\\pmb{g}\\) known vector \\(J\\) \\(V\\) elements. \\(\\pmb{F}\\) \\(\\pmb{g}\\) constructed large database age-specific demographic estimates performing SVD standardizing. SVD_AR(), prior \\(k\\)th element \\(\\pmb{\\alpha}_t\\) \\(\\pmb{\\alpha}_{u,t}\\) $$\\alpha_{k,t} = \\phi_1 \\alpha_{k,t-1} + \\cdots + \\phi_n \\beta_{k,t-n} + \\epsilon_{k,t}$$ $$\\alpha_{k,u,t} = \\phi_1 \\alpha_{k,u,t-1} + \\cdots + \\phi_n \\beta_{k,u,t-n} + \\epsilon_{k,u,t};$$ SVD_AR1(), $$\\alpha_{k,t} = \\phi \\alpha_{k,t-1} + \\epsilon_{k,t}$$ $$\\alpha_{k,u,t} = \\phi \\alpha_{k,u,t-1} + \\epsilon_{k,u,t};$$ SVD_RW(), $$\\alpha_{k,t} = \\alpha_{k,t-1} + \\epsilon_{k,t}$$ $$\\alpha_{k,u,t} = \\alpha_{k,u,t-1} + \\epsilon_{k,u,t};$$ SVD_RW2(), $$\\alpha_{k,t} = 2 \\alpha_{k,t-1} - \\alpha_{k,t-2} + \\epsilon_{k,t}$$ $$\\alpha_{k,u,t} = 2 \\alpha_{k,u,t-1} - \\alpha_{k,u,t-2} + \\epsilon_{k,u,t}.$$ \\(\\phi\\) \\(\\epsilon\\), see AR(), AR1(), RW(), RW2().","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD_AR.html","id":"scaled-svds-of-demographic-databases-in-bage","dir":"Reference","previous_headings":"","what":"Scaled SVDs of demographic databases in bage","title":"Dynamic SVD-Based Priors for Age Profiles or Age-Sex Profiles — SVD_AR","text":"HMD Mortality rates Human Mortality Database. LFP Labor forcce participation rates OECD.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/SVD_AR.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Dynamic SVD-Based Priors for Age Profiles or Age-Sex Profiles — SVD_AR","text":"details construction scaled SVDS see vignette .","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/SVD_AR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Dynamic SVD-Based Priors for Age Profiles or Age-Sex Profiles — SVD_AR","text":"","code":"SVD_AR1(HMD) #>   SVD_AR1(HMD)  #>       ssvd: HMD #>     n_comp: 3 #>        min: 0.8 #>        max: 0.98 #>          s: 1 #>      along: NULL #>   zero_sum: FALSE SVD_RW(HMD, n_comp = 3) #>   SVD_RW(HMD)  #>       ssvd: HMD #>     n_comp: 3 #>          s: 1 #>      along: NULL #>   zero_sum: FALSE SVD_RW2(HMD, indep = FALSE) #>   SVD_RW2(HMD,indep=FALSE)  #>       ssvd: HMD #>     n_comp: 3 #>      indep: FALSE #>          s: 1 #>   sd_slope: 1 #>      along: NULL #>   zero_sum: FALSE"},{"path":"https://bayesiandemography.github.io/bage/reference/Sp.html","id":null,"dir":"Reference","previous_headings":"","what":"P-Spline Prior — Sp","title":"P-Spline Prior — Sp","text":"Use p-spline (penalised spline) model main effects interactions. Typically used age, can used variable outcomes expected vary smoothly one element next.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Sp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"P-Spline Prior — Sp","text":"","code":"Sp(n_comp = NULL, s = 1, sd = 1, sd_slope = 1, along = NULL, zero_sum = FALSE)"},{"path":"https://bayesiandemography.github.io/bage/reference/Sp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"P-Spline Prior — Sp","text":"n_comp Number spline basis functions (components) use. s Scale prior innovations. Default 1. sd Standard deviation prior first element random walk. sd_slope Standard deviation prior initial slope random walk. Default 1. along Name variable used 'along' variable. used interactions. zero_sum TRUE, values must sum 0 within combination '' variables. Default FALSE.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Sp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"P-Spline Prior — Sp","text":"object class \"bage_prior_spline\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Sp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"P-Spline Prior — Sp","text":"Sp() used interaction, separate splines used 'along' variable within combination '' variables.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Sp.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"P-Spline Prior — Sp","text":"Sp() used main effect, $$\\pmb{\\beta} = \\pmb{X} \\pmb{\\alpha}$$ used interaction, $$\\pmb{\\beta}_u = \\pmb{X} \\pmb{\\alpha}_u$$ \\(\\pmb{\\beta}\\) main effect interaction, \\(J\\) elements; \\(\\pmb{\\beta}_u\\) subvector \\(\\pmb{\\beta}\\) holding values  \\(u\\)th combination '' variables; \\(J\\) number elements \\(\\pmb{\\beta}\\); \\(U\\) number elements \\(\\pmb{\\beta}_u\\); \\(X\\) \\(J \\times n\\) \\(V \\times n\\) matrix spline basis functions; \\(n\\) n_comp. elements \\(\\pmb{\\alpha}\\) \\(\\pmb{\\alpha}_u\\) assumed follow second-order random walk.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/Sp.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"P-Spline Prior — Sp","text":"Eilers, P.H.C. Marx B. (1996). \"Flexible smoothing B-splines penalties\". Statistical Science. 11 (2): 89–121.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/Sp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"P-Spline Prior — Sp","text":"","code":"Sp() #>   Sp()  #>     n_comp: NULL #>          s: 1 #>   sd_slope: 1 #>      along: NULL #>   zero_sum: FALSE Sp(n_comp = 10) #>   Sp(n_comp=10)  #>     n_comp: 10 #>          s: 1 #>   sd_slope: 1 #>      along: NULL #>   zero_sum: FALSE"},{"path":"https://bayesiandemography.github.io/bage/reference/augment.bage_mod.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Data and Modelled Values — augment.bage_mod","title":"Extract Data and Modelled Values — augment.bage_mod","text":"Extract data rates, probabilities, means model object. return value consists original data one columns modelled values.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/augment.bage_mod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Data and Modelled Values — augment.bage_mod","text":"","code":"# S3 method for class 'bage_mod' augment(x, quiet = FALSE, ...)"},{"path":"https://bayesiandemography.github.io/bage/reference/augment.bage_mod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Data and Modelled Values — augment.bage_mod","text":"x Object class \"bage_mod\", typically created mod_pois(), mod_binom(), mod_norm(). quiet Whether suppress messages. Default FALSE. ... Unused. Included generic consistency .","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/augment.bage_mod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Data and Modelled Values — augment.bage_mod","text":"tibble, original data plus one following columns: .<outcome> Corrected extended version outcome variable, applications outcome variable missing values, data model used. .observed 'Direct' estimates rates probabilities, ie counts divided exposure size (Poisson binomial models.) .fitted Draws rates, probabilities, means. .expected Draws expected values rates probabilities (Poisson include exposure, binomial models.) Uncertain quantities represented using rvecs.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/augment.bage_mod.html","id":"fitted-vs-unfitted-models","dir":"Reference","previous_headings":"","what":"Fitted vs unfitted models","title":"Extract Data and Modelled Values — augment.bage_mod","text":"augment() typically called fitted model. case, modelled values draws joint posterior distribution rates, probabilities, means. augment() can, however, called unfitted model. case, modelled values draws joint prior distribution. words, modelled values informed model priors, values exposure, size, weights, observed outcomes.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/augment.bage_mod.html","id":"imputed-values-for-outcome-variable","dir":"Reference","previous_headings":"","what":"Imputed values for outcome variable","title":"Extract Data and Modelled Values — augment.bage_mod","text":"augment() automatically imputes missing values outcome variable. outcome variable var one NAs, augment creates variable .var holding original imputed values.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/augment.bage_mod.html","id":"data-model-for-outcome-variable","dir":"Reference","previous_headings":"","what":"Data model for outcome variable","title":"Extract Data and Modelled Values — augment.bage_mod","text":"overall model includes data model outcome variable var, augment() creates new variable .var containing estimates true value outcome.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/augment.bage_mod.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Data and Modelled Values — augment.bage_mod","text":"","code":"## specify model mod <- mod_pois(divorces ~ age + sex + time,                 data = nzl_divorces,                 exposure = population) |>   set_n_draw(n_draw = 100) ## smaller sample, so 'augment' faster  ## draw from the prior distribution mod |> augment() #> ℹ Model not fitted, so values drawn straight from prior distribution. #> # A tibble: 242 × 8 #>    age   sex     time              divorces population           .observed #>    <fct> <chr>  <int>           <rdbl<100>>      <dbl>         <rdbl<100>> #>  1 15-19 Female  2011  1e+05 (188, 1740871)     154460   0.67 (0.0012, 11) #>  2 15-19 Female  2012 108051 (157, 3798614)     153060    0.71 (0.001, 25) #>  3 15-19 Female  2013  81163 (578, 2663473)     152250   0.53 (0.0038, 17) #>  4 15-19 Female  2014  69874 (682, 4707279)     152020   0.46 (0.0045, 31) #>  5 15-19 Female  2015   83738 (92, 3215953)     152970    0.55 (6e-04, 21) #>  6 15-19 Female  2016   153388 (181, 7e+06)     154170   0.99 (0.0012, 45) #>  7 15-19 Female  2017 124075 (110, 3.8e+07)     154450  0.8 (0.00071, 245) #>  8 15-19 Female  2018 110310 (106, 2.4e+07)     154170 0.72 (0.00069, 154) #>  9 15-19 Female  2019   1e+05 (56, 1.3e+07)     154760  0.67 (0.00036, 86) #> 10 15-19 Female  2020  116577 (61, 1.3e+07)     154480    0.75 (4e-04, 86) #> # ℹ 232 more rows #> # ℹ 2 more variables: .fitted <rdbl<100>>, .expected <rdbl<100>>  ## fit model mod <- mod |>   fit()  ## draw from the posterior distribution mod |> augment() #> # A tibble: 242 × 8 #>    age   sex     time divorces population .observed                    .fitted #>    <fct> <chr>  <int>    <dbl>      <dbl>     <dbl>                <rdbl<100>> #>  1 15-19 Female  2011        0     154460 0         1.2e-05 (7.1e-06, 1.8e-05) #>  2 15-19 Female  2012        6     153060 0.0000392   1.5e-05 (1e-05, 2.3e-05) #>  3 15-19 Female  2013        3     152250 0.0000197 1.3e-05 (8.2e-06, 2.1e-05) #>  4 15-19 Female  2014        3     152020 0.0000197   1.3e-05 (7.3e-06, 2e-05) #>  5 15-19 Female  2015        3     152970 0.0000196   1.3e-05 (8.3e-06, 2e-05) #>  6 15-19 Female  2016        3     154170 0.0000195 1.3e-05 (7.9e-06, 1.7e-05) #>  7 15-19 Female  2017        6     154450 0.0000388   1.3e-05 (9.1e-06, 2e-05) #>  8 15-19 Female  2018        0     154170 0           1e-05 (5.8e-06, 1.6e-05) #>  9 15-19 Female  2019        3     154760 0.0000194 1.2e-05 (7.6e-06, 1.9e-05) #> 10 15-19 Female  2020        0     154480 0         8.8e-06 (5.3e-06, 1.4e-05) #> # ℹ 232 more rows #> # ℹ 1 more variable: .expected <rdbl<100>>  ## insert a missing value into outcome variable divorces_missing <- nzl_divorces divorces_missing$divorces[1] <- NA  ## fitting model and calling 'augument' ## creates a new variable called '.divorces' ## holding observed and imputed values mod_pois(divorces ~ age + sex + time,          data = divorces_missing,          exposure = population) |>   fit() |>   augment() #> # A tibble: 242 × 9 #>    age   sex     time divorces    .divorces population  .observed #>    <fct> <chr>  <int>    <dbl> <rdbl<1000>>      <dbl>      <dbl> #>  1 15-19 Female  2011       NA     2 (0, 6)     154460 NA         #>  2 15-19 Female  2012        6     6 (6, 6)     153060  0.0000392 #>  3 15-19 Female  2013        3     3 (3, 3)     152250  0.0000197 #>  4 15-19 Female  2014        3     3 (3, 3)     152020  0.0000197 #>  5 15-19 Female  2015        3     3 (3, 3)     152970  0.0000196 #>  6 15-19 Female  2016        3     3 (3, 3)     154170  0.0000195 #>  7 15-19 Female  2017        6     6 (6, 6)     154450  0.0000388 #>  8 15-19 Female  2018        0     0 (0, 0)     154170  0         #>  9 15-19 Female  2019        3     3 (3, 3)     154760  0.0000194 #> 10 15-19 Female  2020        0     0 (0, 0)     154480  0         #> # ℹ 232 more rows #> # ℹ 2 more variables: .fitted <rdbl<1000>>, .expected <rdbl<1000>>  ## specifying a data model for the ## original data also leads to a new ## variable called '.divorces' mod_pois(divorces ~ age + sex + time,          data = nzl_divorces,          exposure = population) |>   set_datamod_outcome_rr3() |>   fit() |>   augment() #> # A tibble: 242 × 9 #>    age   sex     time divorces    .divorces population .observed #>    <fct> <chr>  <int>    <dbl> <rdbl<1000>>      <dbl>     <dbl> #>  1 15-19 Female  2011        0     1 (0, 2)     154460 0         #>  2 15-19 Female  2012        6     6 (4, 8)     153060 0.0000392 #>  3 15-19 Female  2013        3     3 (1, 5)     152250 0.0000197 #>  4 15-19 Female  2014        3     3 (1, 5)     152020 0.0000197 #>  5 15-19 Female  2015        3     3 (1, 5)     152970 0.0000196 #>  6 15-19 Female  2016        3     3 (1, 5)     154170 0.0000195 #>  7 15-19 Female  2017        6     6 (4, 8)     154450 0.0000388 #>  8 15-19 Female  2018        0     1 (0, 2)     154170 0         #>  9 15-19 Female  2019        3     3 (1, 5)     154760 0.0000194 #> 10 15-19 Female  2020        0     1 (0, 2)     154480 0         #> # ℹ 232 more rows #> # ℹ 2 more variables: .fitted <rdbl<1000>>, .expected <rdbl<1000>>"},{"path":"https://bayesiandemography.github.io/bage/reference/bage-package.html","id":null,"dir":"Reference","previous_headings":"","what":"Package 'bage' — bage-package","title":"Package 'bage' — bage-package","text":"Bayesian estimation forecasting age-specific rates. Estimation uses TMB, fast.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/bage-package.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Package 'bage' — bage-package","text":"Specify model mod_pois() Specify Poisson model mod_binom() Specify binomial model mod_norm() Specify normal model set_prior() Specify prior main effect interaction priors List available priors main effects interactions set_disp() Specify prior dispersion/variance set_var_age() Identify age variable data set_var_sexgender() Identify sex gender variable data set_var_time() Identify time variable data Fit model fit() Derive posterior distribution is_fitted() See model fitted Extract results augment() Add cell-level estimates data components() Hyper-parameters tidy() One-line summary set_n_draw() Specify number prior posterior draws Forecast forecast() Use model obtain estimates future periods Check model replicate_data() Compare real simulated data report_sim() Simulation study model SVD-based modelling age profiles components() Matrices offsets scaled SVD generate() Random profiles HFD Scaled SVD fertility rates Human Fertility Database HMD Scaled SVD mortality rates Human Mortality Database LFP Scaled SVD labor force participation rates OECD Data isl_deaths Deaths Iceland kor_births Births South Korea nld_expenditure Health expenditure Netherlands nzl_divorces Divorces New Zealand nzl_households One-person households New Zealand nzl_injuries Fatal injuries New Zealand usa_deaths Accidental deaths USA","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/bage-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Package 'bage' — bage-package","text":"Maintainer: John Bryant john@bayesiandemography.com Authors: Junni Zhang junnizhang@163.com contributors: Bayesian Demography Limited [copyright holder]","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_mod.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Values for Hyper-Parameters — components.bage_mod","title":"Extract Values for Hyper-Parameters — components.bage_mod","text":"Extract values hyper-parameters model object. Hyper-parameters include main effects interactions, dispersion variance terms, SVD spline coefficients.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_mod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Values for Hyper-Parameters — components.bage_mod","text":"","code":"# S3 method for class 'bage_mod' components(object, quiet = FALSE, ...)"},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_mod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Values for Hyper-Parameters — components.bage_mod","text":"object Object class \"bage_mod\", typically created mod_pois(), mod_binom(), mod_norm(). quiet Whether suppress messages. Default FALSE. ... Unused. Included generic consistency .","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_mod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Values for Hyper-Parameters — components.bage_mod","text":"tibble four columns columns: return value contains following columns: term Model term hyper-parameter belongs . component Component within term. level Element within component . .fitted rvec containing draws posterior distribution.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_mod.html","id":"fitted-vs-unfitted-models","dir":"Reference","previous_headings":"","what":"Fitted vs unfitted models","title":"Extract Values for Hyper-Parameters — components.bage_mod","text":"components() typically called fitted model. case, modelled values draws joint posterior distribution hyper-parameters model. components() can, however, called unfitted model. case, modelled values draws joint prior distribution. words, modelled values informed model priors, exposure, size, weights argument model, observed outcomes.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_mod.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Values for Hyper-Parameters — components.bage_mod","text":"","code":"## specify model mod <- mod_pois(injuries ~ age + sex + year,                 data = nzl_injuries,                 exposure = popn)  ## extract prior distribution ## of hyper-parameters mod |>   components() #> ℹ Model not fitted, so values drawn straight from prior distribution. #> # A tibble: 37 × 4 #>    term        component level                    .fitted #>    <chr>       <chr>     <chr>               <rdbl<1000>> #>  1 (Intercept) effect    (Intercept)     -0.015 (-2, 1.8) #>  2 age         effect    0-4                     0 (0, 0) #>  3 age         effect    5-9          -0.0094 (-2.2, 2.2) #>  4 age         effect    10-14          -0.0077 (-3, 3.2) #>  5 age         effect    15-19         -0.013 (-3.6, 4.1) #>  6 age         effect    20-24       -0.00077 (-4.1, 4.6) #>  7 age         effect    25-29         -0.00016 (-5, 5.5) #>  8 age         effect    30-34         0.0022 (-5.6, 5.8) #>  9 age         effect    35-39           0.01 (-5.7, 5.9) #> 10 age         effect    40-44            0.017 (-6.1, 6) #> # ℹ 27 more rows  ## fit model mod <- mod |>   fit()  ## extract posterior distribution ## of hyper-parameters mod |>   components() #> # A tibble: 37 × 4 #>    term        component level                 .fitted #>    <chr>       <chr>     <chr>            <rdbl<1000>> #>  1 (Intercept) effect    (Intercept) -5.8 (-6.9, -4.7) #>  2 age         effect    0-4                  0 (0, 0) #>  3 age         effect    5-9         -1.3 (-1.5, -1.2) #>  4 age         effect    10-14       -0.87 (-1, -0.73) #>  5 age         effect    15-19       0.86 (0.76, 0.97) #>  6 age         effect    20-24            1 (0.9, 1.1) #>  7 age         effect    25-29       0.86 (0.75, 0.96) #>  8 age         effect    30-34       0.76 (0.65, 0.86) #>  9 age         effect    35-39       0.76 (0.66, 0.87) #> 10 age         effect    40-44       0.75 (0.65, 0.87) #> # ℹ 27 more rows"},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_ssvd.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Components used by SVD Summary — components.bage_ssvd","title":"Extract Components used by SVD Summary — components.bage_ssvd","text":"Extract matrix offset used scaled SVD summary demographic database.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_ssvd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Components used by SVD Summary — components.bage_ssvd","text":"","code":"# S3 method for class 'bage_ssvd' components(object, n_comp = NULL, indep = NULL, age_labels = NULL, ...)"},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_ssvd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Components used by SVD Summary — components.bage_ssvd","text":"object object class \"bage_ssvd\". n_comp number components. default half total number components object. indep Whether use independent joint SVDs sex/gender. value supplied, SVD sex/gender dimension used. Note default different SVD(). age_labels Age labels desired age age-sex profile. labels supplied, detailed profile available used. ... currently used.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_ssvd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Components used by SVD Summary — components.bage_ssvd","text":"tibble offset components.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_ssvd.html","id":"scaled-svds-of-demographic-databases-in-bage","dir":"Reference","previous_headings":"","what":"Scaled SVDs of demographic databases in bage","title":"Extract Components used by SVD Summary — components.bage_ssvd","text":"HMD Mortality rates Human Mortality Database. LFP Labor forcce participation rates OECD.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/components.bage_ssvd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Components used by SVD Summary — components.bage_ssvd","text":"","code":"## females and males combined components(LFP, n_comp = 3) #> # A tibble: 52 × 3 #>    component age    value #>    <fct>     <chr>  <dbl> #>  1 Offset    15-19 -0.839 #>  2 Offset    20-24  0.754 #>  3 Offset    25-29  1.46  #>  4 Offset    30-34  1.56  #>  5 Offset    35-39  1.63  #>  6 Offset    40-44  1.68  #>  7 Offset    45-49  1.58  #>  8 Offset    50-54  1.25  #>  9 Offset    55-59  0.645 #> 10 Offset    60-64 -0.398 #> # ℹ 42 more rows  ## females and males modelled independently components(LFP, indep = TRUE, n_comp = 3) #> # A tibble: 104 × 4 #>    component sex    age    value #>    <fct>     <chr>  <chr>  <dbl> #>  1 Offset    Female 15-19 -0.989 #>  2 Offset    Female 20-24  0.455 #>  3 Offset    Female 25-29  0.898 #>  4 Offset    Female 30-34  0.881 #>  5 Offset    Female 35-39  0.985 #>  6 Offset    Female 40-44  1.10  #>  7 Offset    Female 45-49  1.04  #>  8 Offset    Female 50-54  0.734 #>  9 Offset    Female 55-59  0.162 #> 10 Offset    Female 60-64 -0.857 #> # ℹ 94 more rows  ## joint model for females and males components(LFP, indep = FALSE, n_comp = 3) #> # A tibble: 104 × 4 #>    component sex    age    value #>    <fct>     <chr>  <chr>  <dbl> #>  1 Offset    Female 15-19 -1.00  #>  2 Offset    Female 20-24  0.481 #>  3 Offset    Female 25-29  0.890 #>  4 Offset    Female 30-34  0.851 #>  5 Offset    Female 35-39  0.965 #>  6 Offset    Female 40-44  1.09  #>  7 Offset    Female 45-49  1.05  #>  8 Offset    Female 50-54  0.747 #>  9 Offset    Female 55-59  0.171 #> 10 Offset    Female 60-64 -0.855 #> # ℹ 94 more rows  ## specify age groups labels <- poputils::age_labels(type = \"five\", min = 15, max = 60) components(LFP, age_labels = labels) #> # A tibble: 36 × 3 #>    component   age    value #>    <fct>       <chr>  <dbl> #>  1 Offset      15-19 -1.00  #>  2 Offset      20-24  0.737 #>  3 Offset      25-29  1.49  #>  4 Offset      30-34  1.64  #>  5 Offset      35-39  1.71  #>  6 Offset      40-44  1.74  #>  7 Offset      45-49  1.62  #>  8 Offset      50-54  1.28  #>  9 Offset      55-59  0.653 #> 10 Component 1 15-19 -0.279 #> # ℹ 26 more rows"},{"path":"https://bayesiandemography.github.io/bage/reference/computations.html","id":null,"dir":"Reference","previous_headings":"","what":"Information on Computations Performed Duration Model Fitting — computations","title":"Information on Computations Performed Duration Model Fitting — computations","text":"Get information computations performed function fit(). information includes total time used fitting, time used two particular tasks can slow: running optimizer stats::nlminb(), drawing multivariate normal returned TMB. also includes values returned optimizer: number iterations needed, messages convergence.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/computations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Information on Computations Performed Duration Model Fitting — computations","text":"","code":"computations(object)"},{"path":"https://bayesiandemography.github.io/bage/reference/computations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Information on Computations Performed Duration Model Fitting — computations","text":"object fitted object class \"bage_mod\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/computations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Information on Computations Performed Duration Model Fitting — computations","text":"tibble following variables: time_total Total duration, seconds, fitting process. time_optim Time used optimizer (stats::nlminb()) time_draws Time used drawing drawing multivariate normal iter Number iterations required stats::nlminb() message Message convergence returned stats::nlminb().","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/computations.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Information on Computations Performed Duration Model Fitting — computations","text":"","code":"mod <- mod_pois(divorces ~ age + sex + time,                 data = nzl_divorces,                 exposure = population) |>   fit()  computations(mod) #> # A tibble: 1 × 5 #>   time_total time_optim time_draws  iter message                  #>        <dbl>      <dbl>      <dbl> <int> <chr>                    #> 1      0.150     0.0788    0.00366    11 relative convergence (4)"},{"path":"https://bayesiandemography.github.io/bage/reference/datamods.html","id":null,"dir":"Reference","previous_headings":"","what":"Data Models — datamods","title":"Data Models — datamods","text":"models rates, probabilities, means created functions mod_pois(), mod_binom(), mod_norm() can extended adding data models, also referred measurement error models. Data models can applied outcome variable, exposure variable (Poisson models), size variable (binomial models).","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/datamods.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Data Models — datamods","text":"Data models outcome variable Data models exposure size variable None implemented yet","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/fit.bage_mod.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a Model — fit.bage_mod","title":"Fit a Model — fit.bage_mod","text":"Calculate posterior distribution model.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/fit.bage_mod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a Model — fit.bage_mod","text":"","code":"# S3 method for class 'bage_mod' fit(   object,   quiet = TRUE,   method = c(\"standard\", \"inner-outer\"),   vars_inner = NULL,   ... )"},{"path":"https://bayesiandemography.github.io/bage/reference/fit.bage_mod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a Model — fit.bage_mod","text":"object bage_mod object, created mod_pois(), mod_binom(), mod_norm(). quiet Whether suppress warning messages nlminb(). Default TRUE, since messages almost always false alarms. method Estimation method. Current choices \"standard\" (default) \"inner-outer\". See details. vars_inner Names variables use inner model method \"inner-outer\". NULL(default)vars_inner` age, sex/gender, time variables. ... currently used.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/fit.bage_mod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a Model — fit.bage_mod","text":"bage_mod object","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/fit.bage_mod.html","id":"estimation-methods","dir":"Reference","previous_headings":"","what":"Estimation methods","title":"Fit a Model — fit.bage_mod","text":"\"standard\" parameters, lowest-level rates, probabilities, means jointly estimated within TMB. default. \"inner-outer\". Multiple-stage estimation, can faster \"standard\" models many parameters. Step 1, data aggregated across dimensions specified var_inner, model inner variables fitted data. Step 2, data aggregated across remaining variables, model outer variables fitted data. Parameter estimtes steps 1 2 combined.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/fit.bage_mod.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit a Model — fit.bage_mod","text":"","code":"## specify model mod <- mod_pois(injuries ~ age + sex + year,                 data = nzl_injuries,                 exposure = popn)  ## examine unfitted model mod #>  #>     ------ Unfitted Poisson model ------ #>  #>  #>    injuries ~ age + sex + year #>  #>  #>         term  prior along zero_sum n_par n_par_free #>  (Intercept) NFix()     -        -     1          1 #>          age   RW()   age        -    12         11 #>          sex NFix()     -        -     2          2 #>         year   RW()  year        -    19         18 #>  #>  #>           dispersion: mean=1 #>             exposure: popn #>              var_age: age #>        var_sexgender: sex #>             var_time: year #>               n_draw: 1000  ## fit model mod <- fit(mod)  ## examine fitted model mod #>  #>     ------ Fitted Poisson model ------ #>  #>  #>    injuries ~ age + sex + year #>  #>  #>         term  prior along zero_sum n_par n_par_free std_dev #>  (Intercept) NFix()     -        -     1          1       - #>          age   RW()   age        -    12         11    0.76 #>          sex NFix()     -        -     2          2    0.72 #>         year   RW()  year        -    19         18    0.08 #>  #>  #>           dispersion: mean=1 #>             exposure: popn #>              var_age: age #>        var_sexgender: sex #>             var_time: year #>               n_draw: 1000 #>  #>  #>  time_total time_optim time_draws iter                    message #>        0.23       0.13       0.00   12   relative convergence (4) #>   ## extract rates aug <- augment(mod) aug #> # A tibble: 912 × 9 #>    age   sex    ethnicity  year injuries  popn .observed #>    <fct> <chr>  <chr>     <int>    <int> <int>     <dbl> #>  1 0-4   Female Maori      2000       12 35830 0.000335  #>  2 5-9   Female Maori      2000        6 35120 0.000171  #>  3 10-14 Female Maori      2000        3 32830 0.0000914 #>  4 15-19 Female Maori      2000        6 27130 0.000221  #>  5 20-24 Female Maori      2000        6 24380 0.000246  #>  6 25-29 Female Maori      2000        6 24160 0.000248  #>  7 30-34 Female Maori      2000       12 22560 0.000532  #>  8 35-39 Female Maori      2000        3 22230 0.000135  #>  9 40-44 Female Maori      2000        6 18130 0.000331  #> 10 45-49 Female Maori      2000        6 13770 0.000436  #> # ℹ 902 more rows #> # ℹ 2 more variables: .fitted <rdbl<1000>>, .expected <rdbl<1000>>  ## extract hyper-parameters comp <- components(mod) comp #> # A tibble: 37 × 4 #>    term        component level                 .fitted #>    <chr>       <chr>     <chr>            <rdbl<1000>> #>  1 (Intercept) effect    (Intercept) -5.8 (-6.9, -4.7) #>  2 age         effect    0-4                  0 (0, 0) #>  3 age         effect    5-9         -1.3 (-1.5, -1.2) #>  4 age         effect    10-14       -0.87 (-1, -0.75) #>  5 age         effect    15-19       0.86 (0.76, 0.97) #>  6 age         effect    20-24           1 (0.91, 1.1) #>  7 age         effect    25-29       0.86 (0.75, 0.96) #>  8 age         effect    30-34       0.75 (0.65, 0.86) #>  9 age         effect    35-39       0.76 (0.66, 0.87) #> 10 age         effect    40-44       0.76 (0.65, 0.86) #> # ℹ 27 more rows"},{"path":"https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.html","id":null,"dir":"Reference","previous_headings":"","what":"Use a Model to Make a Forecast — forecast.bage_mod","title":"Use a Model to Make a Forecast — forecast.bage_mod","text":"Forecast rates, probabilities, means, model parameters.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use a Model to Make a Forecast — forecast.bage_mod","text":"","code":"# S3 method for class 'bage_mod' forecast(   object,   newdata = NULL,   output = c(\"augment\", \"components\"),   include_estimates = FALSE,   labels = NULL,   ... )"},{"path":"https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use a Model to Make a Forecast — forecast.bage_mod","text":"object bage_mod object, typically created mod_pois(), mod_binom(), mod_norm(). newdata Data frame data future periods. output Type output returned include_estimates Whether include historical estimates along forecasts. Default FALSE. labels Labels future values. ... currently used.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Use a Model to Make a Forecast — forecast.bage_mod","text":"tibble.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.html","id":"how-the-forecasts-are-constructed","dir":"Reference","previous_headings":"","what":"How the forecasts are constructed","title":"Use a Model to Make a Forecast — forecast.bage_mod","text":"Internally, steps involved forecast : Forecast time-varying main effects interactions, e.g. time main effect, age-time interaction. Combine forecasts time-varying main effects interactions non-time-varying parameters, e.g. age effects dispersion. Use combined parameters generate values rates, probabilities means. newdata argument provided, output \"augment\", draw values outcome. vignette(\"vig2_math\") technical details.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.html","id":"output","dir":"Reference","previous_headings":"","what":"Output","title":"Use a Model to Make a Forecast — forecast.bage_mod","text":"output \"augment\" (default), return value forecast() looks like output function augment(). output \"components\", return value looks like output components(). include_estimates FALSE (default), output forecast() excludes values time-varying parameters period covered data. include_estimates TRUE, output includes values. Setting include_estimates TRUE can helpful creating graphs combine estimates forecasts.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.html","id":"fitted-and-unfitted-models","dir":"Reference","previous_headings":"","what":"Fitted and unfitted models","title":"Use a Model to Make a Forecast — forecast.bage_mod","text":"forecast() typically used fitted model, .e. model parameter values estimated data. resulting forecasts reflect data priors. forecast() can, however, used unfitted model. case, forecasts based entirely priors. See example. Experimenting forecasts based entirely priors can helpful choosing appropriate model.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.html","id":"warning","dir":"Reference","previous_headings":"","what":"Warning","title":"Use a Model to Make a Forecast — forecast.bage_mod","text":"interface forecast() finalised.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/forecast.bage_mod.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Use a Model to Make a Forecast — forecast.bage_mod","text":"","code":"## specify and fit model mod <- mod_pois(injuries ~ age * sex + ethnicity + year,                 data = nzl_injuries,                 exposure = popn) |>   fit() mod #>  #>     ------ Fitted Poisson model ------ #>  #>  #>    injuries ~ age * sex + ethnicity + year #>  #>  #>         term  prior along zero_sum n_par n_par_free std_dev #>  (Intercept) NFix()     -        -     1          1       - #>          age   RW()   age        -    12         11    0.73 #>          sex NFix()     -        -     2          2    0.21 #>    ethnicity NFix()     -        -     2          2    0.45 #>         year   RW()  year        -    19         18    0.09 #>      age:sex   RW()   age    FALSE    24         22    0.36 #>  #>  #>           dispersion: mean=1 #>             exposure: popn #>              var_age: age #>        var_sexgender: sex #>             var_time: year #>               n_draw: 1000 #>  #>  #>  time_total time_optim time_draws iter                    message #>        0.50       0.27       0.01   14   relative convergence (4) #>   ## forecasts mod |>   forecast(labels = 2019:2024) #> # A tibble: 288 × 9 #>    age   sex   ethnicity  year injuries  popn .observed                  .fitted #>    <fct> <chr> <chr>     <int>    <dbl> <int>     <dbl>             <rdbl<1000>> #>  1 0-4   Fema… Maori      2019       NA    NA        NA 2e-04 (0.00014, 0.00026) #>  2 0-4   Fema… Maori      2020       NA    NA        NA 2e-04 (0.00014, 0.00028) #>  3 0-4   Fema… Maori      2021       NA    NA        NA 2e-04 (0.00014, 0.00027) #>  4 0-4   Fema… Maori      2022       NA    NA        NA 2e-04 (0.00014, 0.00028) #>  5 0-4   Fema… Maori      2023       NA    NA        NA 2e-04 (0.00014, 0.00028) #>  6 0-4   Fema… Maori      2024       NA    NA        NA 2e-04 (0.00013, 0.00029) #>  7 0-4   Fema… Non Maori  2019       NA    NA        NA 1e-04 (7.4e-05, 0.00014) #>  8 0-4   Fema… Non Maori  2020       NA    NA        NA 1e-04 (7.3e-05, 0.00015) #>  9 0-4   Fema… Non Maori  2021       NA    NA        NA 1e-04 (7.2e-05, 0.00014) #> 10 0-4   Fema… Non Maori  2022       NA    NA        NA 1e-04 (7.1e-05, 0.00015) #> # ℹ 278 more rows #> # ℹ 1 more variable: .expected <rdbl<1000>>  ## combined estimates and forecasts mod |>   forecast(labels = 2019:2024,            include_estimates = TRUE) #> # A tibble: 1,200 × 9 #>    age   sex    ethnicity  year injuries  popn .observed #>    <fct> <chr>  <chr>     <int>    <dbl> <int>     <dbl> #>  1 0-4   Female Maori      2000       12 35830 0.000335  #>  2 5-9   Female Maori      2000        6 35120 0.000171  #>  3 10-14 Female Maori      2000        3 32830 0.0000914 #>  4 15-19 Female Maori      2000        6 27130 0.000221  #>  5 20-24 Female Maori      2000        6 24380 0.000246  #>  6 25-29 Female Maori      2000        6 24160 0.000248  #>  7 30-34 Female Maori      2000       12 22560 0.000532  #>  8 35-39 Female Maori      2000        3 22230 0.000135  #>  9 40-44 Female Maori      2000        6 18130 0.000331  #> 10 45-49 Female Maori      2000        6 13770 0.000436  #> # ℹ 1,190 more rows #> # ℹ 2 more variables: .fitted <rdbl<1000>>, .expected <rdbl<1000>>  ## hyper-parameters mod |>   forecast(labels = 2019:2024,            output = \"components\") #> # A tibble: 6 × 4 #>   term  component level                .fitted #>   <chr> <chr>     <chr>           <rdbl<1000>> #> 1 year  effect    2019    -0.21 (-0.35, -0.08) #> 2 year  effect    2020   -0.21 (-0.37, -0.051) #> 3 year  effect    2021   -0.21 (-0.39, -0.029) #> 4 year  effect    2022  -0.21 (-0.42, -0.0088) #> 5 year  effect    2023  -0.21 (-0.43, 0.00098) #> 6 year  effect    2024     -0.2 (-0.47, 0.026)  ## hold back some data and forecast library(dplyr, warn.conflicts = FALSE) data_historical <- nzl_injuries |>   filter(year <= 2015) data_forecast <- nzl_injuries |>   filter(year > 2015) |>   mutate(injuries = NA) mod_pois(injuries ~ age * sex + ethnicity + year,          data = data_historical,          exposure = popn) |>   fit() |>   forecast(newdata = data_forecast) #> # A tibble: 144 × 9 #>    age   sex    ethnicity  year     injuries  popn .observed #>    <fct> <chr>  <chr>     <int> <rdbl<1000>> <int>     <dbl> #>  1 0-4   Female Maori      2016    8 (3, 15) 41220        NA #>  2 5-9   Female Maori      2016     2 (0, 6) 43230        NA #>  3 10-14 Female Maori      2016     2 (0, 6) 37640        NA #>  4 15-19 Female Maori      2016   12 (5, 21) 36040        NA #>  5 20-24 Female Maori      2016   10 (4, 19) 33760        NA #>  6 25-29 Female Maori      2016    8 (2, 15) 30530        NA #>  7 30-34 Female Maori      2016    6 (2, 12) 24480        NA #>  8 35-39 Female Maori      2016    6 (1, 12) 23170        NA #>  9 40-44 Female Maori      2016    6 (2, 12) 23940        NA #> 10 45-49 Female Maori      2016    6 (2, 12) 23580        NA #> # ℹ 134 more rows #> # ℹ 2 more variables: .fitted <rdbl<1000>>, .expected <rdbl<1000>>  ## forecast based on priors only mod_unfitted <- mod_pois(injuries ~ age * sex + ethnicity + year,                          data = nzl_injuries,                          exposure = popn) mod_unfitted |>   forecast(labels = 2019:2024) #> ℹ Model not fitted, so values drawn straight from prior distribution. #> # A tibble: 288 × 9 #>    age   sex    ethnicity  year injuries  popn .observed               .fitted #>    <fct> <chr>  <chr>     <int>    <dbl> <int>     <dbl>          <rdbl<1000>> #>  1 0-4   Female Maori      2019       NA    NA        NA 0.62 (9.1e-06, 30933) #>  2 0-4   Female Maori      2020       NA    NA        NA 0.64 (2.4e-06, 33631) #>  3 0-4   Female Maori      2021       NA    NA        NA 0.67 (2.7e-06, 18677) #>  4 0-4   Female Maori      2022       NA    NA        NA 0.59 (2.2e-06, 28280) #>  5 0-4   Female Maori      2023       NA    NA        NA 0.63 (1.4e-06, 54831) #>  6 0-4   Female Maori      2024       NA    NA        NA 0.67 (1.9e-06, 53181) #>  7 0-4   Female Non Maori  2019       NA    NA        NA 0.65 (8.5e-06, 27310) #>  8 0-4   Female Non Maori  2020       NA    NA        NA 0.64 (5.7e-06, 27874) #>  9 0-4   Female Non Maori  2021       NA    NA        NA 0.65 (5.8e-06, 16056) #> 10 0-4   Female Non Maori  2022       NA    NA        NA 0.64 (1.9e-06, 18578) #> # ℹ 278 more rows #> # ℹ 1 more variable: .expected <rdbl<1000>>"},{"path":"https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Values from Priors — generate.bage_prior_ar","title":"Generate Values from Priors — generate.bage_prior_ar","text":"Generate draws priors model terms. terms assumed main effects, except case dynamic SVD priors (eg SVD_RW()) assumed age-time interactions.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Values from Priors — generate.bage_prior_ar","text":"","code":"# S3 method for class 'bage_prior_ar' generate(x, n = 20, n_draw = 25, ...)  # S3 method for class 'bage_prior_known' generate(x, n = 20, n_draw = 25, ...)  # S3 method for class 'bage_prior_norm' generate(x, n = 20, n_draw = 25, ...)  # S3 method for class 'bage_prior_normfixed' generate(x, n = 20, n_draw = 25, ...)  # S3 method for class 'bage_prior_rw' generate(x, n = 20, n_draw = 25, ...)  # S3 method for class 'bage_prior_rwseasfix' generate(x, n = 20, n_draw = 25, ...)  # S3 method for class 'bage_prior_rw2' generate(x, n = 20, n_draw = 25, ...)"},{"path":"https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Values from Priors — generate.bage_prior_ar","text":"x Object class \"bage_prior\" n Number elements term. Default 20. n_draw Number draws. Default 25. ... Unused. Included generic consistency .","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Values from Priors — generate.bage_prior_ar","text":"tibble","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/generate.bage_prior_ar.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate Values from Priors — generate.bage_prior_ar","text":"","code":"rw <- RW() generate(rw) #> # A tibble: 500 × 3 #>        x  draw   value #>    <int> <int>   <dbl> #>  1     1     1  0      #>  2     2     1 -0.264  #>  3     3     1  0.0195 #>  4     4     1 -0.0368 #>  5     5     1 -0.284  #>  6     6     1  0.0514 #>  7     7     1 -0.557  #>  8     8     1  0.143  #>  9     9     1  0.170  #> 10    10     1  0.0578 #> # ℹ 490 more rows"},{"path":"https://bayesiandemography.github.io/bage/reference/generate.bage_ssvd.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Random Age or Age-Sex Profiles — generate.bage_ssvd","title":"Generate Random Age or Age-Sex Profiles — generate.bage_ssvd","text":"Generate random age age-sex profiles object class \"bage_ssvd\". object class \"bage_ssvd\" holds results SVD decomposition demographic data.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/generate.bage_ssvd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Random Age or Age-Sex Profiles — generate.bage_ssvd","text":"","code":"# S3 method for class 'bage_ssvd' generate(x, n_draw = 20, n_comp = NULL, indep = NULL, age_labels = NULL, ...)"},{"path":"https://bayesiandemography.github.io/bage/reference/generate.bage_ssvd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Random Age or Age-Sex Profiles — generate.bage_ssvd","text":"x object class \"bage_ssvd\". n_draw Number random draws generate. n_comp number components. default half total number components object. indep Whether use independent joint SVDs sex/gender. value supplied, SVD sex/gender dimension used. Note default different SVD(). age_labels Age labels desired age age-sex profile. labels supplied, detailed profile available used. ... Unused. Included generic consistency .","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/generate.bage_ssvd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Random Age or Age-Sex Profiles — generate.bage_ssvd","text":"tibble","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/generate.bage_ssvd.html","id":"scaled-svds-of-demographic-databases-in-bage","dir":"Reference","previous_headings":"","what":"Scaled SVDs of demographic databases in bage","title":"Generate Random Age or Age-Sex Profiles — generate.bage_ssvd","text":"HMD Mortality rates Human Mortality Database. LFP Labor forcce participation rates OECD.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/generate.bage_ssvd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate Random Age or Age-Sex Profiles — generate.bage_ssvd","text":"","code":"## SVD for females and males combined generate(HMD) #> # A tibble: 2,220 × 3 #>     draw age   value #>    <int> <chr> <dbl> #>  1     1 0     -2.39 #>  2     1 1     -4.26 #>  3     1 2     -4.87 #>  4     1 3     -5.20 #>  5     1 4     -5.46 #>  6     1 5     -5.66 #>  7     1 6     -5.82 #>  8     1 7     -5.97 #>  9     1 8     -6.12 #> 10     1 9     -6.24 #> # ℹ 2,210 more rows  ## separate SVDs for females and males generate(HMD, indep = TRUE)  #> # A tibble: 4,440 × 4 #>     draw sexgender age   value #>    <int> <chr>     <chr> <dbl> #>  1     1 Female    0     -4.15 #>  2     1 Female    1     -6.35 #>  3     1 Female    2     -6.95 #>  4     1 Female    3     -7.26 #>  5     1 Female    4     -7.48 #>  6     1 Female    5     -7.65 #>  7     1 Female    6     -7.78 #>  8     1 Female    7     -7.89 #>  9     1 Female    8     -7.99 #> 10     1 Female    9     -8.07 #> # ℹ 4,430 more rows  ## specify age groups labels <- poputils::age_labels(type = \"lt\", max = 60) generate(HMD, age_labels = labels) #> # A tibble: 280 × 3 #>     draw age   value #>    <int> <chr> <dbl> #>  1     1 0     -3.40 #>  2     1 1-4   -5.98 #>  3     1 5-9   -7.19 #>  4     1 10-14 -7.48 #>  5     1 15-19 -6.82 #>  6     1 20-24 -6.46 #>  7     1 25-29 -6.40 #>  8     1 30-34 -6.29 #>  9     1 35-39 -6.08 #> 10     1 40-44 -5.80 #> # ℹ 270 more rows"},{"path":"https://bayesiandemography.github.io/bage/reference/is_fitted.html","id":null,"dir":"Reference","previous_headings":"","what":"Test Whether a Model has Been Fitted — is_fitted","title":"Test Whether a Model has Been Fitted — is_fitted","text":"Test whether fit() called model object.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/is_fitted.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test Whether a Model has Been Fitted — is_fitted","text":"","code":"is_fitted(x)"},{"path":"https://bayesiandemography.github.io/bage/reference/is_fitted.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test Whether a Model has Been Fitted — is_fitted","text":"x object class \"bage_mod\".","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/is_fitted.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Test Whether a Model has Been Fitted — is_fitted","text":"TRUE FALSE","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/is_fitted.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Test Whether a Model has Been Fitted — is_fitted","text":"","code":"mod <- mod_pois(injuries ~ age + sex + year,                 data = nzl_injuries,                 exposure = popn) is_fitted(mod) #> [1] FALSE mod <- fit(mod) is_fitted(mod) #> [1] TRUE"},{"path":"https://bayesiandemography.github.io/bage/reference/isl_deaths.html","id":null,"dir":"Reference","previous_headings":"","what":"Deaths in Iceland — isl_deaths","title":"Deaths in Iceland — isl_deaths","text":"Deaths mid-year populations Iceland, age, sex, calendar year.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/isl_deaths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Deaths in Iceland — isl_deaths","text":"","code":"isl_deaths"},{"path":"https://bayesiandemography.github.io/bage/reference/isl_deaths.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Deaths in Iceland — isl_deaths","text":"tibble 5,300 rows following columns: age Single year age, \"105+\" sex \"Female\" \"Male\" time Calendar year, 1998-2022 deaths Counts deaths popn Mid-year population","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/isl_deaths.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Deaths in Iceland — isl_deaths","text":"Tables \"Deaths municipalities, sex age 1981-2022\", \"Average annual population municipality, age sex 1998-2022 - Current municipalities\", Statistics Iceland website. Data downloaded 12 July 2023.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/kor_births.html","id":null,"dir":"Reference","previous_headings":"","what":"Births in South Korea — kor_births","title":"Births in South Korea — kor_births","text":"Births age mother, region, calendar year, 2011-2023.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/kor_births.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Births in South Korea — kor_births","text":"","code":"kor_births"},{"path":"https://bayesiandemography.github.io/bage/reference/kor_births.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Births in South Korea — kor_births","text":"tibble 1,872 rows following columns: age Five-year age groups \"10-14\" \"50-54\"` sex \"Female\" \"Male\" region Administrative region time Calendar year, 2011-2023 births Counts births popn Mid-year population","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/kor_births.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Births in South Korea — kor_births","text":"Tables \"Live Births Age Group Mother, Sex Birth Order Provinces\", \"Resident Population Five-Year Age Groups\", Korean Statistical Information Service website. Data downloaded 24 September 2024.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_binom.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify a Binomial Model — mod_binom","title":"Specify a Binomial Model — mod_binom","text":"Specify model outcome drawn binomial distribution.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_binom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify a Binomial Model — mod_binom","text":"","code":"mod_binom(formula, data, size)"},{"path":"https://bayesiandemography.github.io/bage/reference/mod_binom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify a Binomial Model — mod_binom","text":"formula R formula, specifying outcome predictors. data data frame containing outcome predictor variables, number trials. size Name variable giving number trials, formula.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_binom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify a Binomial Model — mod_binom","text":"object class bage_mod.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_binom.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify a Binomial Model — mod_binom","text":"model hierarchical. probabilities binomial distribution described prior model formed dimensions age, sex, time. terms dimension models, described priors. priors defaults, depend type term (eg intercept, age main effect, age-time interaction.)","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_binom.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Specify a Binomial Model — mod_binom","text":"likelihood $$y_i \\sim \\text{binomial}(\\gamma_i; w_i)$$ \\(y_i\\) count, number births, combination \\(\\) classifying variables, age, sex, region; \\(\\gamma_i\\) probability 'success'; \\(w_i\\) number trials. probabilities \\(\\gamma_i\\) assumed drawn beta distribution $$y_i \\sim \\text{Beta}(\\xi^{-1} \\mu_i, \\xi^{-1} (1 - \\mu_i))$$ \\(\\mu_i\\) expected value \\(\\gamma_i\\); \\(\\xi\\) governs dispersion (ie variance.) Expected value \\(\\mu_i\\) equals, logit scale, sum terms formed classifying variables, $$\\text{logit} \\mu_i = \\sum_{m=0}^{M} \\beta_{j_i^m}^{(m)}$$ \\(\\beta^{0}\\) intercept; \\(\\beta^{(m)}\\), \\(m = 1, \\dots, M\\), main effect interaction; \\(j_i^m\\) element \\(\\beta^{(m)}\\) associated cell \\(\\). \\(\\beta^{(m)}\\) given priors, described priors. prior \\(\\xi\\) described set_disp().","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_binom.html","id":"specifying-size","dir":"Reference","previous_headings":"","what":"Specifying size","title":"Specify a Binomial Model — mod_binom","text":"size argument can take two forms: name variable data, without quote marks, eg \"population\" population; formula, evaluated data environment (see example).","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/mod_binom.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify a Binomial Model — mod_binom","text":"","code":"mod <- mod_binom(oneperson ~ age:region + age:year,                  data = nzl_households,                  size = total)  ## use formula to specify size mod <- mod_binom(ncases ~ agegp + tobgp + alcgp,                  data = esoph,                  size = ~ ncases + ncontrols)"},{"path":"https://bayesiandemography.github.io/bage/reference/mod_norm.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify a Normal Model — mod_norm","title":"Specify a Normal Model — mod_norm","text":"Specify model outcome drawn normal distribution.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_norm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify a Normal Model — mod_norm","text":"","code":"mod_norm(formula, data, weights)"},{"path":"https://bayesiandemography.github.io/bage/reference/mod_norm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify a Normal Model — mod_norm","text":"formula R formula, specifying outcome predictors. data data frame containing outcome, predictor, , optionally, weights variables. weights Name weights variable, 1, formula. See details.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_norm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify a Normal Model — mod_norm","text":"object class bage_mod_norm.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_norm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify a Normal Model — mod_norm","text":"model hierarchical. means normal distribution described prior model formed dimensions age, sex, time. terms dimension models, described priors. priors defaults, depend type term (eg intercept, age main effect, age-time interaction.) Internally, outcome variable scaled mean 0 sd 1.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_norm.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Specify a Normal Model — mod_norm","text":"likelihood $$y_i \\sim \\text{N}(\\mu_i, \\xi^2 / w_i)$$ \\(y_i\\) scaled value , log income, combination \\(\\) classifying variables, age, sex, region; \\(\\mu_i\\) mean; \\(\\xi\\) standard deviation parameter; \\(w_i\\) weight. scaling outcome variable done internally. \\(y_i^*\\) original, \\(y_i = (y_i^* - m)/s\\) \\(m\\) \\(s\\) sample mean standard deviation \\(y_i^*\\). applications, \\(w_i\\) set 1 \\(\\). means \\(\\mu_i\\) equal sum terms formed classifying variables, $$\\mu_i = \\sum_{m=0}^{M} \\beta_{j_i^m}^{(m)}$$ \\(\\beta^{0}\\) intercept; \\(\\beta^{(m)}\\), \\(m = 1, \\dots, M\\), main effect interaction; \\(j_i^m\\) element \\(\\beta^{(m)}\\) associated cell \\(\\). \\(\\beta^{(m)}\\) given priors, described priors. prior \\(\\xi\\) described set_disp().","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_norm.html","id":"specifying-weights","dir":"Reference","previous_headings":"","what":"Specifying weights","title":"Specify a Normal Model — mod_norm","text":"weights argument can take three forms: name variable data, without quote marks, eg \"wt\" wt; number 1, weights used; formula, evaluated data environment (see example).","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/mod_norm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify a Normal Model — mod_norm","text":"","code":"mod <- mod_norm(value ~ diag:age + year,                 data = nld_expenditure,                 weights = 1)  ## use formula to specify weights mod <- mod_norm(value ~ diag:age + year,                 data = nld_expenditure,                 weights = ~sqrt(value))"},{"path":"https://bayesiandemography.github.io/bage/reference/mod_pois.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify a Poisson Model — mod_pois","title":"Specify a Poisson Model — mod_pois","text":"Specify model outcome drawn Poisson distribution.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_pois.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify a Poisson Model — mod_pois","text":"","code":"mod_pois(formula, data, exposure)"},{"path":"https://bayesiandemography.github.io/bage/reference/mod_pois.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify a Poisson Model — mod_pois","text":"formula R formula, specifying outcome predictors. data data frame containing outcome, predictor, , optionally, exposure variables. exposure Name exposure variable, 1, formula. See details.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_pois.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify a Poisson Model — mod_pois","text":"object class bage_mod_pois.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_pois.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify a Poisson Model — mod_pois","text":"model hierarchical. rates Poisson distribution described prior model formed dimensions age, sex, time. terms dimension models, described priors. priors defaults, depend type term (eg intercept, age main effect, age-time interaction.)","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_pois.html","id":"mathematical-details","dir":"Reference","previous_headings":"","what":"Mathematical details","title":"Specify a Poisson Model — mod_pois","text":"likelihood $$y_i \\sim \\text{Poisson}(\\gamma_i w_i)$$ subscript \\(\\) identifies combination classifying variables, age, sex, time; \\(y_i\\) outcome, deaths; \\(\\gamma_i\\) rates; \\(w_i\\) exposure. applications, obvious population risk. cases, exposure \\(w_i\\) can set 1 \\(\\). rates \\(\\gamma_i\\) assumed drawn gamma distribution $$y_i \\sim \\text{Gamma}(\\xi^{-1}, (\\xi \\mu_i)^{-1})$$ \\(\\mu_i\\) expected value \\(\\gamma_i\\); \\(\\xi\\) governs dispersion (ie variance.) Expected value \\(\\mu_i\\) equals, log scale, sum terms formed classifying variables, $$\\log \\mu_i = \\sum_{m=0}^{M} \\beta_{j_i^m}^{(m)}$$ \\(\\beta^{0}\\) intercept; \\(\\beta^{(m)}\\), \\(m = 1, \\dots, M\\), main effect interaction; \\(j_i^m\\) element \\(\\beta^{(m)}\\) associated cell \\(\\). \\(\\beta^{(m)}\\) given priors, described priors. prior \\(\\xi\\) described set_disp().","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/mod_pois.html","id":"specifying-exposure","dir":"Reference","previous_headings":"","what":"Specifying exposure","title":"Specify a Poisson Model — mod_pois","text":"exposure argument can take three forms: name variable data, without quote marks, eg \"population\" population; number 1, case pure \"counts\" model exposure, produced; formula, evaluated data environment (see example).","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/mod_pois.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify a Poisson Model — mod_pois","text":"","code":"## specify a model with exposure mod <- mod_pois(injuries ~ age:sex + ethnicity + year,                 data = nzl_injuries,                 exposure = popn)  ## specify a model without exposure mod <- mod_pois(injuries ~ age:sex + ethnicity + year,                 data = nzl_injuries,                 exposure = 1)  ## use a formula to specify exposure mod <- mod_pois(injuries ~ age:sex + ethnicity + year,                 data = nzl_injuries,                 exposure = ~ pmax(popn, 1))"},{"path":"https://bayesiandemography.github.io/bage/reference/nld_expenditure.html","id":null,"dir":"Reference","previous_headings":"","what":"Per Capita Health Expenditure in the Netherlands, 2003-2011 — nld_expenditure","title":"Per Capita Health Expenditure in the Netherlands, 2003-2011 — nld_expenditure","text":"Per capita health expenditure, Euros, diagnostic group, age group, year, Netherlands.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/nld_expenditure.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Per Capita Health Expenditure in the Netherlands, 2003-2011 — nld_expenditure","text":"","code":"nld_expenditure"},{"path":"https://bayesiandemography.github.io/bage/reference/nld_expenditure.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Per Capita Health Expenditure in the Netherlands, 2003-2011 — nld_expenditure","text":"tibble 1,296 rows following columns: diag Diagnostic group age 5-year age groups, open age group 85+ year 2003, 2005, 2007, 2011","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/nld_expenditure.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Per Capita Health Expenditure in the Netherlands, 2003-2011 — nld_expenditure","text":"Calculated data table \"Expenditure disease, age gender System Health Accounts (SHA) Framework : Current health spending age\" OECD database 'OECD.Stat' (downloaded 25 May 2016) table \"Historical population data projections (1950-2050)\" OECD database 'OECD.Stat' (downloaded 5 June 2016).","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/nzl_divorces.html","id":null,"dir":"Reference","previous_headings":"","what":"Divorces in New Zealand — nzl_divorces","title":"Divorces in New Zealand — nzl_divorces","text":"Counts divorces population, age, sex, calendar year, New Zealand, 2011-2021.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/nzl_divorces.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Divorces in New Zealand — nzl_divorces","text":"","code":"nzl_divorces"},{"path":"https://bayesiandemography.github.io/bage/reference/nzl_divorces.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Divorces in New Zealand — nzl_divorces","text":"tibble 242 rows following columns: age: 5-year age groups, \"15-19\" \"65+\" sex: \"Female\" \"Male\" time: Calendar year divorces: Numbers divorces year population: Person-years lived year","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/nzl_divorces.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Divorces in New Zealand — nzl_divorces","text":"Divorce counts data table \"Age divorces sex (marriages civil unions) (Annual-Dec)\" online database Infoshare Statistics New Zealand website. Data downloaded 22 March 2023. Population estimates derived data table \"Estimated Resident Population Age Sex (1991+) (Annual-Dec)\" online database Infoshare Statistics New Zealand website. Data downloaded 26 March 2023.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/nzl_households.html","id":null,"dir":"Reference","previous_headings":"","what":"People in One-Person Households in New Zealand — nzl_households","title":"People in One-Person Households in New Zealand — nzl_households","text":"Counts people one-person households, counts people living household, age, region, year.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/nzl_households.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"People in One-Person Households in New Zealand — nzl_households","text":"","code":"nzl_households"},{"path":"https://bayesiandemography.github.io/bage/reference/nzl_households.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"People in One-Person Households in New Zealand — nzl_households","text":"tibble 528 rows following columns: age: 5-year age groups, open age group 65+ region: Region within New Zealand year: Calendar year oneperson: Count people living one-person households total: Count people living types household","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/nzl_households.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"People in One-Person Households in New Zealand — nzl_households","text":"Derived data table \"Household composition age group, people households occupied private dwellings, 2006, 2013, 2018 Censuses (RC, TA, DHB, SA2)\" online database NZ.Stat, Statistics New Zealand website. Data downloaded 3 January 2023.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/nzl_injuries.html","id":null,"dir":"Reference","previous_headings":"","what":"Fatal Injuries in New Zealand — nzl_injuries","title":"Fatal Injuries in New Zealand — nzl_injuries","text":"Counts fatal injuries New Zealand, age, sex, ethnicity, year, plus estimates population risk.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/nzl_injuries.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fatal Injuries in New Zealand — nzl_injuries","text":"","code":"nzl_injuries"},{"path":"https://bayesiandemography.github.io/bage/reference/nzl_injuries.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Fatal Injuries in New Zealand — nzl_injuries","text":"tibble 912 rows following columns: age: 5-year age groups, age 55-59 sex: \"Female\" \"Male\" ethnicity: \"Maori\" \"Non Maori\" year: Calendar year injuries: Count injuries, randomly rounded base 3 popn: Population 30 June","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/nzl_injuries.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Fatal Injuries in New Zealand — nzl_injuries","text":"Derived data tables \"Estimated Resident Population Age Sex (1991+) (Annual-Jun)\" \"Maori Ethnic Group Estimated Resident Population Age Sex (1991+) (Annual-Jun)\" online database Infoshare, table \"Count fatal serious non-fatal injuries sex, age group, ethnicity, cause, severity injury, 2000-2021\" online database NZ.Stat, Statistics New Zealand website. Data downloaded 1 January 2023.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/print.bage_mod.html","id":null,"dir":"Reference","previous_headings":"","what":"Printing a Model — print.bage_mod","title":"Printing a Model — print.bage_mod","text":"calling function mod_pois() set_prior() good practice print model object console, check model's structure. output print() following components: header giving class model noting whether model fitted. formula giving outcome variable terms model. table giving number parameters, (fitted models ) standard deviation across parameters, measure term's importance. See priors() tidy(). Values model settings. See set_disp(), set_var_age(), set_var_sexgender(), set_var_time(), set_n_draw() Details computations (fitted models ). See computations().","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/print.bage_mod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Printing a Model — print.bage_mod","text":"","code":"# S3 method for class 'bage_mod' print(x, ...)"},{"path":"https://bayesiandemography.github.io/bage/reference/print.bage_mod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Printing a Model — print.bage_mod","text":"x Object class \"bage_mod\", typically created mod_pois(), mod_binom(), mod_norm(). ... Unused. Included generic consistency .","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/print.bage_mod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Printing a Model — print.bage_mod","text":"x, invisibly.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/print.bage_mod.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Printing a Model — print.bage_mod","text":"","code":"mod <- mod_pois(injuries ~ age + sex + year,                 data = nzl_injuries,                 exposure = popn)  ## print unfitted model mod #>  #>     ------ Unfitted Poisson model ------ #>  #>  #>    injuries ~ age + sex + year #>  #>  #>         term  prior along zero_sum n_par n_par_free #>  (Intercept) NFix()     -        -     1          1 #>          age   RW()   age        -    12         11 #>          sex NFix()     -        -     2          2 #>         year   RW()  year        -    19         18 #>  #>  #>           dispersion: mean=1 #>             exposure: popn #>              var_age: age #>        var_sexgender: sex #>             var_time: year #>               n_draw: 1000  mod <- fit(mod)  ## print fitted model mod #>  #>     ------ Fitted Poisson model ------ #>  #>  #>    injuries ~ age + sex + year #>  #>  #>         term  prior along zero_sum n_par n_par_free std_dev #>  (Intercept) NFix()     -        -     1          1       - #>          age   RW()   age        -    12         11    0.76 #>          sex NFix()     -        -     2          2    0.72 #>         year   RW()  year        -    19         18    0.08 #>  #>  #>           dispersion: mean=1 #>             exposure: popn #>              var_age: age #>        var_sexgender: sex #>             var_time: year #>               n_draw: 1000 #>  #>  #>  time_total time_optim time_draws iter                    message #>        0.23       0.13       0.00   12   relative convergence (4) #>"},{"path":"https://bayesiandemography.github.io/bage/reference/priors.html","id":null,"dir":"Reference","previous_headings":"","what":"Priors for Intercept, Main Effects, Interactions — priors","title":"Priors for Intercept, Main Effects, Interactions — priors","text":"models created functions mod_pois(), mod_binom(), mod_norm() always include intercept, typically include main effects interactions formed variables input data. models, instance include age effect, many include interaction age sex/gender, age time. intercept, main effects, interactions prior models capture expected behavior term. Current choices prior models summarised . Priors 'forecast' yes can used time-varying term forecast (instance, used time main effect age-time interaction). Priors zero_sum yes contain argument specifying whether sum--zero constraints used.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. generics augment, components, equation, fit, forecast, generate, tidy","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/replicate_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Replicate Data — replicate_data","title":"Create Replicate Data — replicate_data","text":"Use fitted model create replicate datasets, typically way checking model.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/replicate_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Replicate Data — replicate_data","text":"","code":"replicate_data(x, condition_on = NULL, n = 19)"},{"path":"https://bayesiandemography.github.io/bage/reference/replicate_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Replicate Data — replicate_data","text":"x fitted model, typically created calling mod_pois(), mod_binom(), mod_norm(), fit(). condition_on Parameters condition . Either \"expected\" \"fitted\". See details. n Number replicate datasets create. Default 19.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/replicate_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Replicate Data — replicate_data","text":"tibble following structure:","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/replicate_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create Replicate Data — replicate_data","text":"Use n draws posterior distribution model parameters generate n simulated datasets. model working well, simulated datasets look similar actual dataset.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/replicate_data.html","id":"the-condition-on-argument","dir":"Reference","previous_headings":"","what":"The condition_on argument","title":"Create Replicate Data — replicate_data","text":"Poisson binomial models include dispersion terms (default), two options constructing replicate data. condition_on \"fitted\", replicate data created () drawing values posterior distribution rates probabilities (\\(\\gamma_i\\) defined mod_pois() mod_binom()), (ii)  conditional rates probabilities, drawing values outcome variable. condition_on \"expected\", replicate data created () drawing values hyper-parameters governing rates probabilities (\\(\\mu_i\\) \\(\\xi\\) defined mod_pois() mod_binom()), (ii) conditional hyper-parameters, drawing values rates probabilities, finally (iii) conditional rates probabilities, drawing values outcome variable. default condition_on \"expected\". \"expected\" option provides severe test model \"fitted\" option, since \"fitted\" values weighted averages \"expected\" values original data. described mod_norm(), normal models different structure Poisson binomial models, distinction \"fitted\" \"expected\" apply.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/replicate_data.html","id":"data-models-for-outcomes","dir":"Reference","previous_headings":"","what":"Data models for outcomes","title":"Create Replicate Data — replicate_data","text":"data model provided outcome variable, creation replicate data include step errors added outcomes. instance, rr3 data model used, replicate_data() rounds outcomes base 3.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/replicate_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Replicate Data — replicate_data","text":"","code":"mod <- mod_pois(injuries ~ age:sex + ethnicity + year,                 data = nzl_injuries,                 exposure = 1) |>   fit()  rep_data <- mod |>   replicate_data()  library(dplyr) rep_data |>   group_by(.replicate) |>   count(wt = injuries) #> # A tibble: 20 × 2 #> # Groups:   .replicate [20] #>    .replicate       n #>    <fct>        <dbl> #>  1 Original     21588 #>  2 Replicate 1  20871 #>  3 Replicate 2  21848 #>  4 Replicate 3  21526 #>  5 Replicate 4  21872 #>  6 Replicate 5  21328 #>  7 Replicate 6  20551 #>  8 Replicate 7  20810 #>  9 Replicate 8  21680 #> 10 Replicate 9  22176 #> 11 Replicate 10 22164 #> 12 Replicate 11 20902 #> 13 Replicate 12 21068 #> 14 Replicate 13 20127 #> 15 Replicate 14 20715 #> 16 Replicate 15 21828 #> 17 Replicate 16 20979 #> 18 Replicate 17 21442 #> 19 Replicate 18 21761 #> 20 Replicate 19 21866  ## when the overall model includes an rr3 data model, ## replicate data are rounded to base 3 mod_pois(injuries ~ age:sex + ethnicity + year,          data = nzl_injuries,          exposure = popn) |>   set_datamod_outcome_rr3() |>   fit() |>   replicate_data() #> # A tibble: 18,240 × 7 #>    .replicate age   sex    ethnicity  year injuries  popn #>    <fct>      <fct> <chr>  <chr>     <int>    <dbl> <int> #>  1 Original   0-4   Female Maori      2000       12 35830 #>  2 Original   5-9   Female Maori      2000        6 35120 #>  3 Original   10-14 Female Maori      2000        3 32830 #>  4 Original   15-19 Female Maori      2000        6 27130 #>  5 Original   20-24 Female Maori      2000        6 24380 #>  6 Original   25-29 Female Maori      2000        6 24160 #>  7 Original   30-34 Female Maori      2000       12 22560 #>  8 Original   35-39 Female Maori      2000        3 22230 #>  9 Original   40-44 Female Maori      2000        6 18130 #> 10 Original   45-49 Female Maori      2000        6 13770 #> # ℹ 18,230 more rows"},{"path":"https://bayesiandemography.github.io/bage/reference/report_sim.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulation Study of a Model — report_sim","title":"Simulation Study of a Model — report_sim","text":"Use simulated data assess performance estimation model.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/report_sim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulation Study of a Model — report_sim","text":"","code":"report_sim(   mod_est,   mod_sim = NULL,   method = c(\"standard\", \"inner-outer\"),   vars_inner = NULL,   n_sim = 100,   point_est_fun = c(\"median\", \"mean\"),   widths = c(0.5, 0.95),   report_type = c(\"short\", \"long\", \"full\"),   n_core = 1 )"},{"path":"https://bayesiandemography.github.io/bage/reference/report_sim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulation Study of a Model — report_sim","text":"mod_est model whose performance assessed. object class bage_mod. mod_sim model used generate simulated data. value supplied, mod_est used. method Estimation method used mod_est. See fit(). vars_inner Variables used inner model \"inner-outer\"estimation method. See fit(). n_sim Number sets simulated data use. Default 100. point_est_fun Name function use calculate point estimates. options \"mean\" \"median\". default \"mean\". widths Widths credible intervals. vector values interval (0, 1]. Default c(0.5, 0.95). report_type Amount detail return value. Options \"short\" \"long\". Default \"short\". n_core Number cores use parallel processing. n_core 1 (default), parallel processing done.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/report_sim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulation Study of a Model — report_sim","text":"report_type \"short\", tibble following columns: component. Part model. See Details. \"par\" rate, probability, mean parameter likelihood. vals_sim. Simulated value parameter, averaged across simulations cells. error_point_est. Point estimate minus simulation-true value, averaged across simulations cells. cover. Actual proportion simulation-true values fall within type interval, averaged across simulations cells. report_type \"long\", tibble following columns: component. Part model. See components(). \"par\" rate, probability, mean parameter likelihood. term. Category within component. level. Category within term. vals_sim. Simulated values parameter, stored rvec. error_point_est. Point estimates minus simulation-true values, stored rvec. cover. Actual proportions simulation-true values falling within type interval, stored rvec.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/report_sim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulation Study of a Model — report_sim","text":"","code":"## results random, so set seed set.seed(0)  ## make data - outcome variable (deaths here) ## needs to be present, but is not used data <- data.frame(region = c(\"A\", \"B\", \"C\", \"D\", \"E\"),                    population = c(100, 200, 300, 400, 500),                    deaths = NA)  ## simulation with estimation model same as ## data-generating model mod_est <- mod_pois(deaths ~ region,                     data = data,                     exposure = population) |>   set_prior(`(Intercept)` ~ Known(0)) report_sim(mod_est = mod_est,            n_sim = 10) ## in practice should use larger value #> $components #> # A tibble: 4 × 7 #>   term        component  .error .cover_50 .cover_95 .length_50 .length_95 #>   <chr>       <chr>       <dbl>     <dbl>     <dbl>      <dbl>      <dbl> #> 1 (Intercept) effect     0            1         1        0           0    #> 2 region      effect     0.0825       0.6       1        1.03        3.00 #> 3 region      hyper      0.0219       0.3       0.9      0.606       1.96 #> 4 disp        disp      -0.336        0.6       1        0.882       3.16 #>  #> $augment #> # A tibble: 2 × 7 #>   .var      .observed   .error .cover_50 .cover_95 .length_50 .length_95 #>   <chr>         <dbl>    <dbl>     <dbl>     <dbl>      <dbl>      <dbl> #> 1 .fitted        1.63 -0.00249      0.54      0.94     0.0779      0.229 #> 2 .expected      1.63 -0.258        0.6       1        1.26        5.16  #>   ## simulation with estimation model different ## from data-generating model mod_sim <- mod_est |>   set_prior(region ~ N(s = 2)) report_sim(mod_est = mod_est,            mod_sim = mod_sim,            n_sim = 10) #> $components #> # A tibble: 4 × 7 #>   term        component  .error .cover_50 .cover_95 .length_50 .length_95 #>   <chr>       <chr>       <dbl>     <dbl>     <dbl>      <dbl>      <dbl> #> 1 (Intercept) effect     0            1        1         0           0    #> 2 region      effect     0.276        0.5      0.96      1.31        3.81 #> 3 region      hyper     -0.500        0.2      0.8       0.666       2.08 #> 4 disp        disp      -0.0676       0.5      0.8       1.09        3.83 #>  #> $augment #> # A tibble: 2 × 7 #>   .var      .observed   .error .cover_50 .cover_95 .length_50 .length_95 #>   <chr>         <dbl>    <dbl>     <dbl>     <dbl>      <dbl>      <dbl> #> 1 .fitted        12.3 -0.00339      0.54      0.96      0.113      0.331 #> 2 .expected      12.3 -6.28         0.5       0.96      6.27      27.9   #>"},{"path":"https://bayesiandemography.github.io/bage/reference/set_datamod_outcome_rr3.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify RR3 Data Model — set_datamod_outcome_rr3","title":"Specify RR3 Data Model — set_datamod_outcome_rr3","text":"Specify data model outcome variable randomly rounded base 3.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_datamod_outcome_rr3.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify RR3 Data Model — set_datamod_outcome_rr3","text":"","code":"set_datamod_outcome_rr3(mod)"},{"path":"https://bayesiandemography.github.io/bage/reference/set_datamod_outcome_rr3.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify RR3 Data Model — set_datamod_outcome_rr3","text":"mod object class \"bage_mod\", created mod_pois(), mod_binom(), mod_norm().","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_datamod_outcome_rr3.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify RR3 Data Model — set_datamod_outcome_rr3","text":"modified version mod.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_datamod_outcome_rr3.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify RR3 Data Model — set_datamod_outcome_rr3","text":"set_datamod_outcome_rr3() can used Poisson binomial models (created mod_pois() mod_binom().) Random rounding base 3 (RR3) confidentialization technique sometimes applied statistical agencies. RR3 applied integer data. procedure rounding value \\(n\\) follows: \\(n\\) divisible 3, leave unchanged dividing \\(n\\) 3 leaves remainder 1, round (subtract 1) probability 2/3, round (add 2) probability 1/3. dividing \\(n\\) 3 leaves remainder 1, round (subtract 2) probability 1/3, round (add 1) probability 2/3. set_datamod_outcome_rr3() applied fitted model, 'unfits' model, deleting existing estimates.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/set_datamod_outcome_rr3.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify RR3 Data Model — set_datamod_outcome_rr3","text":"","code":"## 'injuries' variable in 'nzl_injuries' dataset ## has been randomly rounded to base 3 mod <- mod_pois(injuries ~ age:sex + ethnicity + year,                 data = nzl_injuries,                 exposure = popn) |>   set_datamod_outcome_rr3() |>   fit()"},{"path":"https://bayesiandemography.github.io/bage/reference/set_disp.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify Prior for Dispersion or Standard Deviation — set_disp","title":"Specify Prior for Dispersion or Standard Deviation — set_disp","text":"Specify mean prior dispersion parameter (Poisson binomial models) standard deviation parameter (normal models.)","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_disp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify Prior for Dispersion or Standard Deviation — set_disp","text":"","code":"set_disp(mod, mean)"},{"path":"https://bayesiandemography.github.io/bage/reference/set_disp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify Prior for Dispersion or Standard Deviation — set_disp","text":"mod object class \"bage_mod\", created mod_pois(), mod_binom(), mod_norm(). mean Mean value exponential prior. Poisson binomial models, can set 0.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_disp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify Prior for Dispersion or Standard Deviation — set_disp","text":"bage_mod object","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_disp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify Prior for Dispersion or Standard Deviation — set_disp","text":"dispersion mean parameter exponential distribution mean \\(\\mu\\), $$p(\\xi) = \\frac{1}{\\mu}\\exp\\left(\\frac{-\\xi}{\\mu}\\right).$$ Poisson binomial models, mean can set 0, implying dispersion term also 0. normal models, mean must non-negative. set_disp() applied fitted model, 'unfits' model, deleting existing estimates.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/set_disp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify Prior for Dispersion or Standard Deviation — set_disp","text":"","code":"mod <- mod_pois(injuries ~ age:sex + ethnicity + year,                 data = nzl_injuries,                 exposure = popn) mod #>  #>     ------ Unfitted Poisson model ------ #>  #>  #>    injuries ~ age:sex + ethnicity + year #>  #>  #>         term  prior along zero_sum n_par n_par_free #>  (Intercept) NFix()     -        -     1          1 #>    ethnicity NFix()     -        -     2          2 #>         year   RW()  year        -    19         18 #>      age:sex   RW()   age    FALSE    24         22 #>  #>  #>           dispersion: mean=1 #>             exposure: popn #>              var_age: age #>        var_sexgender: sex #>             var_time: year #>               n_draw: 1000 mod |> set_disp(mean = 0.1) #>  #>     ------ Unfitted Poisson model ------ #>  #>  #>    injuries ~ age:sex + ethnicity + year #>  #>  #>         term  prior along zero_sum n_par n_par_free #>  (Intercept) NFix()     -        -     1          1 #>    ethnicity NFix()     -        -     2          2 #>         year   RW()  year        -    19         18 #>      age:sex   RW()   age    FALSE    24         22 #>  #>  #>           dispersion: mean=0.1 #>             exposure: popn #>              var_age: age #>        var_sexgender: sex #>             var_time: year #>               n_draw: 1000 mod |> set_disp(mean = 0) #>  #>     ------ Unfitted Poisson model ------ #>  #>  #>    injuries ~ age:sex + ethnicity + year #>  #>  #>         term  prior along zero_sum n_par n_par_free #>  (Intercept) NFix()     -        -     1          1 #>    ethnicity NFix()     -        -     2          2 #>         year   RW()  year        -    19         18 #>      age:sex   RW()   age    FALSE    24         22 #>  #>  #>           dispersion: mean=0 #>             exposure: popn #>              var_age: age #>        var_sexgender: sex #>             var_time: year #>               n_draw: 1000"},{"path":"https://bayesiandemography.github.io/bage/reference/set_n_draw.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify Number of Draws from Prior or Posterior Distribution — set_n_draw","title":"Specify Number of Draws from Prior or Posterior Distribution — set_n_draw","text":"Specify number draws posterior distribution used model output. newly-created bage_mod object n_draw value 1000. Higher values may appropriate characterizing tails distributions, publication-quality graphics summaries.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_n_draw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify Number of Draws from Prior or Posterior Distribution — set_n_draw","text":"","code":"set_n_draw(mod, n_draw = 1000L)"},{"path":"https://bayesiandemography.github.io/bage/reference/set_n_draw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify Number of Draws from Prior or Posterior Distribution — set_n_draw","text":"mod object class \"bage_mod\", created mod_pois(), mod_binom(), mod_norm(). n_draw Number draws.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_n_draw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify Number of Draws from Prior or Posterior Distribution — set_n_draw","text":"bage_mod object","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_n_draw.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify Number of Draws from Prior or Posterior Distribution — set_n_draw","text":"new value n_draw greater old value, model already fitted, model unfitted, function fit() may need called .","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/set_n_draw.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify Number of Draws from Prior or Posterior Distribution — set_n_draw","text":"","code":"mod <- mod_pois(injuries ~ age:sex + ethnicity + year,                 data = nzl_injuries,                 exposure = popn) mod #>  #>     ------ Unfitted Poisson model ------ #>  #>  #>    injuries ~ age:sex + ethnicity + year #>  #>  #>         term  prior along zero_sum n_par n_par_free #>  (Intercept) NFix()     -        -     1          1 #>    ethnicity NFix()     -        -     2          2 #>         year   RW()  year        -    19         18 #>      age:sex   RW()   age    FALSE    24         22 #>  #>  #>           dispersion: mean=1 #>             exposure: popn #>              var_age: age #>        var_sexgender: sex #>             var_time: year #>               n_draw: 1000  mod |>   set_n_draw(n_draw = 5000) #>  #>     ------ Unfitted Poisson model ------ #>  #>  #>    injuries ~ age:sex + ethnicity + year #>  #>  #>         term  prior along zero_sum n_par n_par_free #>  (Intercept) NFix()     -        -     1          1 #>    ethnicity NFix()     -        -     2          2 #>         year   RW()  year        -    19         18 #>      age:sex   RW()   age    FALSE    24         22 #>  #>  #>           dispersion: mean=1 #>             exposure: popn #>              var_age: age #>        var_sexgender: sex #>             var_time: year #>               n_draw: 5000"},{"path":"https://bayesiandemography.github.io/bage/reference/set_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify Prior for Model Term — set_prior","title":"Specify Prior for Model Term — set_prior","text":"Specify prior distribution intercept, main effect, interaction.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify Prior for Model Term — set_prior","text":"","code":"set_prior(mod, formula)"},{"path":"https://bayesiandemography.github.io/bage/reference/set_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify Prior for Model Term — set_prior","text":"mod bage_mod object, created mod_pois(), mod_binom(), mod_norm(). formula formula giving term function creating prior.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify Prior for Model Term — set_prior","text":"modified bage_mod object.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_prior.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify Prior for Model Term — set_prior","text":"set_prior() applied fitted model, 'unfits' model, deleting existing estimates.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/set_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify Prior for Model Term — set_prior","text":"","code":"mod <- mod_pois(injuries ~ age + year,                 data = nzl_injuries,                 exposure = popn) mod #>  #>     ------ Unfitted Poisson model ------ #>  #>  #>    injuries ~ age + year #>  #>  #>         term  prior along zero_sum n_par n_par_free #>  (Intercept) NFix()     -        -     1          1 #>          age   RW()   age        -    12         11 #>         year   RW()  year        -    19         18 #>  #>  #>           dispersion: mean=1 #>             exposure: popn #>              var_age: age #>             var_time: year #>               n_draw: 1000 mod |> set_prior(age ~ RW2()) #>  #>     ------ Unfitted Poisson model ------ #>  #>  #>    injuries ~ age + year #>  #>  #>         term  prior along zero_sum n_par n_par_free #>  (Intercept) NFix()     -        -     1          1 #>          age  RW2()   age        -    12         11 #>         year   RW()  year        -    19         18 #>  #>  #>           dispersion: mean=1 #>             exposure: popn #>              var_age: age #>             var_time: year #>               n_draw: 1000"},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_age.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify Age Variable — set_var_age","title":"Specify Age Variable — set_var_age","text":"Specify variable () represents age. Functions mod_pois(), mod_binom(), mod_norm() try infer age variable variable names, always get right.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_age.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify Age Variable — set_var_age","text":"","code":"set_var_age(mod, name)"},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_age.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify Age Variable — set_var_age","text":"mod object class \"bage_mod\", created mod_pois(), mod_binom(), mod_norm(). name name age variable.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_age.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify Age Variable — set_var_age","text":"bage_mod object","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_age.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify Age Variable — set_var_age","text":"R formula, 'variable' different 'term'. instance, ~ age + region + age:region contains variables age region, terms age, region, age:region. default, bage gives term involving age (RW()) prior. Changing age variable via set_var_age() can change priors: see example. set_var_age() applied fitted model, 'unfits' model, deleting existing estimates.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_age.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify Age Variable — set_var_age","text":"","code":"## rename 'age' variable to something unusual injuries2 <- nzl_injuries injuries2$age_last_birthday <- injuries2$age  ## mod_pois does not recognize age variable mod <- mod_pois(injuries ~ age_last_birthday * ethnicity + year,                 data = injuries2,                 exposure = popn) mod #>  #>     ------ Unfitted Poisson model ------ #>  #>  #>    injuries ~ age_last_birthday * ethnicity + year #>  #>  #>                         term  prior along zero_sum n_par n_par_free #>                  (Intercept) NFix()     -        -     1          1 #>            age_last_birthday    N()     -        -    12         12 #>                    ethnicity NFix()     -        -     2          2 #>                         year   RW()  year        -    19         18 #>  age_last_birthday:ethnicity    N()     -        -    24         24 #>  #>  #>           dispersion: mean=1 #>             exposure: popn #>             var_time: year #>               n_draw: 1000  ## so we set the age variable explicitly ## (which, as a side effect, changes the prior on ## the age main effect) mod |>   set_var_age(name = \"age_last_birthday\") #>  #>     ------ Unfitted Poisson model ------ #>  #>  #>    injuries ~ age_last_birthday * ethnicity + year #>  #>  #>                         term  prior             along zero_sum n_par n_par_free #>                  (Intercept) NFix()                 -        -     1          1 #>            age_last_birthday   RW() age_last_birthday        -    12         11 #>                    ethnicity NFix()                 -        -     2          2 #>                         year   RW()              year        -    19         18 #>  age_last_birthday:ethnicity    N()                 -        -    24         24 #>  #>  #>           dispersion: mean=1 #>             exposure: popn #>              var_age: age_last_birthday #>             var_time: year #>               n_draw: 1000"},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_sexgender.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify Sex or Gender Variable — set_var_sexgender","title":"Specify Sex or Gender Variable — set_var_sexgender","text":"Specify variable () represents sex gender. Functions mod_pois(), mod_binom(), mod_norm() try infer sex/gender variable variable names, always get right.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_sexgender.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify Sex or Gender Variable — set_var_sexgender","text":"","code":"set_var_sexgender(mod, name)"},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_sexgender.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify Sex or Gender Variable — set_var_sexgender","text":"mod object class \"bage_mod\", created mod_pois(), mod_binom(), mod_norm(). name name sex gender variable.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_sexgender.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify Sex or Gender Variable — set_var_sexgender","text":"\"bage_mod\" object","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_sexgender.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify Sex or Gender Variable — set_var_sexgender","text":"R formula, 'variable' different 'term'. instance, ~ gender + region + gender:region contains variables gender region, terms gender, region, gender:region. set_var_sexgender() applied fitted model, 'unfits' model, deleting existing estimates.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_sexgender.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify Sex or Gender Variable — set_var_sexgender","text":"","code":"## rename 'sex' variable to something unexpected injuries2 <- nzl_injuries injuries2$biological_sex <- injuries2$sex  ## mod_pois does not recognize sex variable mod <- mod_pois(injuries ~ age * biological_sex + year,                 data = injuries2,                 exposure = popn) mod #>  #>     ------ Unfitted Poisson model ------ #>  #>  #>    injuries ~ age * biological_sex + year #>  #>  #>                term  prior along zero_sum n_par n_par_free #>         (Intercept) NFix()     -        -     1          1 #>                 age   RW()   age        -    12         11 #>      biological_sex NFix()     -        -     2          2 #>                year   RW()  year        -    19         18 #>  age:biological_sex   RW()   age    FALSE    24         22 #>  #>  #>           dispersion: mean=1 #>             exposure: popn #>              var_age: age #>             var_time: year #>               n_draw: 1000  ## so we set the sex variable explicitly mod |>   set_var_sexgender(name = \"biological_sex\") #>  #>     ------ Unfitted Poisson model ------ #>  #>  #>    injuries ~ age * biological_sex + year #>  #>  #>                term  prior along zero_sum n_par n_par_free #>         (Intercept) NFix()     -        -     1          1 #>                 age   RW()   age        -    12         11 #>      biological_sex NFix()     -        -     2          2 #>                year   RW()  year        -    19         18 #>  age:biological_sex   RW()   age    FALSE    24         22 #>  #>  #>           dispersion: mean=1 #>             exposure: popn #>              var_age: age #>        var_sexgender: biological_sex #>             var_time: year #>               n_draw: 1000"},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_time.html","id":null,"dir":"Reference","previous_headings":"","what":"Specify Time Variable — set_var_time","title":"Specify Time Variable — set_var_time","text":"Specify variable () represents time. Functions mod_pois(), mod_binom(), mod_norm() try infer time variable variable names, always get right.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_time.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Specify Time Variable — set_var_time","text":"","code":"set_var_time(mod, name)"},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_time.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Specify Time Variable — set_var_time","text":"mod object class \"bage_mod\", created mod_pois(), mod_binom(), mod_norm(). name name time variable.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_time.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Specify Time Variable — set_var_time","text":"bage_mod object","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_time.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Specify Time Variable — set_var_time","text":"R formula, 'variable' different 'term'. instance, ~ time + region + time:region contains variables time region, terms time, region, time:region. default, bage gives term involving time (RW()) prior. Changing time variable via set_var_time() can change priors: see example. set_var_time() applied fitted model, 'unfits' model, deleting existing estimates.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/set_var_time.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Specify Time Variable — set_var_time","text":"","code":"## rename time variable to something unusual injuries2 <- nzl_injuries injuries2$calendar_year <- injuries2$year  ## mod_pois does not recognize time variable mod <- mod_pois(injuries ~ age * ethnicity + calendar_year,                 data = injuries2,                 exposure = popn) mod #>  #>     ------ Unfitted Poisson model ------ #>  #>  #>    injuries ~ age * ethnicity + calendar_year #>  #>  #>           term  prior along zero_sum n_par n_par_free #>    (Intercept) NFix()     -        -     1          1 #>            age   RW()   age        -    12         11 #>      ethnicity NFix()     -        -     2          2 #>  calendar_year    N()     -        -    19         19 #>  age:ethnicity   RW()   age    FALSE    24         22 #>  #>  #>           dispersion: mean=1 #>             exposure: popn #>              var_age: age #>               n_draw: 1000  ## so we set the time variable explicitly ## (which, as a side effect, changes the prior on ## the time main effect) mod |>   set_var_time(name = \"calendar_year\") #>  #>     ------ Unfitted Poisson model ------ #>  #>  #>    injuries ~ age * ethnicity + calendar_year #>  #>  #>           term  prior         along zero_sum n_par n_par_free #>    (Intercept) NFix()             -        -     1          1 #>            age   RW()           age        -    12         11 #>      ethnicity NFix()             -        -     2          2 #>  calendar_year   RW() calendar_year        -    19         18 #>  age:ethnicity   RW()           age    FALSE    24         22 #>  #>  #>           dispersion: mean=1 #>             exposure: popn #>              var_age: age #>             var_time: calendar_year #>               n_draw: 1000"},{"path":"https://bayesiandemography.github.io/bage/reference/tidy.bage_mod.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize Terms from a Fitted Model — tidy.bage_mod","title":"Summarize Terms from a Fitted Model — tidy.bage_mod","text":"Summarize intercept, main effects, interactions fitted model.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/tidy.bage_mod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize Terms from a Fitted Model — tidy.bage_mod","text":"","code":"# S3 method for class 'bage_mod' tidy(x, ...)"},{"path":"https://bayesiandemography.github.io/bage/reference/tidy.bage_mod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize Terms from a Fitted Model — tidy.bage_mod","text":"x Object class \"bage_mod\", typically created mod_pois(), mod_binom(), mod_norm(). ... Unused. Included generic consistency .","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/tidy.bage_mod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize Terms from a Fitted Model — tidy.bage_mod","text":"tibble","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/tidy.bage_mod.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarize Terms from a Fitted Model — tidy.bage_mod","text":"tibble returned tidy() contains following columns: term Name intercept, main effect, interaction prior Specification prior n_par Number parameters n_par_free Number free parameters std_dev Standard deviation point estimates. priors, number free parameters less number parameters term. instance, SVD() prior might use three vectors represent 101 age groups number parameters 101, number free parameters 3. std_dev standard deviation across elements term, based point estimates elements. instance, point estimates term three elements 0.3, 0.5, 0.1,  value std_dev   std_dev measure contribution term variation outcome variable.","code":"sd(c(0.3, 0.5, 0.1))"},{"path":"https://bayesiandemography.github.io/bage/reference/tidy.bage_mod.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Summarize Terms from a Fitted Model — tidy.bage_mod","text":"std_dev modified Gelman et al. (2014) Bayesian Data Analysis. Third Edition. pp396–397.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/tidy.bage_mod.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize Terms from a Fitted Model — tidy.bage_mod","text":"","code":"mod <- mod_pois(injuries ~ age + sex + year,                 data = nzl_injuries,                 exposure = popn) mod <- fit(mod) tidy(mod) #> # A tibble: 4 × 7 #>   term        prior  along zero_sum n_par n_par_free std_dev #>   <chr>       <chr>  <chr> <lgl>    <int>      <int>   <dbl> #> 1 (Intercept) NFix() NA    NA           1          1 NA      #> 2 age         RW()   age   NA          12         11  0.756  #> 3 sex         NFix() NA    NA           2          2  0.716  #> 4 year        RW()   year  NA          19         18  0.0812"},{"path":"https://bayesiandemography.github.io/bage/reference/unfit.html","id":null,"dir":"Reference","previous_headings":"","what":"Unfit a Model — unfit","title":"Unfit a Model — unfit","text":"Reset model, deleting estimates.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/unfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Unfit a Model — unfit","text":"","code":"unfit(mod)"},{"path":"https://bayesiandemography.github.io/bage/reference/unfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Unfit a Model — unfit","text":"mod fitted object class \"bage_mod\", object, created call mod_pois(), mod_binom(), mod_norm().","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/unfit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Unfit a Model — unfit","text":"unfitted version mod.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/reference/unfit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Unfit a Model — unfit","text":"","code":"## create a model, which starts out unfitted mod <- mod_pois(injuries ~ age + sex + year,                 data = nzl_injuries,                 exposure = popn) is_fitted(mod) #> [1] FALSE  ## calling 'fit' produces a fitted version mod <- fit(mod) is_fitted(mod) #> [1] TRUE  ## calling 'unfit' resets the model mod <- unfit(mod) is_fitted(mod) #> [1] FALSE"},{"path":"https://bayesiandemography.github.io/bage/reference/usa_deaths.html","id":null,"dir":"Reference","previous_headings":"","what":"Accidental Deaths in the USA — usa_deaths","title":"Accidental Deaths in the USA — usa_deaths","text":"Counts accidental deaths USA, month, 1973-1978.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/usa_deaths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Accidental Deaths in the USA — usa_deaths","text":"","code":"usa_deaths"},{"path":"https://bayesiandemography.github.io/bage/reference/usa_deaths.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Accidental Deaths in the USA — usa_deaths","text":"tibble 72 rows following columns: month: Year month. deaths: Count deaths.","code":""},{"path":"https://bayesiandemography.github.io/bage/reference/usa_deaths.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Accidental Deaths in the USA — usa_deaths","text":"Reformatted version datasets::USAccDeaths.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-interface-0-8-0","dir":"Changelog","previous_headings":"","what":"Changes to interface","title":"bage 0.8.0","text":"Added ‘along’ column tidy print methods \"bage_mod\" objects. (Thank Andrew Taylor suggesting .) Allow s = 0 Lin() priors Added zero_sum argument priors along dimension. zero_sum TRUE, values combination variable along variable constrained sum zero. can allow better identification higher-level terms complicated models. can also slow computations, virtually effect estimates lowest-level rates, probabilities, means. Removed post-estimation standardization. now rely explicit constraints instead give interpretable values main effects interactions. Added RW2_Infant() prior modelling age-patterns mortality rates. s_seas parameter RW_Seas() RW2_Seas() now defaults 0, rather 1, seasonal effects default fixed time rather varying. Using varying seasonal effects can greatly increase computation times. Moved rvec Imports Depends, loads bage loaded. Manipulating results bage models without rvec loaded can lead strange errors. Added information computations printout fitted model objects. Added function computations(), can used extract information fitted model objects. Added quiet argument fit(). quiet TRUE (default), warnings generated nlminb() suppressed. (warnings virtually always NAs early optimization process nothing worry .)","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-internal-calculations-0-8-0","dir":"Changelog","previous_headings":"","what":"Changes to internal calculations","title":"bage 0.8.0","text":"Removed unnecessary coercion sparse matrices dense matrices (sometimes cause memory problems) Added extra constraints priors - eg first element random walks now zero. often (always) helps make raw estimates main effects interactions interpretable, can speed computations slightly. normal model, now rescale weights mean 1. allows us use default prior dispersion (exponential prior mean 1), regardless original weights. rescaling weights affects estimated value dispersion, affect estimates parameters. Generation posterior sample now using fast methods package sparseMVN possible.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"datasets-0-7-8","dir":"Changelog","previous_headings":"","what":"Datasets","title":"bage 0.7.8","text":"Added HFD, scaled SVD object holding data Human Fertiltiy Database deaths –> isl_deaths expenditure –> nld_expenditure divorces –> nzl_divorces injuries –> nzl_injuries us_acc_deaths –> usa_deaths Added new data object kor_births, births South Korea","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"bug-fixes-0-7-7","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"bage 0.7.7","text":"report_sim() now works fitted models. Thank Ollie Pike pointing previously . Removed redundant levels age variable divorces.","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-internal-calculations-0-7-7","dir":"Changelog","previous_headings":"","what":"Changes to internal calculations","title":"bage 0.7.7","text":"Removed internal bage function rr3(). Call poputils function rr3() instead.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-interface-0-7-6","dir":"Changelog","previous_headings":"","what":"Changes to interface","title":"bage 0.7.6","text":"Added newdata argument forecast(). Added minimum version numbers rvec poputils.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"bug-fixes-0-7-5-1","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"bage 0.7.5.1","text":"Fixed bug code simulating Lin() Lin_AR() priors.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-interface-0-7-5","dir":"Changelog","previous_headings":"","what":"Changes to interface","title":"bage 0.7.5","text":"Added arguments method vars_inner fit(). method \"standard\" (default) fit() uses existing calculation methods. method \"inner-outer\", fit() uses new, somewhat experimental calculation method involves fitting inner model using subset variables, outer model using remaining variables. big datasets, \"inner-outer\" can faster, use less memory, give similar results. Added information numbers parameters, standard deviations output print. Thank Duncan Elliot suggesting printing numbers parameters.","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-calculations-0-7-5","dir":"Changelog","previous_headings":"","what":"Changes to calculations","title":"bage 0.7.5","text":"fit() now internally aggregates input data fitting, cells combinations predictor variables combined. increases speed reduces memory usage.","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-documentation-0-7-5","dir":"Changelog","previous_headings":"","what":"Changes to documentation","title":"bage 0.7.5","text":"Added help print.bage_mod","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"bage-074","dir":"Changelog","previous_headings":"","what":"bage 0.7.4","title":"bage 0.7.4","text":"CRAN release: 2024-08-28","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-interface-0-7-4","dir":"Changelog","previous_headings":"","what":"Changes to interface","title":"bage 0.7.4","text":"Function ssvd() longer exported. export package bssvd matures. bage released CRAN","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-data-and-examples-0-7-3","dir":"Changelog","previous_headings":"","what":"Changes to data and examples","title":"bage 0.7.3","text":"Modified example augment() runs faster Reduced size divorces dataset","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-interface-0-7-2","dir":"Changelog","previous_headings":"","what":"Changes to interface","title":"bage 0.7.2","text":"Added first data model. New function set_datamod_outcome_rr3(), deals case outcome variable randomly rounded base 3. augment() now creates new version outcome variable () outcome variable NAs, (ii) data model applied outcome variable. name new variable created added . start name outcome variable. help page summarising available data models","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-interface-0-7-1","dir":"Changelog","previous_headings":"","what":"Changes to interface","title":"bage 0.7.1","text":"now three choices standardization argument: \"terms\", \"anova\", \"none\". \"terms\", effects, plus assoicated SVD coefficients, trend, cyclical, seasonal terms, centered independently. \"anova\", type standardization descibed Section 15.6 Gelman et al (2014) Bayesian Data Analysis, applied effects.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-calculations-0-7-0","dir":"Changelog","previous_headings":"","what":"Changes to calculations","title":"bage 0.7.0","text":"simplification standardization, likely future split two types standardization: one gives ANOVA-style decomposition effects, one helps understanding dynamics term.","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-infrastructure-0-7-0","dir":"Changelog","previous_headings":"","what":"Changes to infrastructure","title":"bage 0.7.0","text":"Added Makevars file.","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-documentation-0-7-0","dir":"Changelog","previous_headings":"","what":"Changes to documentation","title":"bage 0.7.0","text":"Stopped referring second-order walks equivalent random walks drift. (second-order random walk differs random walk implied drift term second-order random walk can vary time.)","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-calculations-0-6-3","dir":"Changelog","previous_headings":"","what":"Changes to calculations","title":"bage 0.6.3","text":"Changed standardization forecasts forecasts standardized along ‘along’ dimension choosing values makes consistent time trends estimation period, standardizing within value along dimensions.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-interface-0-6-2","dir":"Changelog","previous_headings":"","what":"Changes to interface","title":"bage 0.6.2","text":"Removed SVDS(), SVDS_AR(), SVDS_AR1(), SVDS_RW(), SVDS_RW2() priors. Added indep argument corresponding SVD priors. SVD priors now choose ‘total’, ‘independent’ ‘joint’ models based (1) value indep argument, (2) value var_sexgender name term.","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-data-0-6-2","dir":"Changelog","previous_headings":"","what":"Changes to data","title":"bage 0.6.2","text":"Object HMD now contains 5 components, rather 10.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-calculations-0-6-1","dir":"Changelog","previous_headings":"","what":"Changes to calculations","title":"bage 0.6.1","text":"Fixed problems standardization forecast Added intercept term Lin() LinAR() priors","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"issues-0-6-0","dir":"Changelog","previous_headings":"","what":"Issues","title":"bage 0.6.0","text":"Standardization forecasts working correctly.","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-interface-0-6-0","dir":"Changelog","previous_headings":"","what":"Changes to interface","title":"bage 0.6.0","text":"Added priors SVD_AR(), SVDS_AR(), SVD_AR1(), SVDS_AR1(), SVD_RW(), SVDS_RW(), SVD_RW2(), SVDS_RW2()","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"internal-calculations-0-6-0","dir":"Changelog","previous_headings":"","what":"Internal calculations","title":"bage 0.6.0","text":"Changed values stored object: removed draws_linpred, added draws_effectfree, draws_spline, draws_svd. Modified/added downstream functions. Calculation ‘along_by’ ‘agesex’ matrices pushed downwards lower-level functions.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-interface-0-5-1","dir":"Changelog","previous_headings":"","what":"Changes to interface","title":"bage 0.5.1","text":"Moved HMD code package bssvd.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-interface-0-5-0","dir":"Changelog","previous_headings":"","what":"Changes to interface","title":"bage 0.5.0","text":"Combined interaction (eg ELin) main effect (eg Lin) versions priors Removed function compose_time() Added priors RWSeas RW2Seas Improved report_sim()","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-interface-0-4-2","dir":"Changelog","previous_headings":"","what":"Changes to interface","title":"bage 0.4.2","text":"Tidying online help (yet complete).","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"new-functions-0-4-1","dir":"Changelog","previous_headings":"","what":"New functions","title":"bage 0.4.1","text":"Added ‘bage_ssvd’ method components().","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-interface-0-4-1","dir":"Changelog","previous_headings":"","what":"Changes to interface","title":"bage 0.4.1","text":"augment() method bage_mod objects now calculated value .fitted cases outcome exposure/size NA, rather setting value .fitted NA.","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"internal-calculations-0-4-1","dir":"Changelog","previous_headings":"","what":"Internal calculations","title":"bage 0.4.1","text":"Standardization effects done components() called. augment() uses linear predictor (need standardization.) Internally, draws linear predictor, hyper-parameters (included model) disp stored, rather full standardized components. Standardization algorithm repeats 100 times, residuals less 0.0001. new configuration, calculations large matrices previously failed error message “Internal error: Final residual 0” now running.","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"simulations-0-4-1","dir":"Changelog","previous_headings":"","what":"Simulations","title":"bage 0.4.1","text":"drawing prior, intercept always set 0. Terms SVD Known priors touched. terms centered.","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"changes-to-back-end-for-svd-priors-0-4-0","dir":"Changelog","previous_headings":"","what":"Changes to back-end for SVD priors","title":"bage 0.4.0","text":"Move functions creating ‘bage_ssvd’ objects package ‘bssvd’.","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"bug-fixes-0-4-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"bage 0.4.0","text":"Corrected error calculation logit ssvd_comp().","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"new-functions-0-3-2","dir":"Changelog","previous_headings":"","what":"New functions","title":"bage 0.3.2","text":"forecast.bage_mod() Forecasting. Interface yet finalised.","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"bug-fixes-0-3-2","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"bage 0.3.2","text":"Corrected error C++ template Lin ELin priors (due use integer arithmetic.)","code":""},{"path":[]},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"new-functions-0-2-2","dir":"Changelog","previous_headings":"","what":"New functions","title":"bage 0.2.2","text":"generate.bage_ssvd() Generate random age-sex profiles SVD.","code":""},{"path":"https://bayesiandemography.github.io/bage/news/index.html","id":"bug-fixes-0-2-2","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"bage 0.2.2","text":"Internal function draw_vals_effect_mod() malfunctioning models contained SVD priors.","code":""}]
